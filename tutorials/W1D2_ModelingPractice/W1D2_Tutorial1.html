
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Neuromatch Academy: Week 1, Day 2, Tutorial 1 &#8212; Neuromatch Computational Neuroscience</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet" />
  <link href="../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Neuromatch Academy: Week 1, Day 2, Tutorial 2" href="W1D2_Tutorial2.html" />
    <link rel="prev" title="W1D2 - Modeling Practice" href="README.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
      
      <h1 class="site-logo" id="site-title">Neuromatch Computational Neuroscience</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   NMA 2021
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Preliminary
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../W0D1_PythonWorkshop1/README.html">
   Python Workshop 1
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../W0D1_PythonWorkshop1/W0D1_Tutorial1.html">
     Neuromatch Academy: Week 0, Day 1, Tutorial 1
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../W0D2_PythonWorkshop2/README.html">
   Python Workshop 2
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../W0D2_PythonWorkshop2/W0D2_Tutorial1.html">
     Neuromatch Academy: Week 0, Day 2, Tutorial 1
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 1
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../W1D1_ModelTypes/README.html">
   Model Types
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D1_ModelTypes/W1D1_Tutorial1.html">
     Neuromatch Academy: Week 1, Day 1, Tutorial 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D1_ModelTypes/W1D1_Tutorial2.html">
     Neuromatch Academy: Week 1, Day 1, Tutorial 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D1_ModelTypes/W1D1_Tutorial3.html">
     Neuromatch Academy: Week 1, Day 1, Tutorial 3
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="README.html">
   Modeling Practice
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Neuromatch Academy: Week 1, Day 2, Tutorial 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="W1D2_Tutorial2.html">
     Neuromatch Academy: Week 1, Day 2, Tutorial 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../W1D3_ModelFitting/README.html">
   Model Fitting
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D3_ModelFitting/W1D3_Tutorial1.html">
     Neuromatch Academy: Week 1, Day 3, Tutorial 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D3_ModelFitting/W1D3_Tutorial2.html">
     Neuromatch Academy: Week 1, Day 3, Tutorial 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D3_ModelFitting/W1D3_Tutorial3.html">
     Neuromatch Academy: Week 1, Day 3, Tutorial 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D3_ModelFitting/W1D3_Tutorial4.html">
     Neuromatch Academy: Week 1, Day 3, Tutorial 4
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D3_ModelFitting/W1D3_Tutorial5.html">
     Neuromatch Academy: Week 1, Day 3, Tutorial 5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D3_ModelFitting/W1D3_Tutorial6.html">
     Neuromatch Academy: Week 1, Day 3, Tutorial 6
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../W1D4_MachineLearning/README.html">
   Machine Learning
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D4_MachineLearning/W1D4_Tutorial1.html">
     Neuromatch Academy: Week 1, Day 4, Tutorial 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D4_MachineLearning/W1D4_Tutorial2.html">
     Neuromatch Academy: Week 1, Day 4, Tutorial 2
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../W1D5_DimensionalityReduction/README.html">
   Dimensionality Reduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D5_DimensionalityReduction/W1D5_Tutorial1.html">
     Neuromatch Academy: Week 1, Day 5, Tutorial 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D5_DimensionalityReduction/W1D5_Tutorial2.html">
     Neuromatch Academy: Week 1, Day 5, Tutorial 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D5_DimensionalityReduction/W1D5_Tutorial3.html">
     Neuromatch Academy: Week 1, Day 5, Tutorial 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W1D5_DimensionalityReduction/W1D5_Tutorial4.html">
     Neuromatch Academy: Week 1, Day 5, Tutorial 4
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Week 2
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../W2D2_LinearSystems/README.html">
   Linear Systems
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../W2D2_LinearSystems/W2D2_Tutorial1.html">
     Neuromatch Academy 2020, Week 2, Day 2, Tutorial 1
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W2D2_LinearSystems/W2D2_Tutorial2.html">
     Neuromatch Academy 2020, Week 2, Day 2, Tutorial 2
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W2D2_LinearSystems/W2D2_Tutorial3.html">
     Neuromatch Academy 2020, Week 2, Day 2, Tutorial 3
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../W2D2_LinearSystems/W2D2_Tutorial4.html">
     Neuromatch Academy 2020, Week 2, Day 2, Tutorial 4
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../W2D3_DecisionMaking/README.html">
   Decision Making
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../W2D4_OptimalControl/README.html">
   Optimal Control
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="simple">
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/tutorials/W1D2_ModelingPractice/W1D2_Tutorial1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/NeuromatchAcademy/course_content/blob/master/book/tutorials/W1D2_ModelingPractice/W1D2_Tutorial1.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Neuromatch Academy: Week 1, Day 2, Tutorial 1
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modeling-practice-framing-the-question">
   Modeling Practice: Framing the question
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial objectives
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setup">
   Setup
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-1-investigating-the-phenomenon">
   Section 1: Investigating the phenomenon
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#td-1-1-form-expectations-about-the-experiment-using-the-phenomena">
     TD 1.1: Form expectations about the experiment, using the phenomena
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#td-1-2-compare-expectations-to-data">
     <strong>
      TD 1.2
     </strong>
     : Compare Expectations to Data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#td-1-3-think-about-what-the-data-is-saying-by-answering-these-questions">
     TD 1.3: Think about what the data is saying, by answering these questions:
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-2-understanding-background">
   Section 2: Understanding background
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#td-2-1-examine-the-differences-between-the-conditions">
     TD 2.1: Examine the differences between the conditions:
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerically-integrating-a-signal">
       Numerically Integrating a signal
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#td-2-2-understanding-the-problem-of-noisy-sensory-information">
     TD 2.2: Understanding the problem of noisy sensory information
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-3-identifying-ingredients">
   Section 3: Identifying ingredients
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#td-3-1-understand-the-moving-average-function">
     TD 3.1: Understand the moving average function
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interactive-demo-averaging-window">
       Interactive Demo: Averaging window
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#td-3-2-thresholding-the-self-motion-vestibular-signal">
     TD 3.2: Thresholding the self-motion vestibular signal
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-1-threshold-self-motion-velocity-into-binary-classifiction-of-self-motion">
       Exercise 1: Threshold self-motion velocity into binary classifiction of self-motion
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#interactive-demo-threshold-vs-averaging-window">
       Interactive Demo: Threshold vs. averaging window
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-4-formulating-hypotheses">
   Section 4: Formulating hypotheses
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#td-4-1-write-out-hypothesis">
     TD 4.1: Write out Hypothesis
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#td-4-2-relate-hypothesis-to-ingredients">
     TD 4.2: Relate hypothesis to ingredients
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-2-build-a-scatter-plot">
       Exercise 2: Build a scatter plot
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise-3-split-variable-means-bar-graph">
       Exercise 3: Split variable means bar graph
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#section-5-toolkit-selection">
   Section 5: Toolkit selection
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#td-5-1-ta-guided-discussion-about-how-questions-drive-toolkit-selection">
     TD 5.1: TA-guided discussion about how questions drive toolkit selection.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reading">
   Reading
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content/blob/master/tutorials/W1D2_ModelingPractice/W1D2_Tutorial1.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<div class="section" id="neuromatch-academy-week-1-day-2-tutorial-1">
<h1>Neuromatch Academy: Week 1, Day 2, Tutorial 1<a class="headerlink" href="#neuromatch-academy-week-1-day-2-tutorial-1" title="Permalink to this headline">¶</a></h1>
</div>
<div class="section" id="modeling-practice-framing-the-question">
<h1>Modeling Practice: Framing the question<a class="headerlink" href="#modeling-practice-framing-the-question" title="Permalink to this headline">¶</a></h1>
<p><strong>Content creators:</strong> Marius ‘t Hart, Paul Schrater, Gunnar Blohm</p>
<p><strong>Content reviewers:</strong> Norma Kuhn, Saeed Salehi, Madineh Sarvestani, Spiros Chavlis, Michael Waskom</p>
</div>
<hr class="docutils" />
<div class="section" id="tutorial-objectives">
<h1>Tutorial objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p>Yesterday you gained some understanding of what models can buy us in neuroscience. But how do you build a model? Today, we will try to clarify the process of computational modeling, by building a simple model.</p>
<p>We will investigate a simple phenomenon, working through the 10 steps of modeling (<a class="reference external" href="https://doi.org/10.1523/ENEURO.0352-19.2019">Blohm et al., 2019</a>) in two notebooks:</p>
<p><strong>Framing the question</strong></p>
<ol class="simple">
<li><p>finding a phenomenon and a question to ask about it</p></li>
<li><p>understanding the state of the art</p></li>
<li><p>determining the basic ingredients</p></li>
<li><p>formulating specific, mathematically defined hypotheses</p></li>
</ol>
<p><strong>Implementing the model</strong></p>
<ol class="simple">
<li><p>selecting the toolkit</p></li>
<li><p>planning the model</p></li>
<li><p>implementing the model</p></li>
</ol>
<p><strong>Model testing</strong></p>
<ol class="simple">
<li><p>completing the model</p></li>
<li><p>testing and evaluating the model</p></li>
</ol>
<p><strong>Publishing</strong></p>
<ol class="simple">
<li><p>publishing models</p></li>
</ol>
<p>Tutorial 1 (this notebook) will cover the steps 1-5, while Tutorial 2 will cover the steps 6-10.</p>
<p><strong>TD</strong>: All activities you should perform are labeled with <strong>TD#.#</strong>, which stands for “To Do”, micro-tutorial number, activity number. They can be found in the Table of Content on the left side of the notebook. Make sure you complete all within a section before moving on!</p>
<p><strong>Run</strong>: Some code chunks’ names start with “Run to … (do something)”. These chunks are purely to produce a graph or calculate a number. You do not need to look at or understand the code in those chunks.</p>
</div>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">gamma</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure settings</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>

<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = &#39;retina&#39;

<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">&quot;https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/nma.mplstyle&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions</span>


<span class="k">def</span> <span class="nf">my_moving_window</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">FUN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Calculates a moving estimate for a signal</span>

<span class="sd">  Args:</span>
<span class="sd">      x (numpy.ndarray): a vector array of size N</span>
<span class="sd">      window (int): size of the window, must be a positive integer</span>
<span class="sd">      FUN (function): the function to apply to the samples in the window</span>

<span class="sd">  Returns:</span>
<span class="sd">      (numpy.ndarray): a vector array of size N, containing the moving</span>
<span class="sd">      average of x, calculated with a window of size window</span>

<span class="sd">  There are smarter and faster solutions (e.g. using convolution) but this</span>
<span class="sd">  function shows what the output really means. This function skips NaNs, and</span>
<span class="sd">  should not be susceptible to edge effects: it will simply use</span>
<span class="sd">  all the  available samples, which means that close to the edges of the</span>
<span class="sd">  signal or close to NaNs, the output will just be based on fewer samples. By</span>
<span class="sd">  default, this function will apply a mean to the samples in the window, but</span>
<span class="sd">  this can be changed to be a max/min/median or other function that returns a</span>
<span class="sd">  single numeric value based on a sequence of values.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="c1"># if data is a matrix, apply filter to each row:</span>
  <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
    <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">rown</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
      <span class="n">output</span><span class="p">[</span><span class="n">rown</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">my_moving_window</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">rown</span><span class="p">,</span> <span class="p">:],</span>
                                         <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
                                         <span class="n">FUN</span><span class="o">=</span><span class="n">FUN</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>

  <span class="c1"># make output array of the same size as x:</span>
  <span class="n">output</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>

  <span class="c1"># loop through the signal in x</span>
  <span class="k">for</span> <span class="n">samp_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">):</span>

    <span class="n">values</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># loop through the window:</span>
    <span class="k">for</span> <span class="n">wind_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">window</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span>

      <span class="k">if</span> <span class="p">((</span><span class="n">samp_i</span> <span class="o">+</span> <span class="n">wind_i</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">samp_i</span> <span class="o">+</span> <span class="n">wind_i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># out of range</span>
        <span class="k">continue</span>

      <span class="c1"># sample is in range and not nan, use it:</span>
      <span class="k">if</span> <span class="ow">not</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">samp_i</span> <span class="o">+</span> <span class="n">wind_i</span><span class="p">])):</span>
        <span class="n">values</span> <span class="o">+=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="n">samp_i</span> <span class="o">+</span> <span class="n">wind_i</span><span class="p">]]</span>

    <span class="c1"># calculate the mean in the window for this point in the output:</span>
    <span class="n">output</span><span class="p">[</span><span class="n">samp_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">FUN</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">output</span>


<span class="k">def</span> <span class="nf">my_plot_percepts</span><span class="p">(</span><span class="n">datasets</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">plotconditions</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

  <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
    <span class="c1"># try to plot the datasets</span>
    <span class="c1"># they should be named...</span>
    <span class="c1"># &#39;expectations&#39;, &#39;judgments&#39;, &#39;predictions&#39;</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>  <span class="c1"># set aspect ratio = 1? not really</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;perceived self motion [m/s]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;perceived world motion [m/s]&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;perceived velocities&#39;</span><span class="p">)</span>

    <span class="c1"># loop through the entries in datasets</span>
    <span class="c1"># plot them in the appropriate way</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">datasets</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
      <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;expectations&#39;</span><span class="p">:</span>

        <span class="n">expect</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">expect</span><span class="p">[</span><span class="s1">&#39;world&#39;</span><span class="p">],</span> <span class="n">expect</span><span class="p">[</span><span class="s1">&#39;self&#39;</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;my expectations&#39;</span><span class="p">)</span>

      <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;judgments&#39;</span><span class="p">:</span>

        <span class="n">judgments</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">condition</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">judgments</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]):</span>
          <span class="n">c_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">judgments</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">condition</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
          <span class="n">cond_self_motion</span> <span class="o">=</span> <span class="n">judgments</span><span class="p">[</span><span class="n">c_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">]</span>
          <span class="n">cond_world_motion</span> <span class="o">=</span> <span class="n">judgments</span><span class="p">[</span><span class="n">c_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">]</span>
          <span class="k">if</span> <span class="n">cond_world_motion</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">cond_self_motion</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">c_label</span> <span class="o">=</span> <span class="s1">&#39;world-motion condition judgments&#39;</span>
          <span class="k">elif</span> <span class="n">cond_world_motion</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">cond_self_motion</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c_label</span> <span class="o">=</span> <span class="s1">&#39;self-motion condition judgments&#39;</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="n">c_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;condition </span><span class="si">{</span><span class="n">condition</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"> judgments&quot;</span>

          <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">judgments</span><span class="p">[</span><span class="n">c_idx</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">judgments</span><span class="p">[</span><span class="n">c_idx</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                      <span class="n">label</span><span class="o">=</span><span class="n">c_label</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

      <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;predictions&#39;</span><span class="p">:</span>

        <span class="n">predictions</span> <span class="o">=</span> <span class="n">datasets</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">condition</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">predictions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]):</span>
          <span class="n">c_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">predictions</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">condition</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
          <span class="n">cond_self_motion</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">c_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">]</span>
          <span class="n">cond_world_motion</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[</span><span class="n">c_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">]</span>
          <span class="k">if</span> <span class="n">cond_world_motion</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">cond_self_motion</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">c_label</span> <span class="o">=</span> <span class="s1">&#39;predicted world-motion condition&#39;</span>
          <span class="k">elif</span> <span class="n">cond_world_motion</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">cond_self_motion</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">c_label</span> <span class="o">=</span> <span class="s1">&#39;predicted self-motion condition&#39;</span>
          <span class="k">else</span><span class="p">:</span>
            <span class="n">c_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;condition </span><span class="si">{</span><span class="n">condition</span><span class="si">:</span><span class="s2">d</span><span class="si">}</span><span class="s2"> prediction&quot;</span>

          <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">predictions</span><span class="p">[</span><span class="n">c_idx</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">predictions</span><span class="p">[</span><span class="n">c_idx</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                      <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">c_label</span><span class="p">)</span>

      <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;datasets keys should be &#39;hypothesis&#39;,</span><span class="se">\</span>
<span class="s2">        &#39;judgments&#39; and &#39;predictions&#39;&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">plotconditions</span><span class="p">:</span>
      <span class="c1"># this code is simplified but only works for the dataset we have:</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&lt;&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                  <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;world-motion stimulus&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;&gt;&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                  <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
                  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;self-motion stimulus&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;xkcd:white&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

  <span class="k">else</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">datasets</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
      <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;datasets argument should be a dict&#39;</span><span class="p">)</span>
      <span class="k">raise</span> <span class="ne">TypeError</span>


<span class="k">def</span> <span class="nf">my_plot_stimuli</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;acceleration [$m/s^2$]&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;velocity [$m/s$]&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;time [s]&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;[motion]&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;xkcd:white&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">my_plot_motion_signals</span><span class="p">():</span>
  <span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">10</span>
  <span class="n">a</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dt</span><span class="p">),</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
  <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>

  <span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span>
                                 <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Sensory ground truth&#39;</span><span class="p">)</span>

  <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;world-motion condition&#39;</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;visual [$m/s$]&#39;</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;vestibular [$m/s^2$]&#39;</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time [s]&#39;</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;motion&#39;</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;xkcd:white&#39;</span><span class="p">)</span>

  <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;self-motion condition&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;visual [$m/s$]&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;vestibular [$m/s^2$]&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time [s]&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;motion&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;xkcd:white&#39;</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">my_plot_sensorysignals</span><span class="p">(</span><span class="n">judgments</span><span class="p">,</span> <span class="n">opticflow</span><span class="p">,</span> <span class="n">vestibular</span><span class="p">,</span> <span class="n">returnaxes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">addaverages</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">integrateVestibular</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                           <span class="n">addGroundTruth</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

  <span class="k">if</span> <span class="n">addGroundTruth</span><span class="p">:</span>
    <span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">10</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dt</span><span class="p">),</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">a</span>

  <span class="n">wm_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">judgments</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
  <span class="n">sm_idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">judgments</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

  <span class="n">opticflow</span> <span class="o">=</span> <span class="n">opticflow</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
  <span class="n">wm_opticflow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">opticflow</span><span class="p">[:,</span> <span class="n">wm_idx</span><span class="p">])</span>
  <span class="n">sm_opticflow</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">opticflow</span><span class="p">[:,</span> <span class="n">sm_idx</span><span class="p">])</span>

  <span class="k">if</span> <span class="n">integrateVestibular</span><span class="p">:</span>
    <span class="n">vestibular</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">vestibular</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">addGroundTruth</span><span class="p">:</span>
      <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>

  <span class="n">vestibular</span> <span class="o">=</span> <span class="n">vestibular</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
  <span class="n">wm_vestibular</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">vestibular</span><span class="p">[:,</span> <span class="n">wm_idx</span><span class="p">])</span>
  <span class="n">sm_vestibular</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">vestibular</span><span class="p">[:,</span> <span class="n">sm_idx</span><span class="p">])</span>

  <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">fig</span><span class="p">,</span> <span class="n">my_axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">&#39;col&#39;</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span>
                              <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Sensory signals&#39;</span><span class="p">)</span>

  <span class="n">my_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">wm_opticflow</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:light red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
  <span class="n">my_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">addGroundTruth</span><span class="p">:</span>
      <span class="n">my_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:red&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">addaverages</span><span class="p">:</span>
      <span class="n">my_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">wm_opticflow</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">my_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;optic-flow in world-motion condition&#39;</span><span class="p">)</span>
  <span class="n">my_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;velocity signal [$m/s$]&#39;</span><span class="p">)</span>

  <span class="n">my_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">sm_opticflow</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:azure&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
  <span class="n">my_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">addGroundTruth</span><span class="p">:</span>
      <span class="n">my_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="o">-</span><span class="n">v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:blue&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">addaverages</span><span class="p">:</span>
      <span class="n">my_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">sm_opticflow</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">my_axes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;optic-flow in self-motion condition&#39;</span><span class="p">)</span>

  <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">wm_vestibular</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:light red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
  <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">addaverages</span><span class="p">:</span>
      <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">wm_vestibular</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd: red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;vestibular signal in world-motion condition&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">addGroundTruth</span><span class="p">:</span>
      <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">100</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:red&#39;</span><span class="p">)</span>
  <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time [s]&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">integrateVestibular</span><span class="p">:</span>
      <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;velocity signal [$m/s$]&#39;</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;acceleration signal [$m/s^2$]&#39;</span><span class="p">)</span>

  <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">sm_vestibular</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:azure&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
  <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">addGroundTruth</span><span class="p">:</span>
      <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:blue&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">addaverages</span><span class="p">:</span>
      <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">average</span><span class="p">(</span><span class="n">sm_vestibular</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span>
                         <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:blue&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

  <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;vestibular signal in self-motion condition&#39;</span><span class="p">)</span>
  <span class="n">my_axes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;time [s]&#39;</span><span class="p">)</span>

  <span class="k">if</span> <span class="n">returnaxes</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">my_axes</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">my_threshold_solution</span><span class="p">(</span><span class="n">selfmotion_vel_est</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
  <span class="n">is_move</span> <span class="o">=</span> <span class="p">(</span><span class="n">selfmotion_vel_est</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">is_move</span>


<span class="k">def</span> <span class="nf">my_moving_threshold</span><span class="p">(</span><span class="n">selfmotion_vel_est</span><span class="p">,</span> <span class="n">thresholds</span><span class="p">):</span>

  <span class="n">pselfmove_nomove</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">thresholds</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
  <span class="n">pselfmove_move</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">thresholds</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
  <span class="n">prop_correct</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">thresholds</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
  <span class="n">pselfmove_nomove</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
  <span class="n">pselfmove_move</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>
  <span class="n">prop_correct</span><span class="p">[:]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>

  <span class="k">for</span> <span class="n">thr_i</span><span class="p">,</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">thresholds</span><span class="p">):</span>

    <span class="c1"># run my_threshold that the students will write:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">is_move</span> <span class="o">=</span> <span class="n">my_threshold</span><span class="p">(</span><span class="n">selfmotion_vel_est</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
      <span class="n">is_move</span> <span class="o">=</span> <span class="n">my_threshold_solution</span><span class="p">(</span><span class="n">selfmotion_vel_est</span><span class="p">,</span> <span class="n">threshold</span><span class="p">)</span>

    <span class="c1"># store results:</span>
    <span class="n">pselfmove_nomove</span><span class="p">[</span><span class="n">thr_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">is_move</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">100</span><span class="p">])</span>
    <span class="n">pselfmove_move</span><span class="p">[</span><span class="n">thr_i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">is_move</span><span class="p">[</span><span class="mi">100</span><span class="p">:</span><span class="mi">200</span><span class="p">])</span>

    <span class="c1"># calculate the proportion</span>
    <span class="c1"># classified correctly: (1 - pselfmove_nomove) + ()</span>
    <span class="c1"># Correct rejections:</span>
    <span class="n">p_CR</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">pselfmove_nomove</span><span class="p">[</span><span class="n">thr_i</span><span class="p">])</span>
    <span class="c1"># correct detections:</span>
    <span class="n">p_D</span> <span class="o">=</span> <span class="n">pselfmove_move</span><span class="p">[</span><span class="n">thr_i</span><span class="p">]</span>

    <span class="c1"># this is corrected for proportion of trials in each condition:</span>
    <span class="n">prop_correct</span><span class="p">[</span><span class="n">thr_i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">p_CR</span> <span class="o">+</span> <span class="n">p_D</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

  <span class="k">return</span> <span class="p">[</span><span class="n">pselfmove_nomove</span><span class="p">,</span> <span class="n">pselfmove_move</span><span class="p">,</span> <span class="n">prop_correct</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">my_plot_thresholds</span><span class="p">(</span><span class="n">thresholds</span><span class="p">,</span> <span class="n">world_prop</span><span class="p">,</span> <span class="n">self_prop</span><span class="p">,</span> <span class="n">prop_correct</span><span class="p">):</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;threshold effects&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">thresholds</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">thresholds</span><span class="p">)],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span>
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">thresholds</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">thresholds</span><span class="p">)],</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span>
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="nb">min</span><span class="p">(</span><span class="n">thresholds</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">thresholds</span><span class="p">)],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span>
           <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thresholds</span><span class="p">,</span> <span class="n">world_prop</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;world motion condition&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thresholds</span><span class="p">,</span> <span class="n">self_prop</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;self motion condition&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thresholds</span><span class="p">,</span> <span class="n">prop_correct</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:purple&#39;</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;correct classification&#39;</span><span class="p">)</span>
  <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">prop_correct</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="mi">1</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">thresholds</span><span class="p">[</span><span class="o">-</span><span class="n">idx</span><span class="p">]]</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:purple&#39;</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">&#39;best classification&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span>
           <span class="sa">f</span><span class="s2">&quot;threshold:</span><span class="si">{</span><span class="n">thresholds</span><span class="p">[</span><span class="o">-</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="se">\</span>
<span class="s2">           </span><span class="se">\n</span><span class="s2">correct: </span><span class="si">{</span><span class="n">prop_correct</span><span class="p">[</span><span class="o">-</span><span class="n">idx</span><span class="p">]</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;threshold&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;proportion classified as self motion&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;xkcd:white&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">my_plot_predictions_data</span><span class="p">(</span><span class="n">judgments</span><span class="p">,</span> <span class="n">predictions</span><span class="p">):</span>

  <span class="c1"># conditions = np.concatenate((np.abs(judgments[:, 1]),</span>
  <span class="c1">#                             np.abs(judgments[:, 2])))</span>
  <span class="c1"># veljudgmnt = np.concatenate((judgments[:, 3], judgments[:, 4]))</span>
  <span class="c1"># velpredict = np.concatenate((predictions[:, 3], predictions[:, 4]))</span>

  <span class="c1"># self:</span>
  <span class="c1"># conditions_self = np.abs(judgments[:, 1])</span>
  <span class="n">veljudgmnt_self</span> <span class="o">=</span> <span class="n">judgments</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>
  <span class="n">velpredict_self</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[:,</span> <span class="mi">3</span><span class="p">]</span>

  <span class="c1"># world:</span>
  <span class="c1"># conditions_world = np.abs(judgments[:, 2])</span>
  <span class="n">veljudgmnt_world</span> <span class="o">=</span> <span class="n">judgments</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>
  <span class="n">velpredict_world</span> <span class="o">=</span> <span class="n">predictions</span><span class="p">[:,</span> <span class="mi">4</span><span class="p">]</span>

  <span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">&#39;row&#39;</span><span class="p">,</span>
                                 <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

  <span class="n">ax1</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">veljudgmnt_self</span><span class="p">,</span> <span class="n">velpredict_self</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;self-motion judgments&#39;</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>
  <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;predicted&#39;</span><span class="p">)</span>

  <span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">veljudgmnt_world</span><span class="p">,</span> <span class="n">velpredict_world</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;world-motion judgments&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;observed&#39;</span><span class="p">)</span>
  <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;predicted&#39;</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Data retrieval</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">fname</span><span class="o">=</span><span class="s2">&quot;W1D2_data.npz&quot;</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
  <span class="o">!</span>wget https://osf.io/c5xyf/download -O <span class="nv">$fname</span>

<span class="n">filez</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">fname</span><span class="p">,</span> <span class="n">allow_pickle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">judgments</span> <span class="o">=</span> <span class="n">filez</span><span class="p">[</span><span class="s1">&#39;judgments&#39;</span><span class="p">]</span>
<span class="n">opticflow</span> <span class="o">=</span> <span class="n">filez</span><span class="p">[</span><span class="s1">&#39;opticflow&#39;</span><span class="p">]</span>
<span class="n">vestibular</span> <span class="o">=</span> <span class="n">filez</span><span class="p">[</span><span class="s1">&#39;vestibular&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-1-investigating-the-phenomenon">
<h1>Section 1: Investigating the phenomenon<a class="headerlink" href="#section-1-investigating-the-phenomenon" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Video 1: Question</span>
<span class="n">video</span> <span class="o">=</span> <span class="n">YouTubeVideo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;x4b2-hZoyiY&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">854</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Video available at https://youtube.com/watch?v=</span><span class="si">{</span><span class="n">video</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">video</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Goal</strong>: formulate a good question!</p>
<p><strong>Background: The train illusion</strong></p>
<p>In the video you have learnt about the train illusion. In the same situation, we sometimes perceive our own train to be moving and sometimes the other train. How come our perception is ambiguous?</p>
<p>We will build a simple model with the goal <em>to learn about the process of model building</em> (i.e.: not to explain train illusions or get a correct model). To keep this manageable, we use a <em>simulated</em> data set. For the same reason, this tutorial contains both coding and thinking activities. Doing both are essential for success.</p>
<p>Imagine we get data from an experimentalist who collected <em>judgments</em> on self motion and world motion, in two conditions. One where there was only world motion, and one where there was only self motion. In either case, the velocity increased from 0 to 1 m/s across 10 seconds with the same (fairly low) acceleration. Each of these conditions was recorded 100 times:</p>
<p><img alt="illustration of the conditions" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W1D2_ModelingPractice/static/NMA-W1D2-fig01.png" /></p>
<p>Participants sit very still during the trials and at the end of each 10 s trial they are given two sliders, one to indicate the self-motion velocity (in m/s) and another to indicate the world-motion velocity (in m/s) <em>at the end of the interval</em>.</p>
<div class="section" id="td-1-1-form-expectations-about-the-experiment-using-the-phenomena">
<h2>TD 1.1: Form expectations about the experiment, using the phenomena<a class="headerlink" href="#td-1-1-form-expectations-about-the-experiment-using-the-phenomena" title="Permalink to this headline">¶</a></h2>
<p>In the experiment we get the participants <em>judgments</em> of the velocities they experienced. In the Python chunk below, you should retain the numbers that represent your expectations on the participants’ judgments. Remember that in the train illusion people usually experience either self motion or world motion, but not both.</p>
<p>From the lists, remove those pairs of responses you think are unlikely to be the participants’ judgments. The first two pairs of coordinates (1 m/s, 0 m/s, and 0 m/s, 1 m/s) are the stimuli, so those reflect judgments without illusion. Those should stay, but how do you think participants judge velocities when they <em>do</em> experience the illusion?</p>
<p><strong>Create Expectations</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create Expectations</span>
<span class="c1">###################################################################</span>
<span class="c1"># To complete the exercise, remove unlikely responses from the two</span>
<span class="c1"># lists. The lists act as X and Y coordinates for a scatter plot,</span>
<span class="c1"># so make sure the lists match in length.</span>
<span class="c1">###################################################################</span>

<span class="n">world_vel_exp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">self_vel_exp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">]</span>

<span class="c1"># The code below creates a figure with your predictions:</span>
<span class="n">my_plot_percepts</span><span class="p">(</span><span class="n">datasets</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;expectations&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;world&#39;</span><span class="p">:</span> <span class="n">world_vel_exp</span><span class="p">,</span>
                                            <span class="s1">&#39;self&#39;</span><span class="p">:</span> <span class="n">self_vel_exp</span><span class="p">}})</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="td-1-2-compare-expectations-to-data">
<h2><strong>TD 1.2</strong>: Compare Expectations to Data<a class="headerlink" href="#td-1-2-compare-expectations-to-data" title="Permalink to this headline">¶</a></h2>
<p>The behavioral data from our experiment is in a 200 x 5 matrix called <code class="docutils literal notranslate"><span class="pre">judgments</span></code>, where each row indicates a trial.</p>
<p>The first three columns in the <code class="docutils literal notranslate"><span class="pre">judgments</span></code> matrix represent the conditions in the experiment, and the last two columns list the velocity judgments.</p>
<p><img alt="illustration of the judgments matrix" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W1D2_ModelingPractice/static/NMA-W1D2-fig02.png" /></p>
<p>The condition number can be 0 (world-motion condition, first 100 rows) or 1 (self-motion condition, last 100 rows). Columns 1 and 2 respectively list the true self- and world-motion velocities in the experiment. You will not have to use the first three columns.</p>
<p>The motion judgements (columns 3 and 4) are the participants judgments of the self-motion velocity and world-motion velocity respectively, and should show the illusion. Let’s plot the judgment data, along with the true motion of the stimuli in the experiment:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title</span>
<span class="c1">#@markdown Run to plot perceptual judgments</span>

<span class="n">my_plot_percepts</span><span class="p">(</span><span class="n">datasets</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;judgments&#39;</span><span class="p">:</span> <span class="n">judgments</span><span class="p">},</span> <span class="n">plotconditions</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="td-1-3-think-about-what-the-data-is-saying-by-answering-these-questions">
<h2>TD 1.3: Think about what the data is saying, by answering these questions:<a class="headerlink" href="#td-1-3-think-about-what-the-data-is-saying-by-answering-these-questions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>How does it differ from your initial expectations?</p></li>
<li><p>Where are the clusters of data, roughly?</p></li>
<li><p>What does it mean that the some of the judgments from the world-motion condition are close to the self-motion stimulus and vice versa?</p></li>
<li><p>Why are there no data points in the middle?</p></li>
<li><p>What aspects of the data require explanation?</p></li>
</ul>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-2-understanding-background">
<h1>Section 2: Understanding background<a class="headerlink" href="#section-2-understanding-background" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Video 2: Background</span>
<span class="n">video</span> <span class="o">=</span> <span class="n">YouTubeVideo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;DcJ91h5Ekis&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">854</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Video available at https://youtube.com/watch?v=</span><span class="si">{</span><span class="n">video</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">video</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Goal:</strong> Now that we have an interesting phenomenon, we gather background information which will refine our questions, and we lay the groundwork for developing scientific hypotheses.</p>
<p><strong>Background: Motion Sensing</strong>:</p>
<p>Our self-motion percepts are based on our visual (optic flow) and vestibular (inner ear) sensing. Optic flow is the moving image on the retina caused by either self or world-motion. Vestibular signals are related to bodily self- movements only. The two signals can be understood as velocity in <span class="math notranslate nohighlight">\(m/s\)</span> (optic flow) and acceleration in <span class="math notranslate nohighlight">\(m/s^2\)</span> (vestibular signal). We’ll first look at the ground truth which is stimulating the senses in our experiment.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown **Run to plot motion stimuli**</span>
<span class="n">my_plot_motion_signals</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="td-2-1-examine-the-differences-between-the-conditions">
<h2>TD 2.1: Examine the differences between the conditions:<a class="headerlink" href="#td-2-1-examine-the-differences-between-the-conditions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>how are the visual inputs (optic flow) different between the conditions?</p></li>
<li><p>how are the vestibular signals different between the conditions?</p></li>
<li><p>how might the brain use these signals to determine there is self motion?</p></li>
<li><p>how might the brain use these signals to determine there is world motion?</p></li>
</ul>
<p>We can see that, in theory, we have enough information to disambiguate self-motion from world-motion using these signals. Let’s go over the logic together. The visual signal is ambiguous, it will be non-zero when there is either self-motion or world-motion. The vestibular signal is specific, it’s only non-zero when there is self-motion. Combining these two signals should allow us to disambiguate the self-motion condition from the world-motion condition!</p>
<ul class="simple">
<li><p>In the world-motion condition: The brain can simply compare the visual and vestibular signals. If there is visual motion AND NO vestibular motion, it must be that the world is moving but not the body/self = world-motion judgement.</p></li>
<li><p>In the self-motion condition: We can make a similar comparison. If there is both visual signals AND vestibular signals, it must be that the body/self is moving = self-motion judgement.</p></li>
</ul>
<p><strong>Background: Integrating signals</strong>:</p>
<p>To understand how the vestibular <em>acceleration</em> signal could underlie the perception of self-motion <em>velocity</em>, we assume the brain integrates the signal. This also allows comparing the vestibular signal to the visual signal, by getting them in the same units. Read more about integration on <a class="reference external" href="https://en.wikipedia.org/wiki/Integral">Wikipedia</a>.</p>
<p>Below we will approximate the integral using <code class="docutils literal notranslate"><span class="pre">np.cumsum()</span></code>. The discrete integral would be:</p>
<div class="math notranslate nohighlight">
\[v_t = \sum_{k=0}^t a_k\cdot\Delta t  + v_0\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a(t)\)</span> is acceleration as a function of time</p></li>
<li><p><span class="math notranslate nohighlight">\(v(t)\)</span> is velocity as a function of time</p></li>
<li><p><span class="math notranslate nohighlight">\(\Delta t\)</span> is equal to the sample interval of our recorded visual and vestibular signals (0.1 s).</p></li>
<li><p><span class="math notranslate nohighlight">\(v_0\)</span> is the <em>constant of integration</em> which corresponds in the initial velocity at time <span class="math notranslate nohighlight">\(0\)</span> (it would have to be known or remembered). Since that is always 0 in our experiment, we will leave it out from here on.</p></li>
</ul>
<div class="section" id="numerically-integrating-a-signal">
<h3>Numerically Integrating a signal<a class="headerlink" href="#numerically-integrating-a-signal" title="Permalink to this headline">¶</a></h3>
<p>Below is a chunk of code which uses the <code class="docutils literal notranslate"><span class="pre">np.cumsum()</span></code> function to integrate the acceleration that was used in our (simulated) experiment: <code class="docutils literal notranslate"><span class="pre">a</span></code> over <code class="docutils literal notranslate"><span class="pre">dt</span></code> in order to get a velocity signal <code class="docutils literal notranslate"><span class="pre">v</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check out the code:</span>
<span class="n">dt</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="mi">10</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">gamma</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dt</span><span class="p">),</span> <span class="mf">2.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">dt</span><span class="p">)</span>

<span class="c1"># This does the integration of acceleration into velocity:</span>
<span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">dt</span><span class="p">)</span>

<span class="n">my_plot_stimuli</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Background: Sensory signals are noisy</strong></p>
<p>In our experiment, we also recorded sensory signals in the participant. The data come in two 200 x 100 matrices:</p>
<p><code class="docutils literal notranslate"><span class="pre">opticflow</span></code> (with the visual signals)</p>
<p>and</p>
<p><code class="docutils literal notranslate"><span class="pre">vestibular</span></code> (with the vestibular signals)</p>
<p>In each of the signal matrices <em>rows</em> (200) represent <strong>trials</strong>, in the same order as in the <code class="docutils literal notranslate"><span class="pre">judgments</span></code> matrix. <em>Columns</em> (100) are <strong>time samples</strong>, representing 10 s collected with a 100 ms time bin.</p>
<p><img alt="illustration of the signal matrices" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W1D2_ModelingPractice/static/NMA-W1D2-fig03.png" /></p>
<p>Here we plot the data representing our ‘sensory signals’:</p>
<ul class="simple">
<li><p>plot optic flow signals for self-motion vs world-motion conditions (should be the same)</p></li>
<li><p>plot vestibular signals for self-motion vs world-motion conditions (should be different)</p></li>
</ul>
<p>The x-axis is time in seconds, but the y-axis can be one of several, depending on what you do with the signals: <span class="math notranslate nohighlight">\(m/s^2\)</span> (acceleration) or <span class="math notranslate nohighlight">\(m/s\)</span> (velocity).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown **Run to plot raw noisy sensory signals**</span>
<span class="c1"># signals as they are:</span>
<span class="n">my_plot_sensorysignals</span><span class="p">(</span><span class="n">judgments</span><span class="p">,</span> <span class="n">opticflow</span><span class="p">,</span> <span class="n">vestibular</span><span class="p">,</span>
                       <span class="n">integrateVestibular</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="td-2-2-understanding-the-problem-of-noisy-sensory-information">
<h2>TD 2.2: Understanding the problem of noisy sensory information<a class="headerlink" href="#td-2-2-understanding-the-problem-of-noisy-sensory-information" title="Permalink to this headline">¶</a></h2>
<p><strong>Answer the following questions:</strong></p>
<ul class="simple">
<li><p>Is this what you expected?</p></li>
<li><p>In which of the two signals should we be able to see a difference between the conditions?</p></li>
<li><p>Can we use the data as it is to differentiate between the conditions?</p></li>
<li><p>Can we compare the the visual and vestibular motion signals when they’re in different units?</p></li>
<li><p>What would the brain do differentiate the two conditions?</p></li>
</ul>
<p>Now that we know how to integrate the vestibular signal to get it into the same unit as the optic flow, we can see if it shows the pattern it should: a flat line in the world-motion condition and the correct velocity profile in the self-motion condition. Run the chunk of Python below to plot the sensory data again, but now with the vestibular signal integrated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown **Run to compare true signals to sensory data**</span>
<span class="n">my_plot_sensorysignals</span><span class="p">(</span><span class="n">judgments</span><span class="p">,</span> <span class="n">opticflow</span><span class="p">,</span> <span class="n">vestibular</span><span class="p">,</span>
                       <span class="n">integrateVestibular</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">returnaxes</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">addaverages</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">addGroundTruth</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The thick lines are the ground truth: the actual velocities in each of the conditions. With some effort, we can make out that <em>on average</em> the vestibular signal does show the expected pattern after all. But there is also a lot of noise in the data.</p>
<p><strong>Background  Summary</strong>:</p>
<p>Now that we have examined the sensory signals, and understand how they relate to the ground truth. We see that there is enough information to <em>in principle</em> disambiguate true self-motion from true world motion (there should be no illusion!). However, because the sensory information contains a lot of noise, i.e. it is unreliable, it could result in ambiguity.</p>
<p><strong><em>It is time to refine our research question:</em></strong></p>
<ul class="simple">
<li><p>Does the self-motion illusion occur due to unreliable sensory information?</p></li>
</ul>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-3-identifying-ingredients">
<h1>Section 3: Identifying ingredients<a class="headerlink" href="#section-3-identifying-ingredients" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Video 3: Ingredients</span>
<span class="n">video</span> <span class="o">=</span> <span class="n">YouTubeVideo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;ZQRtysK4OCo&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">854</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Video available at https://youtube.com/watch?v=</span><span class="si">{</span><span class="n">video</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">video</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="td-3-1-understand-the-moving-average-function">
<h2>TD 3.1: Understand the moving average function<a class="headerlink" href="#td-3-1-understand-the-moving-average-function" title="Permalink to this headline">¶</a></h2>
<p><strong>Goal</strong>: think about what ingredients we will need for our model</p>
<p>We have access to sensory signals from the visual and vestibular systems that are used to estimate world motion and self motion.</p>
<p>However, there are still two issues:</p>
<ol class="simple">
<li><p><em>While sensory input can be noisy or unstable, perception is much more stable.</em></p></li>
<li><p><em>In the judgments there is either self motion or not.</em></p></li>
</ol>
<p>We will solve this by by using:</p>
<ol class="simple">
<li><p><em>a moving average filter</em> to stabilize our sensory signals</p></li>
<li><p><em>a threshold function</em> to distinguish moving from non-moving</p></li>
</ol>
<p>One of the simplest models of noise reduction is a moving average (sometimes: moving mean or rolling mean) over the recent past. In a discrete signal we specify the number of samples to use for the average (including the current one), and this is often called the <em>window size</em>. For more information on the moving average, check <a class="reference external" href="https://en.wikipedia.org/wiki/Moving_average">this Wikipedia page</a>.</p>
<p>In this tutorial there is a simple running average function available:</p>
<p><code class="docutils literal notranslate"><span class="pre">my_moving_window(s,</span> <span class="pre">w)</span></code>: takes a signal time series <span class="math notranslate nohighlight">\(s\)</span> and a window size <span class="math notranslate nohighlight">\(w\)</span> as input and returns the moving average for all samples in the signal.</p>
<div class="section" id="interactive-demo-averaging-window">
<h3>Interactive Demo: Averaging window<a class="headerlink" href="#interactive-demo-averaging-window" title="Permalink to this headline">¶</a></h3>
<p>The code below picks one vestibular signal, integrates it to get a velocity estimate for self motion, and then filters. You can set the window size.
Try different window sizes, then answer the following:</p>
<ul class="simple">
<li><p>What is the maximum window size? The minimum?</p></li>
<li><p>Why does increasing the window size shift the curves?</p></li>
<li><p>How do the filtered estimates differ from the true signal?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title</span>
<span class="c1">#@markdown Make sure you execute this cell to enable the widget!</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="n">trial_number</span><span class="o">=</span><span class="mi">101</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">15</span><span class="p">):</span>
  <span class="c1"># get the trial signal:</span>
  <span class="n">signal</span> <span class="o">=</span> <span class="n">vestibular</span><span class="p">[</span><span class="n">trial_number</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
  <span class="c1"># integrate it:</span>
  <span class="n">signal</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">signal</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span><span class="p">)</span>
  <span class="c1"># plot this signal</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;integrated vestibular signal&#39;</span><span class="p">)</span>
  <span class="c1"># filter:</span>
  <span class="n">signal</span> <span class="o">=</span> <span class="n">my_moving_window</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span> <span class="n">FUN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)</span>
  <span class="c1"># plot filtered signal</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;filtered with window: </span><span class="si">{</span><span class="n">window</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">refresh</span><span class="p">,</span> <span class="n">trial_number</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><em>Note: the function <code class="docutils literal notranslate"><span class="pre">my_moving_window()</span></code> is defined in this notebook in the code block at at the top called “Helper functions”. It should be the first function there, so feel free to check how it works.</em></p>
</div>
</div>
<div class="section" id="td-3-2-thresholding-the-self-motion-vestibular-signal">
<h2>TD 3.2: Thresholding the self-motion vestibular signal<a class="headerlink" href="#td-3-2-thresholding-the-self-motion-vestibular-signal" title="Permalink to this headline">¶</a></h2>
<p>Comparing the integrated, filtered (accumulated) vestibular signals with a threshold should allow determining if there is self motion or not.</p>
<p>To try this, we:</p>
<ol class="simple">
<li><p>Integrate the vestibular signal, apply a moving average filter, and take the last value of each trial’s vestibular signal as an estimate of self-motion velocity.</p></li>
<li><p>Transfer the estimates of self-motion velocity into binary (0,1) decisions by comparing them to a threshold. Remember the output of logical comparators (&gt;=&lt;) are logical (truth/1, false/0). 1 indicates we think there was self-motion and 0 indicates otherwise. YOUR CODE HERE.</p></li>
<li><p>We sort these decisions separately for conditions of real world-motion vs. real self-motion to determine ‘classification’ accuracy.</p></li>
<li><p>To understand how the threshold impacts classfication accuracy, we do 1-3  for a range of thresholds.</p></li>
</ol>
<p>There is one line fo code to complete, which will implement step 2.</p>
<div class="section" id="exercise-1-threshold-self-motion-velocity-into-binary-classifiction-of-self-motion">
<h3>Exercise 1: Threshold self-motion velocity into binary classifiction of self-motion<a class="headerlink" href="#exercise-1-threshold-self-motion-velocity-into-binary-classifiction-of-self-motion" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_threshold</span><span class="p">(</span><span class="n">selfmotion_vel_est</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This function should calculate proportion self motion</span>
<span class="sd">  for both conditions and the overall proportion</span>
<span class="sd">  correct classifications.</span>

<span class="sd">  Args:</span>
<span class="sd">      selfmotion_vel_est (numpy.ndarray): A sequence of floats</span>
<span class="sd">      indicating the estimated self motion for all trials.</span>

<span class="sd">      threshold (float): A threshold for the estimate of self motion when</span>
<span class="sd">      the brain decides there really is self motion.</span>

<span class="sd">  Returns:</span>
<span class="sd">      (numpy.ndarray): self-motion: yes or no.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="c1">##############################################################</span>
  <span class="c1"># Compare the self motion estimates to the threshold:</span>
  <span class="c1"># Replace &#39;...&#39; with the proper code:</span>
  <span class="c1"># Remove the next line to test your function</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Modify my_threshold function&quot;</span><span class="p">)</span>
  <span class="c1">##############################################################</span>

  <span class="c1"># Compare the self motion estimates to the threshold</span>
  <span class="n">is_move</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">is_move</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="k">def</span> <span class="nf">my_threshold</span><span class="p">(</span><span class="n">selfmotion_vel_est</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  This function should calculate proportion self motion</span>
<span class="sd">  for both conditions and the overall proportion</span>
<span class="sd">  correct classifications.</span>

<span class="sd">  Args:</span>
<span class="sd">      selfmotion_vel_est (numpy.ndarray): A sequence of floats</span>
<span class="sd">      indicating the estimated self motion for all trials.</span>

<span class="sd">      threshold (float): A threshold for the estimate of self motion when</span>
<span class="sd">      the brain decides there really is self motion.</span>

<span class="sd">  Returns:</span>
<span class="sd">      self-motion: yes or no.</span>
<span class="sd">  &quot;&quot;&quot;</span>

  <span class="c1"># Compare the self motion estimates to the threshold</span>
  <span class="n">is_move</span> <span class="o">=</span> <span class="p">(</span><span class="n">selfmotion_vel_est</span> <span class="o">&gt;</span> <span class="n">threshold</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">is_move</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-threshold-vs-averaging-window">
<h3>Interactive Demo: Threshold vs. averaging window<a class="headerlink" href="#interactive-demo-threshold-vs-averaging-window" title="Permalink to this headline">¶</a></h3>
<p>Now we combine the classification steps 1-3 above, for a variable threshold. This will allow us to find the threshold that produces the most accurate classification of self-motion.
We also add a ‘widget’ that controls the size of the moving average window. How does the optimal threshold vary with window size?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title</span>

<span class="c1">#@markdown Make sure you execute this cell to enable the widget!</span>

<span class="n">thresholds</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.01</span><span class="p">,</span> <span class="o">.</span><span class="mi">01</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">v_ves</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">vestibular</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="n">window</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>

  <span class="n">selfmotion_vel_est</span> <span class="o">=</span> <span class="n">my_moving_window</span><span class="p">(</span><span class="n">v_ves</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="n">window</span><span class="p">,</span>
                                        <span class="n">FUN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">)[:,</span> <span class="mi">99</span><span class="p">]</span>

  <span class="p">[</span><span class="n">pselfmove_nomove</span><span class="p">,</span>
    <span class="n">pselfmove_move</span><span class="p">,</span>
    <span class="n">pcorrect</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_moving_threshold</span><span class="p">(</span><span class="n">selfmotion_vel_est</span><span class="p">,</span> <span class="n">thresholds</span><span class="p">)</span>

  <span class="n">my_plot_thresholds</span><span class="p">(</span><span class="n">thresholds</span><span class="p">,</span> <span class="n">pselfmove_nomove</span><span class="p">,</span> <span class="n">pselfmove_move</span><span class="p">,</span> <span class="n">pcorrect</span><span class="p">)</span>


<span class="n">_</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span><span class="n">refresh</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Let’s unpack this:</p>
<p>Ideally, in the self-motion condition (orange line) we should always detect self motion, and never in the world-motion condition (blue line). This doesn’t happen, regardless of the settings we pick. However, we can pick a threshold that gives the highest proportion correctly classified trials, which depends on the window size, but is between 0.2 and 0.4. We’ll pick the optimal threshold for a window size of 100 (the full signal) which is at 0.33.</p>
<p>The ingredients we have collected for our model so far:</p>
<ul class="simple">
<li><p>integration: get the vestibular signal in the same unit as the visual signal</p></li>
<li><p>running average: accumulate evidence over some time, so that perception is stable</p></li>
<li><p>decision if there was self motion (threshold)</p></li>
</ul>
<p>Since the velocity judgments are made at the end of the 10 second trials, it seems reasonable to use the sensory signals at the last sample to estimate what percept the participants said they had.</p>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-4-formulating-hypotheses">
<h1>Section 4: Formulating hypotheses<a class="headerlink" href="#section-4-formulating-hypotheses" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Video 4: Hypotheses</span>
<span class="n">video</span> <span class="o">=</span> <span class="n">YouTubeVideo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;wgOpbfUELqU&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">854</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Video available at https://youtube.com/watch?v=</span><span class="si">{</span><span class="n">video</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">video</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Goal</strong>: formulate reasonable hypotheses in mathematical language using the ingredients identified in step 3. Write hypotheses as a function that we evaluate the model against later.</p>
<p><strong>Question:</strong> <em>Why do we experience the illusion?</em></p>
<p>We know that there are two real motion signals, and that these drive two sensory signals:</p>
<blockquote>
<div><p><span class="math notranslate nohighlight">\(w_v\)</span>: world motion (velocity magnitude)</p>
<p><span class="math notranslate nohighlight">\(s_v\)</span>: self motion (velocity magnitude)</p>
<p><span class="math notranslate nohighlight">\(s_{visual}\)</span>: optic flow signal</p>
<p><span class="math notranslate nohighlight">\(s_{vestibular}\)</span>: vestibular signal</p>
</div></blockquote>
<p>Optic flow is ambiguous, as both world motion and self motion drive visual motion.</p>
<div class="math notranslate nohighlight">
\[s_{visual} = w_v - s_v + noise\]</div>
<p>Notice that world motion and self motion might cancel out. For example, if the train you are on, and the train you are looking at, both move at exactly the same speed.</p>
<p>Vestibular signals are driven only by self motion, but <em>can</em> be ambiguous when they are noisy.</p>
<div class="math notranslate nohighlight">
\[s_{vestibular} = s_v + noise\]</div>
<p><strong>Combining Relationships</strong></p>
<p>Without the sensory noise, these two relations are two linear equations, with two unknowns!</p>
<p>This suggests the brain could simply “solve” for <span class="math notranslate nohighlight">\(s_v\)</span> and <span class="math notranslate nohighlight">\(w_v\)</span>.</p>
<p>However, given the noisy signals, sometimes these solutions will not be correct.  Perhaps that is enough to explain the illusion?</p>
<div class="section" id="td-4-1-write-out-hypothesis">
<h2>TD 4.1: Write out Hypothesis<a class="headerlink" href="#td-4-1-write-out-hypothesis" title="Permalink to this headline">¶</a></h2>
<p>Use the discussion and framing to write out your hypothesis in the form:</p>
<blockquote>
<div><p>Illusory self-motion occurs when (give preconditions).  We hypothesize it occurs because (explain how our hypothesized relationships work)</p>
</div></blockquote>
</div>
<div class="section" id="td-4-2-relate-hypothesis-to-ingredients">
<h2>TD 4.2: Relate hypothesis to ingredients<a class="headerlink" href="#td-4-2-relate-hypothesis-to-ingredients" title="Permalink to this headline">¶</a></h2>
<p>Now it’s time to pull together the ingredients and relate them to our hypothesis.</p>
<p><strong>For each trial we have:</strong></p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>variable</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\hat{v_s}\)</span></p></td>
<td><p><strong>self motion judgment</strong> (in m/s)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\hat{v_w}\)</span></p></td>
<td><p><strong>world motion judgment</strong> (in m/s)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(s_{ves}\)</span></p></td>
<td><p><strong>vestibular info</strong> filtered and integrated vestibular information</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(s_{opt}\)</span></p></td>
<td><p><strong>optic flow info</strong> filtered optic flow estibular information</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(z_s\)</span></p></td>
<td><p><strong>Self-motion detection</strong> boolean value (True/False) indicating whether the vestibular info was above threshold or not</p></td>
</tr>
</tbody>
</table>
<p>Answer the following questions by replotting your data and ingredients:</p>
<ul class="simple">
<li><p>which of the 5 variables do our hypothesis say should be related?</p></li>
<li><p>what do you expect these plots to look like?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run to calculate variables</span>
<span class="c1"># these 5 lines calculate the main variables that we might use in the model</span>
<span class="n">s_ves</span> <span class="o">=</span> <span class="n">my_moving_window</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">vestibular</span> <span class="o">*</span> <span class="o">.</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">window</span><span class="o">=</span><span class="mi">100</span><span class="p">)[:,</span> <span class="mi">99</span><span class="p">]</span>
<span class="n">s_opt</span> <span class="o">=</span> <span class="n">my_moving_window</span><span class="p">(</span><span class="n">opticflow</span><span class="p">,</span> <span class="n">window</span><span class="o">=</span><span class="mi">50</span><span class="p">)[:,</span> <span class="mi">99</span><span class="p">]</span>
<span class="n">v_s</span> <span class="o">=</span> <span class="n">s_ves</span>
<span class="n">v_w</span> <span class="o">=</span> <span class="o">-</span><span class="n">s_opt</span> <span class="o">-</span> <span class="n">v_s</span>
<span class="n">z_s</span> <span class="o">=</span> <span class="p">(</span><span class="n">s_ves</span> <span class="o">&gt;</span> <span class="mf">0.33</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In the first chunk of code we plot histograms to compare the variability of the estimates of velocity we get from each of two sensory signals.</p>
<p><strong>Plot histograms</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot histograms</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">s_ves</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;vestibular&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># set the first argument here</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">s_opt</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;visual&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># set the first argument here</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;velocity estimate&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;xkcd:white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>This matches that the vestibular signals are noisier than visual signals.</p>
<p>Below is generic code to create scatter diagrams. Use it to see if the relationships between variables are the way you expect them. For example, what is the relationship between the estimates of self motion and world motion, as we calculate them here?</p>
<div class="section" id="exercise-2-build-a-scatter-plot">
<h3>Exercise 2: Build a scatter plot<a class="headerlink" href="#exercise-2-build-a-scatter-plot" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this sets up a figure with some dotted lines on y=0 and x=0 for reference</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">)</span>

<span class="c1">#############################################################################</span>
<span class="c1"># uncomment below and fill in with your code</span>
<span class="c1">#############################################################################</span>

<span class="c1"># determine which variables you want to look at (variable on the abscissa / x-axis, variable on the ordinate / y-axis)</span>
<span class="c1"># plt.scatter(...)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;world-motion velocity [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;self-motion velocity [m/s]&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="c1"># this sets up a figure with some dotted lines on y=0 and x=0 for reference</span>
<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;xkcd:black&#39;</span><span class="p">)</span>

  <span class="c1"># determine which variables you want to look at (variable on the abscissa / x-axis, variable on the ordinate / y-axis)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">v_w</span><span class="p">,</span> <span class="n">v_s</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;world-motion velocity [m/s]&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;self-motion velocity [m/s]&#39;</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>Below is code that uses <span class="math notranslate nohighlight">\(z_s\)</span> to split the trials in into two categories (i.e., <span class="math notranslate nohighlight">\(s_{ves}\)</span> below or above threshold) and plot the mean in each category.</p>
</div>
<div class="section" id="exercise-3-split-variable-means-bar-graph">
<h3>Exercise 3: Split variable means bar graph<a class="headerlink" href="#exercise-3-split-variable-means-bar-graph" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">###################################</span>
<span class="c1"># Fill in source_var and uncomment</span>
<span class="c1">####################################</span>

<span class="c1"># source variable you want to check</span>
<span class="n">source_var</span> <span class="o">=</span> <span class="o">...</span>

<span class="c1"># below = np.mean(source_var[np.where(np.invert(z_s))[0]])</span>
<span class="c1"># above = np.mean(source_var[np.where(z_s)[0]] )</span>

<span class="c1"># plt.bar(x=[0, 1], height=[below, above])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;below&#39;</span><span class="p">,</span> <span class="s1">&#39;above&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to_remove solution</span>

<span class="c1"># source variable you want to check</span>
<span class="n">source_var</span> <span class="o">=</span> <span class="n">v_w</span>

<span class="n">below</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">source_var</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">invert</span><span class="p">(</span><span class="n">z_s</span><span class="p">))[</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">above</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">source_var</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">z_s</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span> <span class="p">)</span>

<span class="k">with</span> <span class="n">plt</span><span class="o">.</span><span class="n">xkcd</span><span class="p">():</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">height</span><span class="o">=</span><span class="p">[</span><span class="n">below</span><span class="p">,</span> <span class="n">above</span><span class="p">])</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="s1">&#39;below&#39;</span><span class="p">,</span> <span class="s1">&#39;above&#39;</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="section-5-toolkit-selection">
<h1>Section 5: Toolkit selection<a class="headerlink" href="#section-5-toolkit-selection" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Video 5: Toolkit</span>
<span class="n">video</span> <span class="o">=</span> <span class="n">YouTubeVideo</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="s1">&#39;rsmnayVfJyM&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">854</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">480</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Video available at https://youtube.com/watch?v=</span><span class="si">{</span><span class="n">video</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">video</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Goal</strong>: with the question, ingredients and hypotheses in mind, which toolkit (modeling approach) would be best to use?</p>
<p><strong>Toolkits</strong></p>
<p>The lecture covers the notion of toolkit.  Here we explain the toolkit we use in our simulation.</p>
<p><strong>Simulation as a generic tool</strong></p>
<p>Because our data provides per trial data of both inputs and outputs, designing a <em>simulation</em> is a powerful method.</p>
<p>In general, simulation models have a typical structure:</p>
<p><img alt="Generic Simulation" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W1D2_ModelingPractice/static/NMA-W1D2-fig04.png" /></p>
<p>Simulation models have:</p>
<ul class="simple">
<li><p><strong>inputs</strong> including input variables, <em>and</em> the ingredients needed to build the simulation functions.</p></li>
<li><p><strong>simulation</strong> which runs the model <em>many times</em> on the inputs, over a range of scenarios (typically different parameter or model choices).</p></li>
</ul>
<p>In addition, many simulations run <em>replications</em>, which are useful if components of your input or model are <em>stochastic</em>.</p>
<ul class="simple">
<li><p><strong>outputs</strong> the output variables.  these may have replicas if the simulations are repeated to account for stochastic elements, which are perfect for statistical analysis.</p></li>
</ul>
<hr class="docutils" />
<p>The elements of a simulation model are quite generic and occur in most models.  The most important considerations in deciding a toolkit are:</p>
<ul class="simple">
<li><p>What types of mechanisms (causes, processes, systems) will you need to consider in your model?</p></li>
<li><p>What aspects of the data and ingredients are <em>essential</em> which are clearly <em>irrelevant</em>, and which can be abstracted over.</p></li>
</ul>
<p>These considerations are completely determined by your research question.  To better understand this, we will engage you in a TA-led discussion.</p>
<div class="section" id="td-5-1-ta-guided-discussion-about-how-questions-drive-toolkit-selection">
<h2>TD 5.1: TA-guided discussion about how questions drive toolkit selection.<a class="headerlink" href="#td-5-1-ta-guided-discussion-about-how-questions-drive-toolkit-selection" title="Permalink to this headline">¶</a></h2>
<p>NOTES:   <a class="reference external" href="https://mfr.ca-1.osf.io/render?url=https://osf.io/v5emn/?direct%26mode=render%26action=download%26mode=render">See slides:</a></p>
<ol class="simple">
<li><p><strong>DISCUSS MECHANISMS/INGREDIENTS NEEDED FOR QUESTIONS</strong>: what kinds of mechanisms and ingredients are needed for the discussion questions</p></li>
<li><p><strong>DISCUSS WHAT INGREDIENTS DONT MATTER</strong>: simulation / level of abstraction (depends on what is measured &amp; is irrelevant to the question)</p></li>
</ol>
</div>
</div>
<hr class="docutils" />
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial, we worked through some steps of the process of modeling.</p>
<ul class="simple">
<li><p>We defined a phenomenon and formulated a question (step 1)</p></li>
<li><p>We collected information the state-of-the-art about the topic (step 2)</p></li>
<li><p>We determined the basic ingredients (step 3), and used these to formulate a specific mathematically defined hypothesis (step 4), and</p></li>
<li><p>We chose the most appropriate modeling approach (i.e., toolkit) for our phenomenon/background information/hypothesis (step 5)</p></li>
</ul>
<p>In the next tutorial, we will continue with the steps 6-10!</p>
</div>
<hr class="docutils" />
<div class="section" id="reading">
<h1>Reading<a class="headerlink" href="#reading" title="Permalink to this headline">¶</a></h1>
<p>Blohm G, Kording KP, Schrater PR (2020). <em>A How-to-Model Guide for Neuroscience</em> eNeuro, 7(1) ENEURO.0352-19.2019. <a class="reference external" href="https://doi.org/10.1523/ENEURO.0352-19.2019">https://doi.org/10.1523/ENEURO.0352-19.2019</a></p>
<p>Dokka K, Park H, Jansen M, DeAngelis GC, Angelaki DE (2019). <em>Causal inference accounts for heading perception in the presence of object motion.</em> PNAS, 116(18):9060-9065. <a class="reference external" href="https://doi.org/10.1073/pnas.1820373116">https://doi.org/10.1073/pnas.1820373116</a></p>
<p>Drugowitsch J, DeAngelis GC, Klier EM, Angelaki DE, Pouget A (2014). <em>Optimal Multisensory Decision-Making in a Reaction-Time Task.</em> eLife, 3:e03005. <a class="reference external" href="https://doi.org/10.7554/eLife.03005">https://doi.org/10.7554/eLife.03005</a></p>
<p>Hartmann, M, Haller K, Moser I, Hossner E-J, Mast FW  (2014). <em>Direction detection thresholds of passive self-motion in artistic gymnasts.</em> Exp Brain Res, 232:1249–1258. <a class="reference external" href="https://doi.org/10.1007/s00221-014-3841-0">https://doi.org/10.1007/s00221-014-3841-0</a></p>
<p>Mensh B, Kording K (2017). <em>Ten simple rules for structuring papers.</em> PLoS Comput Biol 13(9): e1005619. <a class="reference external" href="https://doi.org/10.1371/journal.pcbi.1005619">https://doi.org/10.1371/journal.pcbi.1005619</a></p>
<p>Seno T, Fukuda H (2012). <em>Stimulus Meanings Alter Illusory Self-Motion (Vection) - Experimental Examination of the Train Illusion.</em> Seeing Perceiving, 25(6):631-45. <a class="reference external" href="https://doi.org/10.1163/18784763-00002394">https://doi.org/10.1163/18784763-00002394</a></p>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W1D2_ModelingPractice"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="README.html" title="previous page">W1D2 - Modeling Practice</a>
    <a class='right-next' id="next-link" href="W1D2_Tutorial2.html" title="next page">Neuromatch Academy: Week 1, Day 2, Tutorial 2</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Neuromatch<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>