
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Tutorial 4: Spike-timing dependent plasticity (STDP) — Neuromatch Academy: Computational Neuroscience</title>
<link href="../../../_static/css/theme.css" rel="stylesheet"/>
<link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<link as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
<script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
<script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
<link href="../../../_static/nma-logo-square-4xp.jpg" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="../W2D3_Outro.html" rel="next" title="Outro"/>
<link href="W2D3_Tutorial3.html" rel="prev" title="Tutorial 3: Synaptic transmission - Models of static and dynamic synapses"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
</link></link></link></link></head>
<body data-offset="80" data-spy="scroll" data-target="#bd-toc-nav">
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
<div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<img alt="logo" class="logo" src="../../../_static/nma-logo-square-4xp.jpg"/>
<h1 class="site-logo" id="site-title">Neuromatch Academy: Computational Neuroscience</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main navigation" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../intro.html">
   Introduction
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Pre-reqs Refresher
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/chapter_title.html">
   Neuro Video Series (W0D0)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial1.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial2.html">
     Human Psychophysics
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial3.html">
     Behavioral Readout
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial4.html">
     Live in Lab
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial5.html">
     Brain Signals: Spiking Activity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial6.html">
     Brain Signals: LFP
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial7.html">
     Brain Signals: EEG &amp; MEG
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial8.html">
     Brain Signals: fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial9.html">
     Brain Signals: Calcium Imaging
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial10.html">
     Stimulus Representation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial11.html">
     Neurotransmitters
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial12.html">
     Neurons to Consciousness
    </a>
</li>
</ul>
</input></li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/chapter_title.html">
   Python Workshop 1 (W0D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/student/W0D1_Tutorial1.html">
     Tutorial: LIF Neuron - Part I
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/chapter_title.html">
   Python Workshop 2 (W0D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/student/W0D2_Tutorial1.html">
     Tutorial 1: LIF Neuron Part II
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D3_LinearAlgebra/chapter_title.html">
   Linear Algebra (W0D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial1.html">
     Tutorial 1: Vectors
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial2.html">
     Tutorial 2: Matrices
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial3.html">
     Bonus Tutorial: Discrete Dynamical Systems
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D4_Calculus/chapter_title.html">
   Calculus (W0D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/student/W0D4_Tutorial1.html">
     Tutorial 1: Basics of Differential and Integral Calculus
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/student/W0D4_Tutorial2.html">
     Tutorial 2: Differential Equations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/student/W0D4_Tutorial3.html">
     Tutorial 3: Numerical Methods
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D5_Statistics/chapter_title.html">
   Statistics (W0D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/student/W0D5_Tutorial1.html">
     Neuromatch Academy: Precourse Week, Day 5, Tutorial 1
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/student/W0D5_Tutorial2.html">
     Tutorial 2: Statistical Inference
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Intro to Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D1_ModelTypes/chapter_title.html">
   Model Types (W1D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/W1D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/student/W1D1_Tutorial1.html">
     Tutorial 1: “What” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/student/W1D1_Tutorial2.html">
     Tutorial 2: “How” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/student/W1D1_Tutorial3.html">
     Tutorial 3: “Why” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/W1D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D2_ModelingPractice/chapter_title.html">
   Modeling Practice (W1D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelingPractice/W1D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelingPractice/student/W1D2_Tutorial1.html">
     Tutorial: Framing the Question
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelingPractice/W1D2_Outro.html">
     Outro
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_ModelFitting/chapter_title.html">
   Model Fitting (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/W1D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial1.html">
     Tutorial 1: Linear regression with MSE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial2.html">
     Tutorial 2: Linear regression with MLE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial3.html">
     Tutorial 3: Confidence intervals and bootstrapping
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial4.html">
     Tutorial 4: Multiple linear regression and polynomial regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial5.html">
     Tutorial 5: Model Selection: Bias-variance trade-off
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial6.html">
     Tutorial 6: Model Selection: Cross-validation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/W1D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/chapter_title.html">
   Generalized Linear Models (W1D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/W1D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/student/W1D4_Tutorial1.html">
     Tutorial 1: GLMs for Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/student/W1D4_Tutorial2.html">
     Tutorial 2: Classifiers and regularizers
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/W1D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/chapter_title.html">
   Dimensionality Reduction (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/W1D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial1.html">
     Tutorial 1: Geometric view of data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial2.html">
     Tutorial 2: Principal Component Analysis
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial3.html">
     Tutorial 3: Dimensionality Reduction &amp; Reconstruction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial4.html">
     Tutorial 4:  Nonlinear Dimensionality Reduction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/W1D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_DeepLearning/chapter_title.html">
   Deep Learning (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/W2D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/student/W2D1_Tutorial1.html">
     Tutorial 1: Decoding Neural Responses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/student/W2D1_Tutorial2.html">
     Tutorial 2: Convolutional Neural Networks
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/student/W2D1_Tutorial3.html">
     Tutorial 2: Building and Evaluating Normative Encoding Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/W2D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Dynamical Systems
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_LinearSystems/chapter_title.html">
   Linear Systems (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
<label for="toctree-checkbox-13">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/W2D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial1.html">
     Tutorial 1: Linear dynamical systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial2.html">
     Tutorial 2: Markov Processes
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial3.html">
     Tutorial 3: Combining determinism and stochasticity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial4.html">
     Tutorial 4: Autoregressive models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/W2D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   Biological Neuron Models (W2D3)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
<label for="toctree-checkbox-14">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="../W2D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D3_Tutorial1.html">
     Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D3_Tutorial2.html">
     Tutorial 2: Effects of Input Correlation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D3_Tutorial3.html">
     Tutorial 3: Synaptic transmission - Models of static and dynamic synapses
    </a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     Tutorial 4: Spike-timing dependent plasticity (STDP)
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../W2D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D4_DynamicNetworks/chapter_title.html">
   Dynamic Networks (W2D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
<label for="toctree-checkbox-15">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/W2D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/student/W2D4_Tutorial1.html">
     Tutorial 1: Neural Rate Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/student/W2D4_Tutorial2.html">
     Tutorial 2: Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/W2D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Stochastic Processes
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D1_BayesianDecisions/chapter_title.html">
   Bayesian Decisions (W3D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
<label for="toctree-checkbox-16">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/W3D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/student/W3D1_Tutorial1.html">
     Tutorial 1: Bayes with a binary hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/student/W3D1_Tutorial2.html">
     Tutorial 2: Bayesian inference and decisions with continuous hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/student/W3D1_Tutorial3.html">
     Bonus Tutorial:Fitting to data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/W3D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D2_HiddenDynamics/chapter_title.html">
   Hidden Dynamics (W3D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
<label for="toctree-checkbox-17">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/W3D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial1.html">
     Tutorial 1: Sequential Probability Ratio Test
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial2.html">
     Tutorial 2: Hidden Markov Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial3.html">
     Tutorial 3: 1D Kalman Filter
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial4.html">
     Tutorial 4: 2D Kalman Filter
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/W3D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D3_OptimalControl/chapter_title.html">
   Optimal Control (W3D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
<label for="toctree-checkbox-18">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/W3D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/student/W3D3_Tutorial1.html">
     Tutorial 1: Optimal Control for Discrete States
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/student/W3D3_Tutorial2.html">
     Tutorial 2: Optimal Control for Continuous State
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/W3D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/chapter_title.html">
   Reinforcement Learning (W3D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
<label for="toctree-checkbox-19">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/W3D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial4.html">
     Tutorial 4: From Reinforcement Learning to Planning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/W3D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D5_NetworkCausality/chapter_title.html">
   Network Causality (W3D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
<label for="toctree-checkbox-20">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/W3D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial1.html">
     Tutorial 1: Interventions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial2.html">
     Tutorial 2: Correlations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial3.html">
     Tutorial 3: Simultaneous fitting/regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial4.html">
     Tutorial 4: Instrumental Variables
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/W3D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
</ul>
</div>
</nav> <!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
<div class="topbar container-xl fixed-top">
<div class="topbar-contents row">
<div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
<div class="col pl-md-4 topbar-main">
<button aria-controls="site-navigation" aria-expanded="true" aria-label="Toggle navigation" class="navbar-toggler ml-0" data-placement="left" data-target=".site-navigation" data-toggle="tooltip" id="navbar-toggler" title="Toggle navigation" type="button">
<i class="fas fa-bars"></i>
<i class="fas fa-arrow-left"></i>
<i class="fas fa-arrow-up"></i>
</button>
<div class="dropdown-buttons-trigger">
<button aria-label="Download this page" class="btn btn-secondary topbarbtn" id="dropdown-buttons-trigger"><i class="fas fa-download"></i></button>
<div class="dropdown-buttons">
<!-- ipynb file if we had a myst markdown file -->
<!-- Download raw file -->
<a class="dropdown-buttons" href="../../../_sources/tutorials/W2D3_BiologicalNeuronModels/student/W2D3_Tutorial4.ipynb"><button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" title="Download source file" type="button">.ipynb</button></a>
<!-- Download PDF via print -->
<button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" id="download-print" onclick="window.print()" title="Print to PDF" type="button">.pdf</button>
</div>
</div>
<!-- Source interaction buttons -->
<div class="dropdown-buttons-trigger">
<button aria-label="Connect with source repository" class="btn btn-secondary topbarbtn" id="dropdown-buttons-trigger"><i class="fab fa-github"></i></button>
<div class="dropdown-buttons sourcebuttons">
<a class="repository-button" href="https://github.com/NeuromatchAcademy/course-content"><button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" title="Source repository" type="button"><i class="fab fa-github"></i>repository</button></a>
<a class="issues-button" href="https://github.com/NeuromatchAcademy/course-content/issues/new?title=Issue%20on%20page%20%2Ftutorials/W2D3_BiologicalNeuronModels/student/W2D3_Tutorial4.html&amp;body=Your%20issue%20content%20here."><button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" title="Open an issue" type="button"><i class="fas fa-lightbulb"></i>open issue</button></a>
</div>
</div>
<!-- Full screen (wrap in <a> to have style consistency -->
<a class="full-screen-button"><button aria-label="Fullscreen mode" class="btn btn-secondary topbarbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode" type="button"><i class="fas fa-expand"></i></button></a>
<!-- Launch buttons -->
</div>
<!-- Table of contents -->
<div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
            </div>
<nav id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 4: Spike-timing dependent plasticity (STDP)
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-spike-timing-dependent-plasticity-stdp">
   Section 1: Spike-timing dependent plasticity (STDP)
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-stdp">
     Video 1: STDP
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#model-of-stdp">
     Model of STDP
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#exercise-1-compute-the-stdp-changes-delta-w">
     Exercise 1: Compute the STDP changes
     <span class="math notranslate nohighlight">
      \(\Delta W\)
     </span>
</a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#keeping-track-of-pre-and-postsynaptic-spikes">
     Keeping track of pre- and postsynaptic spikes
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#visualization-of-p">
     Visualization of
     <span class="math notranslate nohighlight">
      \(P\)
     </span>
</a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#exercise-2-compute-dp">
     Exercise 2: Compute
     <span class="math notranslate nohighlight">
      \(dP\)
     </span>
</a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-implementation-of-stdp">
   Section 2: Implementation of STDP
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#lif-neuron-connected-with-synapses-that-show-stdp">
     LIF neuron connected with synapses that show STDP
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#function-for-lif-neuron-with-stdp-synapses">
     Function for LIF neuron with STDP synapses
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#evolution-of-excitatory-synaptic-conductance">
     Evolution of excitatory synaptic conductance
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#figures-of-the-evolution-of-synaptic-conductance">
       Figures of the evolution of synaptic conductance
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#think">
     Think!
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#distribution-of-synaptic-weight">
     Distribution of synaptic weight
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#functions-for-simulating-a-lif-neuron-with-stdp-synapses">
       Functions for simulating a LIF neuron with STDP synapses
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-example-of-an-lif-model-with-stdp">
       Interactive Demo: Example of an LIF model with STDP
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
     Think!
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-effect-of-input-correlations">
   Section 3: Effect of input correlations
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#function-for-lif-neuron-with-stdp-synapses-receiving-correlated-inputs">
     Function for LIF neuron with STDP synapses receiving correlated inputs
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-lif-model-with-plastic-synapses-receiving-correlated-inputs">
     Interactive Demo: LIF model with plastic synapses receiving correlated inputs
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
</a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
     Think!
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="row" id="main-content">
<div class="col-12 col-md-9 pl-md-3 pr-md-0">
<div>
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content/blob/master/tutorials/W2D3_RealNeurons/student/W2D3_Tutorial4.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a></p>
<div class="section" id="tutorial-4-spike-timing-dependent-plasticity-stdp">
<h1>Tutorial 4: Spike-timing dependent plasticity (STDP)<a class="headerlink" href="#tutorial-4-spike-timing-dependent-plasticity-stdp" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 2, Day 3: Biological Neuron Models</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Qinglong Gu, Songtin Li, John Murray, Richard Naud, Arvind Kumar</p>
<p><strong>Content reviewers:</strong> Spiros Chavlis, Lorenzo Fontolan, Richard Gao, Matthew Krause</p>
</div>
<hr class="docutils"/>
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial, we will focus on building a model of a synapse in which its synaptic strength changes as a function of the relative timing (i.e., time difference) between the spikes of the presynaptic and postsynaptic neurons, respectively. This change in the synaptic weight is known as <strong>spike-timing dependent plasticity (STDP)</strong>.</p>
<p>Our goals for this tutorial are to:</p>
<ul class="simple">
<li><p>build a model of synapse that show STDP</p></li>
<li><p>study how correlations in input spike trains influence the distribution of synaptic weights</p></li>
</ul>
<p>Towards these goals, we will model the presynaptic input as Poisson type spike trains. The postsynaptic neuron will be modeled as an LIF neuron (see Tutorial 1).</p>
<p>Throughout this tutorial, we assume that a single postsynaptic neuron is driven by <span class="math notranslate nohighlight">\(N\)</span> presynaptic neurons. That is, there are <span class="math notranslate nohighlight">\(N\)</span> synapses, and we will study how their weights depend on the statistics or the input spike trains and their timing with respect to the spikes of the postsynaptic neuron.</p>
</div>
<hr class="docutils"/>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure Settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure Settings</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>       <span class="c1"># interactive display</span>

<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format='retina'
<span class="c1"># use NMA plot style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/nma.mplstyle"</span><span class="p">)</span>
<span class="n">my_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions</span>


<span class="k">def</span> <span class="nf">default_pars_STDP</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="p">{}</span>

  <span class="c1"># typical neuron parameters</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_th'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">55.</span>     <span class="c1"># spike threshold [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_reset'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>  <span class="c1"># reset potential [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_m'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>     <span class="c1"># membrane time constant [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_init'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">65.</span>   <span class="c1"># initial potential [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_L'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>      <span class="c1"># leak reversal potential [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tref'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.</span>       <span class="c1"># refractory time (ms)</span>

  <span class="c1"># STDP parameters</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'A_plus'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.008</span>                   <span class="c1"># magnitude of LTP</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'A_minus'</span><span class="p">]</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'A_plus'</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1.10</span>  <span class="c1"># magnitude of LTD</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_stdp'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">20.</span>                   <span class="c1"># STDP time constant [ms]</span>

  <span class="c1"># simulation parameters</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">400.</span>  <span class="c1"># Total duration of simulation [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.1</span>   <span class="c1"># Simulation time step [ms]</span>

  <span class="c1"># external parameters if any</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

  <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">])</span>  <span class="c1"># Vector of discretized time points [ms]</span>

  <span class="k">return</span> <span class="n">pars</span>


<span class="k">def</span> <span class="nf">Poisson_generator</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
  <span class="sd">"""Generates poisson trains</span>

<span class="sd">  Args:</span>
<span class="sd">    pars            : parameter dictionary</span>
<span class="sd">    rate            : noise amplitute [Hz]</span>
<span class="sd">    n               : number of Poisson trains</span>
<span class="sd">    myseed          : random seed. int or boolean</span>

<span class="sd">  Returns:</span>
<span class="sd">    pre_spike_train : spike train matrix, ith row represents whether</span>
<span class="sd">                      there is a spike in ith spike train over time</span>
<span class="sd">                      (1 if spike, 0 otherwise)</span>
<span class="sd">  """</span>

  <span class="c1"># Retrieve simulation parameters</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>

  <span class="c1"># set random seed</span>
  <span class="k">if</span> <span class="n">myseed</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">myseed</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>

  <span class="c1"># generate uniformly distributed random variables</span>
  <span class="n">u_rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">Lt</span><span class="p">)</span>

  <span class="c1"># generate Poisson train</span>
  <span class="n">poisson_train</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">*</span> <span class="p">(</span><span class="n">u_rand</span> <span class="o">&lt;</span> <span class="n">rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="mf">1000.</span><span class="p">))</span>

  <span class="k">return</span> <span class="n">poisson_train</span>


<span class="k">def</span> <span class="nf">my_raster_plot</span><span class="p">(</span><span class="n">range_t</span><span class="p">,</span> <span class="n">spike_train</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
  <span class="sd">"""Generates poisson trains</span>

<span class="sd">  Args:</span>
<span class="sd">    range_t     : time sequence</span>
<span class="sd">    spike_train : binary spike trains, with shape (N, Lt)</span>
<span class="sd">    n           : number of Poisson trains plot</span>

<span class="sd">  Returns:</span>
<span class="sd">    Raster_plot of the spike train</span>
<span class="sd">  """</span>

  <span class="c1"># Find the number of all the spike trains</span>
  <span class="n">N</span> <span class="o">=</span> <span class="n">spike_train</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

  <span class="c1"># n should be smaller than N:</span>
  <span class="k">if</span> <span class="n">n</span> <span class="o">&gt;</span> <span class="n">N</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'The number n exceeds the size of spike trains'</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'The number n is set to be the size of spike trains'</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">N</span>

  <span class="c1"># Raster plot</span>
  <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">n</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">spike_train</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">:</span>
      <span class="n">t_sp</span> <span class="o">=</span> <span class="n">range_t</span><span class="p">[</span><span class="n">spike_train</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>  <span class="c1"># spike times</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_sp</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_sp</span><span class="p">)),</span> <span class="s1">'k|'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="n">range_t</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">range_t</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (ms)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Neuron ID'</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">my_example_P</span><span class="p">():</span>
  <span class="n">spT</span> <span class="o">=</span> <span class="n">pre_spike_train_ex</span><span class="p">[</span><span class="n">pre_spike_train_ex</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.</span><span class="p">,</span> <span class="p">:]</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
  <span class="n">color_set</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'r'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'k'</span><span class="p">,</span> <span class="s1">'orange'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">]</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">spT</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
    <span class="n">t_sp</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">][</span><span class="n">spT</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">&gt;</span> <span class="mf">0.5</span><span class="p">]</span>   <span class="c1"># spike times</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t_sp</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_sp</span><span class="p">)),</span> <span class="s1">'|'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color_set</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
             <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">markeredgewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (ms)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Neuron ID'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="n">color_set</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (s)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'P(t)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">mySTDP_plot</span><span class="p">(</span><span class="n">A_plus</span><span class="p">,</span> <span class="n">A_minus</span><span class="p">,</span> <span class="n">tau_stdp</span><span class="p">,</span> <span class="n">time_diff</span><span class="p">,</span> <span class="n">dW</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mi">5</span> <span class="o">*</span> <span class="n">tau_stdp</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">tau_stdp</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">'k'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">':'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">A_minus</span><span class="p">,</span> <span class="n">A_plus</span><span class="p">],</span> <span class="s1">'k'</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">':'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_diff</span><span class="p">[</span><span class="n">time_diff</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dW</span><span class="p">[</span><span class="n">time_diff</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">'ro'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time_diff</span><span class="p">[</span><span class="n">time_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">],</span> <span class="n">dW</span><span class="p">[</span><span class="n">time_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">],</span> <span class="s1">'bo'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'t$_{\mathrm</span><span class="si">{pre}</span><span class="s1">}$ - t$_{\mathrm</span><span class="si">{post}</span><span class="s1">}$ (ms)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\Delta$W'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'Biphasic STDP'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-1-spike-timing-dependent-plasticity-stdp">
<h1>Section 1: Spike-timing dependent plasticity (STDP)<a class="headerlink" href="#section-1-spike-timing-dependent-plasticity-stdp" title="Permalink to this headline">¶</a></h1>
<div class="section" id="video-1-stdp">
<h2>Video 1: STDP<a class="headerlink" href="#video-1-stdp" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Video available at https://youtube.com/watch?v=luHL-mO5S1w
</pre></div>
</div>
<div class="output text_html">
<iframe allowfullscreen="" frameborder="0" height="410" src="https://www.youtube.com/embed/luHL-mO5S1w?fs=1" width="730"></iframe>
</div></div>
</div>
</div>
<div class="section" id="model-of-stdp">
<h2>Model of STDP<a class="headerlink" href="#model-of-stdp" title="Permalink to this headline">¶</a></h2>
<p>The phenomenology of STDP is generally described as a biphasic exponentially decaying function. That is, the instantaneous change in weights is given by:</p>
<div class="amsmath math notranslate nohighlight" id="equation-440053df-b32d-4446-a73f-233a81eb2a0e">
<span class="eqno">(132)<a class="headerlink" href="#equation-440053df-b32d-4446-a73f-233a81eb2a0e" title="Permalink to this equation">¶</a></span>\[\begin{eqnarray}
&amp; \Delta W &amp;=&amp; A_+ e^{ (t_{pre}-t_{post})/\tau_+}  &amp; \text{if} \hspace{5mm}  t_{post} &gt; t_{pre}&amp; \\
&amp; \Delta W &amp;=&amp; -A_- e^{- (t_{pre}-t_{post})/\tau_-}   &amp;\text{if} \hspace{5mm} t_{post} &lt; t_{pre}&amp; \\
\end{eqnarray}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta W\)</span> denotes the change in the synaptic weight, <span class="math notranslate nohighlight">\(A_+\)</span> and <span class="math notranslate nohighlight">\(A_-\)</span> determine the maxmimum amount of synaptic modification (which occurs when the timing difference between presynaptic and postsynaptic spikes is close to zero), <span class="math notranslate nohighlight">\(\tau_+\)</span> and <span class="math notranslate nohighlight">\(\tau_-\)</span> determine the ranges of pre-to-postsynaptic interspike intervals over which synaptic strengthening or weakening occurs. Thus, <span class="math notranslate nohighlight">\(\Delta W &gt; 0 \)</span> means that postsynaptic neuron spikes after the presynaptic neuron.</p>
<p>This model captures the phenomena that repeated occurrences of presynaptic spikes within a few milliseconds <strong>before</strong> postsynaptic action potentials lead to long-term potentiation (LTP) of the synapse, whereas repeated occurrences of presynaptic spikes <strong>after</strong> the postsynaptic ones lead to long-term depression (LTD) of the same synapse.</p>
<p>The latency between presynaptic and postsynaptic spike (<span class="math notranslate nohighlight">\(\Delta t\)</span>) is defined as:</p>
<div class="amsmath math notranslate nohighlight" id="equation-3ea59eaf-3611-42f1-9adf-e17140c663a0">
<span class="eqno">(133)<a class="headerlink" href="#equation-3ea59eaf-3611-42f1-9adf-e17140c663a0" title="Permalink to this equation">¶</a></span>\[\begin{eqnarray}
\Delta t = t_{\rm pre} - t_{\rm post}
\end{eqnarray}\]</div>
<p>where <span class="math notranslate nohighlight">\(t_{\rm pre}\)</span> and <span class="math notranslate nohighlight">\(t_{\rm post}\)</span> are the timings of the presynaptic and postsynaptic spikes, respectively.</p>
<p>Complete the following code to set the STDP parameters and plot the STDP function. Note that for simplicity, we assume <strong><span class="math notranslate nohighlight">\(\tau_{+} = \tau_{-} = \tau_{\rm stdp}\)</span></strong>.</p>
</div>
<div class="section" id="exercise-1-compute-the-stdp-changes-delta-w">
<h2>Exercise 1: Compute the STDP changes <span class="math notranslate nohighlight">\(\Delta W\)</span><a class="headerlink" href="#exercise-1-compute-the-stdp-changes-delta-w" title="Permalink to this headline">¶</a></h2>
<p>Note, as shown above, the expression of <span class="math notranslate nohighlight">\(\Delta W\)</span> is different for <span class="math notranslate nohighlight">\(t_{post}&gt;t_{pre}\)</span> and <span class="math notranslate nohighlight">\(t_{post}&lt;t_{pre}\)</span>. In the code, we use the parameter <code class="docutils literal notranslate"><span class="pre">time_diff</span></code> that describes the <span class="math notranslate nohighlight">\(t_{pre}-t_{post}\)</span>, as given above.</p>
<p>After implementing the code, you can visualize the STDP kernel, which describes how much the synaptic weight will change given a latency between the presynaptic and postsynaptic spikes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Delta_W</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">A_plus</span><span class="p">,</span> <span class="n">A_minus</span><span class="p">,</span> <span class="n">tau_stdp</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Plot STDP biphasic exponential decaying function</span>

<span class="sd">  Args:</span>
<span class="sd">    pars       : parameter dictionary</span>
<span class="sd">    A_plus     : (float) maxmimum amount of synaptic modification</span>
<span class="sd">                 which occurs when the timing difference between pre- and</span>
<span class="sd">                 post-synaptic spikes is positive</span>
<span class="sd">    A_plus     : (float) maxmimum amount of synaptic modification</span>
<span class="sd">                 which occurs when the timing difference between pre- and</span>
<span class="sd">                 post-synaptic spikes is negative</span>
<span class="sd">    tau_stdp   : the ranges of pre-to-postsynaptic interspike intervals</span>
<span class="sd">                 over which synaptic strengthening or weakening occurs</span>

<span class="sd">  Returns:</span>
<span class="sd">    dW         : instantaneous change in weights</span>
<span class="sd">  """</span>
  <span class="c1">#######################################################################</span>
  <span class="c1">## TODO for students: compute dP, then remove the NotImplementedError #</span>
  <span class="c1"># Fill out when you finish the function</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student excercise: compute dW, the change in weights!"</span><span class="p">)</span>
  <span class="c1">#######################################################################</span>
  <span class="c1"># STDP change</span>
  <span class="n">dW</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time_diff</span><span class="p">))</span>
  <span class="c1"># Calculate dW for LTP</span>
  <span class="n">dW</span><span class="p">[</span><span class="n">time_diff</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
  <span class="c1"># Calculate dW for LTD</span>
  <span class="n">dW</span><span class="p">[</span><span class="n">time_diff</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">dW</span>


<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars_STDP</span><span class="p">()</span>
<span class="c1"># Get parameters</span>
<span class="n">A_plus</span><span class="p">,</span> <span class="n">A_minus</span><span class="p">,</span> <span class="n">tau_stdp</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'A_plus'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'A_minus'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_stdp'</span><span class="p">]</span>
<span class="c1"># pre_spike time - post_spike time</span>
<span class="n">time_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span> <span class="o">*</span> <span class="n">tau_stdp</span><span class="p">,</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">tau_stdp</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="c1"># Uncomment to test your function</span>
<span class="c1"># dW = Delta_W(pars, A_plus, A_minus, tau_stdp)</span>
<span class="c1"># mySTDP_plot(A_plus, A_minus, tau_stdp, time_diff, dW)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D3_BiologicalNeuronModels/solutions/W2D3_Tutorial4_Solution_1ba13cde.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<img align="left" alt="Solution hint" height="416" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W2D3_BiologicalNeuronModels/static/W2D3_Tutorial4_Solution_1ba13cde_0.png" width="560"/>
</div>
<div class="section" id="keeping-track-of-pre-and-postsynaptic-spikes">
<h2>Keeping track of pre- and postsynaptic spikes<a class="headerlink" href="#keeping-track-of-pre-and-postsynaptic-spikes" title="Permalink to this headline">¶</a></h2>
<p>Since a neuron will receive numerous presynaptic spike inputs, in order to implement STDP by taking into account different synapses, we first have to keep track of the pre- and postsynaptic spike times throughout the simulation.</p>
<p>A convenient way to do this is to define the following equation for each postsynaptic neuron:</p>
<div class="amsmath math notranslate nohighlight" id="equation-900405c4-1e33-4b7e-8f1c-fc2b38ead268">
<span class="eqno">(134)<a class="headerlink" href="#equation-900405c4-1e33-4b7e-8f1c-fc2b38ead268" title="Permalink to this equation">¶</a></span>\[\begin{eqnarray}
\tau_{-} \frac{dM}{dt} = -M
\end{eqnarray}\]</div>
<p>and whenever the postsynaptic neuron spikes,</p>
<div class="amsmath math notranslate nohighlight" id="equation-2c3410fe-31a4-4ece-bc19-d517cbff9b1a">
<span class="eqno">(135)<a class="headerlink" href="#equation-2c3410fe-31a4-4ece-bc19-d517cbff9b1a" title="Permalink to this equation">¶</a></span>\[\begin{eqnarray}
M(t) = M(t) - A_{-}
\end{eqnarray}\]</div>
<p>This way <span class="math notranslate nohighlight">\(M(t)\)</span> tracks the number of postsynaptic spikes over the timescale <span class="math notranslate nohighlight">\(\tau_{-}\)</span>.</p>
<p>Similarly, for each presynaptic neuron, we define:</p>
<div class="amsmath math notranslate nohighlight" id="equation-1644ab7f-86ca-4285-9f65-c41d57bc3a9f">
<span class="eqno">(136)<a class="headerlink" href="#equation-1644ab7f-86ca-4285-9f65-c41d57bc3a9f" title="Permalink to this equation">¶</a></span>\[\begin{eqnarray}
\tau_{+} \frac{dP}{dt} = -P
\end{eqnarray}\]</div>
<p>and whenever there is spike on the presynaptic neuron,</p>
<div class="amsmath math notranslate nohighlight" id="equation-a0b07371-ca76-4612-9142-9d9d42283509">
<span class="eqno">(137)<a class="headerlink" href="#equation-a0b07371-ca76-4612-9142-9d9d42283509" title="Permalink to this equation">¶</a></span>\[\begin{eqnarray}
P(t) = P(t) + A_{+}
\end{eqnarray}\]</div>
<p>The variables <span class="math notranslate nohighlight">\(M(t)\)</span> and <span class="math notranslate nohighlight">\(P(t)\)</span> are very similar to the equations for the synaptic conductances, i.e., <span class="math notranslate nohighlight">\(g_{i}(t)\)</span>, except that they are used to keep track of pre- and postsynaptic spike times on a much longer timescale. Note that, <span class="math notranslate nohighlight">\(M(t)\)</span> is always negative, and <span class="math notranslate nohighlight">\(P(t)\)</span> is always positive. You can probably already guess that <span class="math notranslate nohighlight">\(M\)</span> is used to induce LTD and <span class="math notranslate nohighlight">\(P\)</span> to induce LTP because they are updated by <span class="math notranslate nohighlight">\(A_{-}\)</span> and <span class="math notranslate nohighlight">\(A_{+}\)</span>, respectively.</p>
<p><strong>Important note:</strong> <span class="math notranslate nohighlight">\(P(t)\)</span> depends on the presynaptic spike times. If we know the presynaptic spike times, <span class="math notranslate nohighlight">\(P\)</span> can be generated before simulating the postsynaptic neuron and the corresponding STDP weights.</p>
</div>
<div class="section" id="visualization-of-p">
<h2>Visualization of <span class="math notranslate nohighlight">\(P\)</span><a class="headerlink" href="#visualization-of-p" title="Permalink to this headline">¶</a></h2>
<p>Here, we will consider a scenario in which there is a single postsynaptic neuron connected to <span class="math notranslate nohighlight">\(N\)</span> presynaptic neurons.</p>
<p>For instance, we have one postsynaptic neuron which receives Poisson type spiking inputs from five presynaptic neurons.</p>
<p>We can simulate <span class="math notranslate nohighlight">\(P\)</span> for each one of the presynaptic neurons.</p>
</div>
<div class="section" id="exercise-2-compute-dp">
<h2>Exercise 2: Compute <span class="math notranslate nohighlight">\(dP\)</span><a class="headerlink" href="#exercise-2-compute-dp" title="Permalink to this headline">¶</a></h2>
<p>Here, yet again, we use the Euler scheme, which has been introduced several times in the previous tutorials.</p>
<p>Similar to the dynamics of the membrane potential in the LIF model, in a time step <span class="math notranslate nohighlight">\(dt\)</span>, <span class="math notranslate nohighlight">\(P(t)\)</span> will decrease by an amount of <span class="math notranslate nohighlight">\(\displaystyle{\frac{dt}{\tau_+}P(t)}\)</span>. Whereas, if a presynaptic spike arrives, <span class="math notranslate nohighlight">\(P(t)\)</span> will instantaneously increase by an amount of <span class="math notranslate nohighlight">\(A_+\)</span>. Therefore,</p>
<p>\</p>
<div class="amsmath math notranslate nohighlight" id="equation-ac7e45e2-d055-4d00-a747-279811142794">
<span class="eqno">(138)<a class="headerlink" href="#equation-ac7e45e2-d055-4d00-a747-279811142794" title="Permalink to this equation">¶</a></span>\[\begin{eqnarray}
dP = -\displaystyle{\frac{dt}{\tau_+}P[t]} + A_+\cdot \text{sp_or_not}[t+dt]
\end{eqnarray}\]</div>
<p>\</p>
<p>where the <span class="math notranslate nohighlight">\(\text{sp_or_not}\)</span> is a binary variable, i.e., <span class="math notranslate nohighlight">\(\text{sp_or_not}=1\)</span> if there is a spike within <span class="math notranslate nohighlight">\(dt\)</span>, and <span class="math notranslate nohighlight">\(\text{sp_or_not}=0\)</span> otherwise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_P</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">pre_spike_train_ex</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  track of pre-synaptic spikes</span>

<span class="sd">  Args:</span>
<span class="sd">    pars               : parameter dictionary</span>
<span class="sd">    pre_spike_train_ex : binary spike train input from</span>
<span class="sd">                         presynaptic excitatory neuron</span>

<span class="sd">  Returns:</span>
<span class="sd">    P                  : LTP ratio</span>
<span class="sd">  """</span>

  <span class="c1"># Get parameters</span>
  <span class="n">A_plus</span><span class="p">,</span> <span class="n">tau_stdp</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'A_plus'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_stdp'</span><span class="p">]</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>

  <span class="c1"># Initialize</span>
  <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pre_spike_train_ex</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="c1">#######################################################################</span>
    <span class="c1">## TODO for students: compute dP, then remove the NotImplementedError #</span>
    <span class="c1"># Fill out when you finish the function</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student excercise: compute P, the change of presynaptic spike"</span><span class="p">)</span>
    <span class="c1">#######################################################################</span>
    <span class="c1"># Calculate the delta increment dP</span>
    <span class="n">dP</span> <span class="o">=</span> <span class="o">...</span>
    <span class="c1"># Update P</span>
    <span class="n">P</span><span class="p">[:,</span> <span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">P</span><span class="p">[:,</span> <span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="n">dP</span>

  <span class="k">return</span> <span class="n">P</span>


<span class="c1"># Uncomment these lines to test your function</span>
<span class="c1"># pars = default_pars_STDP(T=200., dt=1.)</span>
<span class="c1"># pre_spike_train_ex = Poisson_generator(pars, rate=10, n=5, myseed=2020)</span>
<span class="c1"># P = generate_P(pars, pre_spike_train_ex)</span>
<span class="c1"># my_example_P()</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D3_BiologicalNeuronModels/solutions/W2D3_Tutorial4_Solution_9de149a2.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<img align="left" alt="Solution hint" height="413" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W2D3_BiologicalNeuronModels/static/W2D3_Tutorial4_Solution_9de149a2_0.png" width="485"/>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-2-implementation-of-stdp">
<h1>Section 2: Implementation of STDP<a class="headerlink" href="#section-2-implementation-of-stdp" title="Permalink to this headline">¶</a></h1>
<p>Finally, to implement STDP in spiking networks, we will change the value of the peak synaptic conductance based on the presynaptic and postsynaptic timing, thus using the variables <span class="math notranslate nohighlight">\(P(t)\)</span> and <span class="math notranslate nohighlight">\(M(t)\)</span>.</p>
<p>Each synapse <span class="math notranslate nohighlight">\(i\)</span> has its own peak synaptic conductance (<span class="math notranslate nohighlight">\(\bar g_i\)</span>), which may vary between <span class="math notranslate nohighlight">\([0, \bar g_{max}]\)</span>, and will be modified depending on the presynaptic and postsynaptic timing.</p>
<ul>
<li><p>When the <span class="math notranslate nohighlight">\(i_{th}\)</span> presynaptic neuron elicits a spike, its corresponding peak conductance is updated according to the following equation:</p>
<p>\</p>
<div class="amsmath math notranslate nohighlight" id="equation-8e19ef81-f828-47aa-bcfe-2736c8120d61">
<span class="eqno">(139)<a class="headerlink" href="#equation-8e19ef81-f828-47aa-bcfe-2736c8120d61" title="Permalink to this equation">¶</a></span>\[\begin{eqnarray}
  \bar g_i = \bar g_i + M(t)\bar g_{max}
  \end{eqnarray}\]</div>
<p>\</p>
<p>Note that, <span class="math notranslate nohighlight">\(M(t)\)</span> tracks the time since the last postsynaptic potential and is always negative. Hence, if <em>the postsynaptic neuron spikes shortly before the presynaptic neuron</em>, the above equation shows that the peak conductance will decrease.</p>
</li>
<li><p>When the postsynaptic neuron spikes, the peak conductance of <strong>each</strong> synapse is updated according to:</p>
<p>\</p>
<div class="amsmath math notranslate nohighlight" id="equation-8b38e425-5d0d-4ef2-82d2-e6efe7279cc1">
<span class="eqno">(140)<a class="headerlink" href="#equation-8b38e425-5d0d-4ef2-82d2-e6efe7279cc1" title="Permalink to this equation">¶</a></span>\[\begin{eqnarray}
  \bar g_i = \bar g_i + P_i(t)\bar g_{max}, \forall i
  \end{eqnarray}\]</div>
<p>\</p>
<p>Note that, <span class="math notranslate nohighlight">\(P_i(t)\)</span> tracks the time since the last spike of <span class="math notranslate nohighlight">\(i_{th}\)</span> pre-synaptic neuron and is always positive.</p>
<p>Thus, the equation given above shows that if the presynaptic neuron spikes before the postsynaptic neuron, its peak conductance will increase.</p>
</li>
</ul>
<div class="section" id="lif-neuron-connected-with-synapses-that-show-stdp">
<h2>LIF neuron connected with synapses that show STDP<a class="headerlink" href="#lif-neuron-connected-with-synapses-that-show-stdp" title="Permalink to this headline">¶</a></h2>
<p>In the following exercise, we connect <span class="math notranslate nohighlight">\(N\)</span> presynaptic neurons to a single postsynaptic neuron. We do not need to simulate the dynamics of each presynaptic neuron as we are only concerned about their spike times. So, we will generate <span class="math notranslate nohighlight">\(N\)</span> Poisson type spikes. Here, we will assume that all these inputs are excitatory.</p>
<p>We need to simulate the dynamics of the postsynaptic neuron as we do not know its spike times. We model the postsynaptic neuron as an LIF neuron receiving only excitatory inputs.</p>
<p>\</p>
<div class="amsmath math notranslate nohighlight" id="equation-6b20c081-6a05-4aea-a363-095c62dd7c7d">
<span class="eqno">(141)<a class="headerlink" href="#equation-6b20c081-6a05-4aea-a363-095c62dd7c7d" title="Permalink to this equation">¶</a></span>\[\begin{eqnarray}
\tau_m\frac{dV}{dt} = -(V-E_L) - g_E(t) (V(t)-E_E)\,
\end{eqnarray}\]</div>
<p>\</p>
<p>where the total excitatory synaptic conductance  <span class="math notranslate nohighlight">\(g_{E}(t)\)</span>  is given by:</p>
<p>\</p>
<div class="amsmath math notranslate nohighlight" id="equation-9a98627b-d0f0-4d2a-8d2e-448a0a5b5357">
<span class="eqno">(142)<a class="headerlink" href="#equation-9a98627b-d0f0-4d2a-8d2e-448a0a5b5357" title="Permalink to this equation">¶</a></span>\[\begin{eqnarray}
g_E(t) = \sum_{i=1}^{N} g_i(t) \,
\end{eqnarray}\]</div>
<p>\</p>
<p>While simulating STDP, it is important to make sure that <span class="math notranslate nohighlight">\(\bar g_i\)</span> never goes outside of its bounds.</p>
</div>
<div class="section" id="function-for-lif-neuron-with-stdp-synapses">
<h2>Function for LIF neuron with STDP synapses<a class="headerlink" href="#function-for-lif-neuron-with-stdp-synapses" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Function for LIF neuron with STDP synapses</span>


<span class="k">def</span> <span class="nf">run_LIF_cond_STDP</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">pre_spike_train_ex</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  conductance-based LIF dynamics</span>

<span class="sd">  Args:</span>
<span class="sd">    pars               : parameter dictionary</span>
<span class="sd">    pre_spike_train_ex : spike train input from presynaptic excitatory neuron</span>

<span class="sd">  Returns:</span>
<span class="sd">    rec_spikes         : spike times</span>
<span class="sd">    rec_v              : mebrane potential</span>
<span class="sd">    gE                 : postsynaptic excitatory conductance</span>
<span class="sd">  """</span>

  <span class="c1"># Retrieve parameters</span>
  <span class="n">V_th</span><span class="p">,</span> <span class="n">V_reset</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_th'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_reset'</span><span class="p">]</span>
  <span class="n">tau_m</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_m'</span><span class="p">]</span>
  <span class="n">V_init</span><span class="p">,</span> <span class="n">V_L</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_L'</span><span class="p">]</span>
  <span class="n">gE_bar</span><span class="p">,</span> <span class="n">VE</span><span class="p">,</span> <span class="n">tau_syn_E</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'gE_bar'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'VE'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_syn_E'</span><span class="p">]</span>
  <span class="n">gE_init</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'gE_init'</span><span class="p">]</span>
  <span class="n">tref</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tref'</span><span class="p">]</span>
  <span class="n">A_minus</span><span class="p">,</span> <span class="n">tau_stdp</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'A_minus'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_stdp'</span><span class="p">]</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>

  <span class="n">P</span> <span class="o">=</span> <span class="n">generate_P</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">pre_spike_train_ex</span><span class="p">)</span>

  <span class="c1"># Initialize</span>
  <span class="n">tr</span> <span class="o">=</span> <span class="mf">0.</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_init</span>
  <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">gE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">gE_bar_update</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">pre_spike_train_ex</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
  <span class="n">gE_bar_update</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">gE_init</span>  <span class="c1"># note: gE_bar is the maximum value</span>

  <span class="c1"># simulation</span>
  <span class="n">rec_spikes</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># recording spike times</span>
  <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">tr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
          <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>
          <span class="n">tr</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">-</span> <span class="mi">1</span>
      <span class="k">elif</span> <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">V_th</span><span class="p">:</span>   <span class="c1"># reset voltage and record spike event</span>
          <span class="n">rec_spikes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
          <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>
          <span class="n">M</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">A_minus</span>
          <span class="n">gE_bar_update</span><span class="p">[:,</span> <span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">gE_bar_update</span><span class="p">[:,</span> <span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="n">P</span><span class="p">[:,</span> <span class="n">it</span><span class="p">]</span> <span class="o">*</span> <span class="n">gE_bar</span>
          <span class="n">id_temp</span> <span class="o">=</span> <span class="n">gE_bar_update</span><span class="p">[:,</span> <span class="n">it</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">gE_bar</span>
          <span class="n">gE_bar_update</span><span class="p">[</span><span class="n">id_temp</span><span class="p">,</span> <span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">gE_bar</span>
          <span class="n">tr</span> <span class="o">=</span> <span class="n">tref</span> <span class="o">/</span> <span class="n">dt</span>

      <span class="c1"># update the synaptic conductance</span>
      <span class="n">M</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">M</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">dt</span> <span class="o">/</span> <span class="n">tau_stdp</span> <span class="o">*</span> <span class="n">M</span><span class="p">[</span><span class="n">it</span><span class="p">]</span>
      <span class="n">gE</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">gE</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau_syn_E</span><span class="p">)</span> <span class="o">*</span> <span class="n">gE</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">gE_bar_update</span><span class="p">[:,</span> <span class="n">it</span><span class="p">]</span> <span class="o">*</span> <span class="n">pre_spike_train_ex</span><span class="p">[:,</span> <span class="n">it</span><span class="p">])</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
      <span class="n">gE_bar_update</span><span class="p">[:,</span> <span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">gE_bar_update</span><span class="p">[:,</span> <span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="n">M</span><span class="p">[</span><span class="n">it</span><span class="p">]</span><span class="o">*</span><span class="n">pre_spike_train_ex</span><span class="p">[:,</span> <span class="n">it</span><span class="p">]</span><span class="o">*</span><span class="n">gE_bar</span>
      <span class="n">id_temp</span> <span class="o">=</span> <span class="n">gE_bar_update</span><span class="p">[:,</span> <span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">0</span>
      <span class="n">gE_bar_update</span><span class="p">[</span><span class="n">id_temp</span><span class="p">,</span> <span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>

      <span class="c1"># calculate the increment of the membrane potential</span>
      <span class="n">dv</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">V_L</span><span class="p">)</span> <span class="o">-</span> <span class="n">gE</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">VE</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau_m</span><span class="p">)</span>

      <span class="c1"># update membrane potential</span>
      <span class="n">v</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="n">dv</span>

  <span class="n">rec_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rec_spikes</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

  <span class="k">return</span> <span class="n">v</span><span class="p">,</span> <span class="n">rec_spikes</span><span class="p">,</span> <span class="n">gE</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">gE_bar_update</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="evolution-of-excitatory-synaptic-conductance">
<h2>Evolution of excitatory synaptic conductance<a class="headerlink" href="#evolution-of-excitatory-synaptic-conductance" title="Permalink to this headline">¶</a></h2>
<p>In the following exercise, we will simulate an LIF neuron receiving input from <span class="math notranslate nohighlight">\(N=300\)</span> presynaptic neurons.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars_STDP</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">200.</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>  <span class="c1"># Simulation duration 200 ms</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'gE_bar'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.024</span>                   <span class="c1"># max synaptic conductance</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'gE_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.024</span>                  <span class="c1"># initial synaptic conductance</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'VE'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>                          <span class="c1"># [mV] Synapse reversal potential</span>
<span class="n">pars</span><span class="p">[</span><span class="s1">'tau_syn_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5.</span>                   <span class="c1"># [ms] EPSP time constant</span>

<span class="c1"># generate Poisson type spike trains</span>
<span class="n">pre_spike_train_ex</span> <span class="o">=</span> <span class="n">Poisson_generator</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span>
<span class="c1"># simulate the LIF neuron and record the synaptic conductance</span>
<span class="n">v</span><span class="p">,</span> <span class="n">rec_spikes</span><span class="p">,</span> <span class="n">gE</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">gE_bar_update</span> <span class="o">=</span> <span class="n">run_LIF_cond_STDP</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span>
                                                           <span class="n">pre_spike_train_ex</span><span class="p">)</span>
</pre></div>
</div>
</div>

</div>
<div class="section" id="figures-of-the-evolution-of-synaptic-conductance">
<h3>Figures of the evolution of synaptic conductance<a class="headerlink" href="#figures-of-the-evolution-of-synaptic-conductance" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figures of the evolution of synaptic conductance</span>

<span class="c1"># @markdown Run this cell to see the figures!</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">12.</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">321</span><span class="p">)</span>
<span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
<span class="k">if</span> <span class="n">rec_spikes</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
  <span class="n">sp_num</span> <span class="o">=</span> <span class="p">(</span><span class="n">rec_spikes</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
  <span class="n">v</span><span class="p">[</span><span class="n">sp_num</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">10</span>   <span class="c1"># add artificial spikes</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">v</span><span class="p">,</span> <span class="s1">'k'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (ms)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'V (mV)'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">322</span><span class="p">)</span>
<span class="c1"># Plot the sample presynaptic spike trains</span>
<span class="n">my_raster_plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">pre_spike_train_ex</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">323</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">M</span><span class="p">,</span> <span class="s1">'k'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (ms)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'M'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">324</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">P</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (ms)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'P'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">325</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">gE_bar_update</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (ms)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\bar g$'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">326</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">gE</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Time (ms)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$g_E$'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">9</span><span class="o">-</span><span class="mi">5</span><span class="n">f328a51a596</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">321</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="k">if</span> <span class="n">rec_spikes</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>   <span class="n">sp_num</span> <span class="o">=</span> <span class="p">(</span><span class="n">rec_spikes</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>   <span class="n">v</span><span class="p">[</span><span class="n">sp_num</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">10</span>   <span class="c1"># add artificial spikes</span>

<span class="ne">NameError</span>: name 'rec_spikes' is not defined
</pre></div>
</div>
<img alt="../../../_images/W2D3_Tutorial4_28_1.png" src="../../../_images/W2D3_Tutorial4_28_1.png">
</img></div>
</div>
</div>
</div>
<div class="section" id="think">
<h2>Think!<a class="headerlink" href="#think" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>In the above, even though all the presynaptic neurons have the same average firing rate, many of the synapses seem to have been weakened? Did you expect that?</p></li>
<li><p>Total synaptic conductance is fluctuating over time. How do you expect <span class="math notranslate nohighlight">\(g_E\)</span> to fluctuate if synapses did not show any STDP like behavior?</p></li>
<li><p>Do synaptic weight ever reach a stationary state when synapses show STDP?</p></li>
</ul>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D3_BiologicalNeuronModels/solutions/W2D3_Tutorial4_Solution_07dba4f3.py"><em>Click for solution</em></a></p>
</div>
<div class="section" id="distribution-of-synaptic-weight">
<h2>Distribution of synaptic weight<a class="headerlink" href="#distribution-of-synaptic-weight" title="Permalink to this headline">¶</a></h2>
<p>From the example given above, we get an idea that some synapses depotentiate, but what is the distribution of the synaptic weights when synapses show STDP?</p>
<p>In fact, it is possible that even the synaptic weight distribution itself is a time-varying quantity. So, we would like to know how the distribution of synaptic weights evolves as a function of time.</p>
<p>To get a better estimate of the weight distribution and its time evolution, we will increase the presynaptic firing rate to <span class="math notranslate nohighlight">\(15\)</span>Hz and simulate the postsynaptic neuron for <span class="math notranslate nohighlight">\(120\)</span>s.</p>
<div class="section" id="functions-for-simulating-a-lif-neuron-with-stdp-synapses">
<h3>Functions for simulating a LIF neuron with STDP synapses<a class="headerlink" href="#functions-for-simulating-a-lif-neuron-with-stdp-synapses" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Functions for simulating a LIF neuron with STDP synapses</span>


<span class="k">def</span> <span class="nf">example_LIF_STDP</span><span class="p">(</span><span class="n">inputrate</span><span class="o">=</span><span class="mf">15.</span><span class="p">,</span> <span class="n">Tsim</span><span class="o">=</span><span class="mf">120000.</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Simulation of a LIF model with STDP synapses</span>

<span class="sd">  Args:</span>
<span class="sd">    intputrate  :  The rate used for generate presynaptic spike trains</span>
<span class="sd">    Tsim        :  Total simulation time</span>

<span class="sd">  output:</span>
<span class="sd">    Interactive demo, Visualization of synaptic weights</span>
<span class="sd">  """</span>

  <span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars_STDP</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">Tsim</span><span class="p">,</span>  <span class="n">dt</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'gE_bar'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.024</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'gE_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.014</span>  <span class="c1"># initial synaptic conductance</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'VE'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>          <span class="c1"># [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_syn_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5.</span>   <span class="c1"># [ms]</span>

  <span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
  <span class="n">pre_spike_train_ex</span> <span class="o">=</span> <span class="n">Poisson_generator</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">inputrate</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
                                         <span class="n">myseed</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span>  <span class="c1"># generate Poisson trains</span>
  <span class="n">v</span><span class="p">,</span> <span class="n">rec_spikes</span><span class="p">,</span> <span class="n">gE</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">gE_bar_update</span> <span class="o">=</span> <span class="n">run_LIF_cond_STDP</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span>
                                                             <span class="n">pre_spike_train_ex</span><span class="p">)</span>  <span class="c1"># simulate LIF neuron with STDP</span>
  <span class="n">gbar_norm</span> <span class="o">=</span> <span class="n">gE_bar_update</span><span class="o">/</span><span class="n">pars</span><span class="p">[</span><span class="s1">'gE_bar'</span><span class="p">]</span>  <span class="c1"># calculate the ratio of the synaptic conductance</span>
  <span class="n">endtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
  <span class="n">timecost</span> <span class="o">=</span> <span class="p">(</span><span class="n">endtime</span> <span class="o">-</span> <span class="n">starttime</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.</span>

  <span class="nb">print</span><span class="p">(</span><span class="s1">'Total simulation time is </span><span class="si">%.3f</span><span class="s1"> min'</span> <span class="o">%</span> <span class="n">timecost</span><span class="p">)</span>

  <span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">'620px'</span>

  <span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
      <span class="n">sample_time</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                                      <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">)</span>
  <span class="p">)</span>


  <span class="k">def</span> <span class="nf">my_visual_STDP_distribution</span><span class="p">(</span><span class="n">sample_time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>
    <span class="n">sample_time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sample_time</span> <span class="o">*</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">sample_time</span> <span class="o">=</span> <span class="n">sample_time</span> <span class="o">*</span> <span class="p">(</span><span class="n">sample_time</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
      <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">][::</span><span class="mi">1000</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1000.</span><span class="p">,</span> <span class="n">gE_bar_update</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">::</span><span class="mi">1000</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">1e-3</span> <span class="o">*</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">][</span><span class="n">sample_time</span><span class="p">],</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">'--'</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">122</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Time (s)'</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\bar</span><span class="si">{g}</span><span class="s1">$'</span><span class="p">)</span>

    <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mf">.05</span><span class="p">)</span>
    <span class="n">g_dis</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">gbar_norm</span><span class="p">[:,</span> <span class="n">sample_time</span><span class="p">],</span> <span class="n">bins</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">g_dis</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\bar</span><span class="si">{g}</span><span class="s1">/g_{\mathrm</span><span class="si">{max}</span><span class="s1">}$'</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Number'</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">((</span><span class="s1">'Time = </span><span class="si">%.1f</span><span class="s1"> s'</span> <span class="o">%</span> <span class="p">(</span><span class="mf">1e-3</span> <span class="o">*</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">][</span><span class="n">sample_time</span><span class="p">])),</span>
                  <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="nb">print</span><span class="p">(</span><span class="n">help</span><span class="p">(</span><span class="n">example_LIF_STDP</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function example_LIF_STDP in module __main__:

example_LIF_STDP(inputrate=15.0, Tsim=120000.0)
    Simulation of a LIF model with STDP synapses
    
    Args:
      intputrate  :  The rate used for generate presynaptic spike trains
      Tsim        :  Total simulation time
    
    output:
      Interactive demo, Visualization of synaptic weights

None
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-example-of-an-lif-model-with-stdp">
<h3>Interactive Demo: Example of an LIF model with STDP<a class="headerlink" href="#interactive-demo-example-of-an-lif-model-with-stdp" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id1">
<h4><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>

<span class="n">example_LIF_STDP</span><span class="p">(</span><span class="n">inputrate</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>

</div>
</div>
</div>
</div>
<div class="section" id="id2">
<h2>Think!<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>Increase the firing rate (i.e., 30 Hz) of presynaptic neurons, and investigate the effect on the dynamics of synaptic weight distribution.</p>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D3_BiologicalNeuronModels/solutions/W2D3_Tutorial4_Solution_fe78e137.py"><em>Click for solution</em></a></p>
</div>
</div>
<div class="section" id="section-3-effect-of-input-correlations">
<h1>Section 3: Effect of input correlations<a class="headerlink" href="#section-3-effect-of-input-correlations" title="Permalink to this headline">¶</a></h1>
<p>Thus far, we assumed that the input population was uncorrelated. What do you think will happen if presynaptic neurons were correlated?</p>
<p>In the following, we will modify the input such that first <span class="math notranslate nohighlight">\(L\)</span> neurons have identical spike trains while the remaining inputs are uncorrelated. This is a highly simplified model of introducing correlations. You can try to code your own model of correlated spike trains.</p>
<div class="section" id="function-for-lif-neuron-with-stdp-synapses-receiving-correlated-inputs">
<h2>Function for LIF neuron with STDP synapses receiving correlated inputs<a class="headerlink" href="#function-for-lif-neuron-with-stdp-synapses-receiving-correlated-inputs" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title Function for LIF neuron with STDP synapses receiving correlated inputs</span>


<span class="k">def</span> <span class="nf">example_LIF_STDP_corrInput</span><span class="p">(</span><span class="n">inputrate</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">Tsim</span><span class="o">=</span><span class="mf">120000.</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  A LIF model equipped with STDP synapses, receiving correlated inputs</span>

<span class="sd">  Args:</span>
<span class="sd">    intputrate      :  The rate used for generate presynaptic spike trains</span>
<span class="sd">    Tsim            :  Total simulation time</span>

<span class="sd">  Returns:</span>
<span class="sd">    Interactive demo: Visualization of synaptic weights</span>
<span class="sd">  """</span>

  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">2020</span><span class="p">)</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars_STDP</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="n">Tsim</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'gE_bar'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.024</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'VE'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>                                <span class="c1"># [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'gE_init'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.024</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span>  <span class="c1"># initial synaptic conductance</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_syn_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5.</span>                         <span class="c1"># [ms]</span>

  <span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
  <span class="n">pre_spike_train_ex</span> <span class="o">=</span> <span class="n">Poisson_generator</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">inputrate</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">2020</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i_pre</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">pre_spike_train_ex</span><span class="p">[</span><span class="n">i_pre</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="n">pre_spike_train_ex</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:]</span>  <span class="c1"># simple way to set input correlated</span>
  <span class="n">v</span><span class="p">,</span> <span class="n">rec_spikes</span><span class="p">,</span> <span class="n">gE</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">gE_bar_update</span> <span class="o">=</span> <span class="n">run_LIF_cond_STDP</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">pre_spike_train_ex</span><span class="p">)</span> <span class="c1"># simulate LIF neuron with STDP</span>
  <span class="n">gbar_norm</span> <span class="o">=</span> <span class="n">gE_bar_update</span> <span class="o">/</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'gE_bar'</span><span class="p">]</span>  <span class="c1"># calculate the ratio of the synaptic conductance</span>
  <span class="n">endtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
  <span class="n">timecost</span> <span class="o">=</span> <span class="p">(</span><span class="n">endtime</span> <span class="o">-</span> <span class="n">starttime</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.</span>

  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Total simulation time is </span><span class="si">{</span><span class="n">timecost</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1"> min'</span><span class="p">)</span>

  <span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">'620px'</span>

  <span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
      <span class="n">sample_time</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
                                      <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">)</span>
  <span class="p">)</span>


  <span class="k">def</span> <span class="nf">my_visual_STDP_distribution</span><span class="p">(</span><span class="n">sample_time</span><span class="o">=</span><span class="mf">0.0</span><span class="p">):</span>

    <span class="n">sample_time</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">sample_time</span> <span class="o">*</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">sample_time</span> <span class="o">=</span> <span class="n">sample_time</span><span class="o">*</span><span class="p">(</span><span class="n">sample_time</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">figtemp</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
      <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">][::</span><span class="mi">1000</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1000.</span><span class="p">,</span>
               <span class="n">gE_bar_update</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">::</span><span class="mi">1000</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
      <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">][::</span><span class="mi">1000</span><span class="p">]</span> <span class="o">/</span> <span class="mf">1000.</span><span class="p">,</span>
               <span class="n">gE_bar_update</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">50</span><span class="p">,</span> <span class="p">::</span><span class="mi">1000</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span>
               <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">1e-3</span> <span class="o">*</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">][</span><span class="n">sample_time</span><span class="p">],</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">'k'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">'--'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">122</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'Time (s)'</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\bar</span><span class="si">{g}</span><span class="s1">$'</span><span class="p">)</span>
    <span class="n">legend</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s1">'Correlated input'</span><span class="p">,</span> <span class="s1">'Uncorrelated iput'</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span>
                      <span class="n">loc</span><span class="o">=</span><span class="p">[</span><span class="mf">0.92</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6</span><span class="p">],</span> <span class="n">frameon</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">color</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">([</span><span class="s1">'r'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">],</span> <span class="n">legend</span><span class="o">.</span><span class="n">get_texts</span><span class="p">(),</span> <span class="n">legend</span><span class="o">.</span><span class="n">legendHandles</span><span class="p">):</span>
      <span class="n">text</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="n">color</span><span class="p">)</span>
      <span class="n">item</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mf">.05</span><span class="p">,</span> <span class="mf">1.05</span><span class="p">,</span> <span class="mf">.05</span><span class="p">)</span>
    <span class="n">g_dis_cc</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">gbar_norm</span><span class="p">[:</span><span class="mi">50</span><span class="p">,</span> <span class="n">sample_time</span><span class="p">],</span> <span class="n">bins</span><span class="p">)</span>
    <span class="n">g_dis_dp</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">gbar_norm</span><span class="p">[</span><span class="mi">50</span><span class="p">:,</span> <span class="n">sample_time</span><span class="p">],</span> <span class="n">bins</span><span class="p">)</span>

    <span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">g_dis_cc</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">g_dis_dp</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">'$\bar</span><span class="si">{g}</span><span class="s1">/g_{\mathrm</span><span class="si">{max}</span><span class="s1">}$'</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'Number'</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">((</span><span class="s1">'Time = </span><span class="si">%.1f</span><span class="s1"> s'</span> <span class="o">%</span> <span class="p">(</span><span class="mf">1e-3</span> <span class="o">*</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">][</span><span class="n">sample_time</span><span class="p">])),</span>
                  <span class="n">fontweight</span><span class="o">=</span><span class="s1">'bold'</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>


<span class="nb">print</span><span class="p">(</span><span class="n">help</span><span class="p">(</span><span class="n">example_LIF_STDP_corrInput</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function example_LIF_STDP_corrInput in module __main__:

example_LIF_STDP_corrInput(inputrate=20.0, Tsim=120000.0)
    A LIF model equipped with STDP synapses, receiving correlated inputs
    
    Args:
      intputrate      :  The rate used for generate presynaptic spike trains
      Tsim            :  Total simulation time
    
    Returns:
      Interactive demo: Visualization of synaptic weights

None
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-lif-model-with-plastic-synapses-receiving-correlated-inputs">
<h2>Interactive Demo: LIF model with plastic synapses receiving correlated inputs<a class="headerlink" href="#interactive-demo-lif-model-with-plastic-synapses-receiving-correlated-inputs" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id3">
<h3><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>

<span class="n">example_LIF_STDP_corrInput</span><span class="p">(</span><span class="n">inputrate</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
</pre></div>
</div>
</div>

</div>
<p><strong>Why do weights of uncorrelated neurons decrease when synapses show STDP</strong></p>
<p>Above, we notice that the synapses of correlated neurons (which spike together) were almost unaffected, but the weights of other neurons diminished. Why does this happen?</p>
<p>The reason is that the correlated presynaptic neurons have a higher chance of eliciting a spike in the postsynaptic neurons and that create a <span class="math notranslate nohighlight">\(pre \rightarrow post\)</span> pairing of spikes.</p>
</div>
</div>
<div class="section" id="id4">
<h2>Think!<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Modify the code above and create two groups of correlated presynaptic neurons and test what happens to the weight distribution.</p></li>
<li><p>How can the above observations be used to create unsupervised learning? Could you imagine how we have to train a neuronal model enabled with STDP rule to identify input patterns?</p></li>
<li><p>What else can be done with this type of plasticity?</p></li>
</ul>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D3_BiologicalNeuronModels/solutions/W2D3_Tutorial4_Solution_b397ae39.py"><em>Click for solution</em></a></p>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p>Hooray! You have just finished this loooong day! In this tutorial, we covered the concept of <strong>spike-timing dependent plasticity (STDP)</strong>.</p>
<p>We managed to:</p>
<ul class="simple">
<li><p>build a model of synapse that shows STDP.</p></li>
<li><p>study how correlations in input spike trains influence the distribution of synaptic weights.</p></li>
</ul>
<p>Using presynaptic inputs as Poisson type spike trains, we modeled an LIF model with synapses equipped with STDP. We also studied the effect of correlated inputs on the synaptic strength!</p>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"28a4ef307f404665817f678aa24a3107": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}}, "version_major": 2, "version_minor": 0}
</script>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W2D3_BiologicalNeuronModels/student"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
<div class="prev-next-bottom">
<a class="left-prev" href="W2D3_Tutorial3.html" id="prev-link" title="previous page">Tutorial 3: Synaptic transmission - Models of static and dynamic synapses</a>
<a class="right-next" href="../W2D3_Outro.html" id="next-link" title="next page">Outro</a>
</div>
</div>
</div>
<footer class="footer mt-5 mt-md-0">
<div class="container">
<p>
        
          By Neuromatch<br/>
        
            © Copyright 2021.<br/>
</p>
</div>
</footer>
</main>
</div>
</div>
<script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>
</body>
</html>