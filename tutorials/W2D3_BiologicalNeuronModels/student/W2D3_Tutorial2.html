
<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Tutorial 2: Effects of Input Correlation — Neuromatch Academy: Computational Neuroscience</title>
<link href="../../../_static/css/theme.css" rel="stylesheet"/>
<link href="../../../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet"/>
<link href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css" rel="stylesheet"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2" rel="preload" type="font/woff2"/>
<link as="font" crossorigin="" href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2" rel="preload" type="font/woff2"/>
<link href="../../../_static/pygments.css" rel="stylesheet" type="text/css">
<link href="../../../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" rel="stylesheet" type="text/css">
<link href="../../../_static/togglebutton.css" rel="stylesheet" type="text/css">
<link href="../../../_static/copybutton.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/mystnb.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/sphinx-thebe.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" rel="stylesheet" type="text/css"/>
<link href="../../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" rel="stylesheet" type="text/css"/>
<link as="script" href="../../../_static/js/index.1c5a1a01449ed65a7b51.js" rel="preload"/>
<script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
<script src="../../../_static/jquery.js"></script>
<script src="../../../_static/underscore.js"></script>
<script src="../../../_static/doctools.js"></script>
<script src="../../../_static/togglebutton.js"></script>
<script src="../../../_static/clipboard.min.js"></script>
<script src="../../../_static/copybutton.js"></script>
<script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
<script src="../../../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
<script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
<script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
<script async="async" src="../../../_static/sphinx-thebe.js"></script>
<script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
<link href="../../../_static/nma-logo-square-4xp.jpg" rel="shortcut icon">
<link href="../../../genindex.html" rel="index" title="Index"/>
<link href="../../../search.html" rel="search" title="Search"/>
<link href="W2D3_Tutorial3.html" rel="next" title="Tutorial 3: Synaptic transmission - Models of static and dynamic synapses"/>
<link href="W2D3_Tutorial1.html" rel="prev" title="Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="en" name="docsearch:language"/>
</link></link></link></link></head>
<body data-offset="80" data-spy="scroll" data-target="#bd-toc-nav">
<div class="container-fluid" id="banner"></div>
<div class="container-xl">
<div class="row">
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
<div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../../index.html">
<img alt="logo" class="logo" src="../../../_static/nma-logo-square-4xp.jpg"/>
<h1 class="site-logo" id="site-title">Neuromatch Academy: Computational Neuroscience</h1>
</a>
</div><form action="../../../search.html" class="bd-search d-flex align-items-center" method="get">
<i class="icon fas fa-search"></i>
<input aria-label="Search this book..." autocomplete="off" class="form-control" id="search-input" name="q" placeholder="Search this book..." type="search"/>
</form><nav aria-label="Main navigation" class="bd-links" id="bd-docs-nav">
<div class="bd-toc-item active">
<ul class="nav bd-sidenav">
<li class="toctree-l1">
<a class="reference internal" href="../../../intro.html">
   Introduction
  </a>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Pre-reqs Refresher
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/chapter_title.html">
   Neuro Video Series (W0D0)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox">
<label for="toctree-checkbox-1">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial1.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial2.html">
     Human Psychophysics
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial3.html">
     Behavioral Readout
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial4.html">
     Live in Lab
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial5.html">
     Brain Signals: Spiking Activity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial6.html">
     Brain Signals: LFP
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial7.html">
     Brain Signals: EEG &amp; MEG
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial8.html">
     Brain Signals: fMRI
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial9.html">
     Brain Signals: Calcium Imaging
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial10.html">
     Stimulus Representation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial11.html">
     Neurotransmitters
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D0_NeuroVideoSeries/student/W0D0_Tutorial12.html">
     Neurons to Consciousness
    </a>
</li>
</ul>
</input></li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/chapter_title.html">
   Python Workshop 1 (W0D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
<label for="toctree-checkbox-2">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D1_PythonWorkshop1/student/W0D1_Tutorial1.html">
     Tutorial: LIF Neuron - Part I
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/chapter_title.html">
   Python Workshop 2 (W0D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
<label for="toctree-checkbox-3">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D2_PythonWorkshop2/student/W0D2_Tutorial1.html">
     Tutorial 1: LIF Neuron Part II
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D3_LinearAlgebra/chapter_title.html">
   Linear Algebra (W0D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
<label for="toctree-checkbox-4">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial1.html">
     Tutorial 1: Vectors
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial2.html">
     Tutorial 2: Matrices
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D3_LinearAlgebra/student/W0D3_Tutorial3.html">
     Bonus Tutorial: Discrete Dynamical Systems
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D4_Calculus/chapter_title.html">
   Calculus (W0D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
<label for="toctree-checkbox-5">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/student/W0D4_Tutorial1.html">
     Tutorial 1: Basics of Differential and Integral Calculus
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/student/W0D4_Tutorial2.html">
     Tutorial 2: Differential Equations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D4_Calculus/student/W0D4_Tutorial3.html">
     Tutorial 3: Numerical Methods
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W0D5_Statistics/chapter_title.html">
   Statistics (W0D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
<label for="toctree-checkbox-6">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/student/W0D5_Tutorial1.html">
     Neuromatch Academy: Precourse Week, Day 5, Tutorial 1
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W0D5_Statistics/student/W0D5_Tutorial2.html">
     Tutorial 2: Statistical Inference
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Intro to Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D1_ModelTypes/chapter_title.html">
   Model Types (W1D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
<label for="toctree-checkbox-7">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/W1D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/student/W1D1_Tutorial1.html">
     Tutorial 1: “What” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/student/W1D1_Tutorial2.html">
     Tutorial 2: “How” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/student/W1D1_Tutorial3.html">
     Tutorial 3: “Why” models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/W1D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D1_ModelTypes/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D2_ModelingPractice/chapter_title.html">
   Modeling Practice (W1D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
<label for="toctree-checkbox-8">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelingPractice/W1D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelingPractice/student/W1D2_Tutorial1.html">
     Tutorial: Framing the Question
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D2_ModelingPractice/W1D2_Outro.html">
     Outro
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Machine Learning
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D3_ModelFitting/chapter_title.html">
   Model Fitting (W1D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
<label for="toctree-checkbox-9">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/W1D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial1.html">
     Tutorial 1: Linear regression with MSE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial2.html">
     Tutorial 2: Linear regression with MLE
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial3.html">
     Tutorial 3: Confidence intervals and bootstrapping
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial4.html">
     Tutorial 4: Multiple linear regression and polynomial regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial5.html">
     Tutorial 5: Model Selection: Bias-variance trade-off
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/student/W1D3_Tutorial6.html">
     Tutorial 6: Model Selection: Cross-validation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/W1D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D3_ModelFitting/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/chapter_title.html">
   Generalized Linear Models (W1D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
<label for="toctree-checkbox-10">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/W1D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/student/W1D4_Tutorial1.html">
     Tutorial 1: GLMs for Encoding
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/student/W1D4_Tutorial2.html">
     Tutorial 2: Classifiers and regularizers
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/W1D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D4_GeneralizedLinearModels/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/chapter_title.html">
   Dimensionality Reduction (W1D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
<label for="toctree-checkbox-11">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/W1D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial1.html">
     Tutorial 1: Geometric view of data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial2.html">
     Tutorial 2: Principal Component Analysis
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial3.html">
     Tutorial 3: Dimensionality Reduction &amp; Reconstruction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/student/W1D5_Tutorial4.html">
     Tutorial 4:  Nonlinear Dimensionality Reduction
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/W1D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W1D5_DimensionalityReduction/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D1_DeepLearning/chapter_title.html">
   Deep Learning (W2D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
<label for="toctree-checkbox-12">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/W2D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/student/W2D1_Tutorial1.html">
     Tutorial 1: Decoding Neural Responses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/student/W2D1_Tutorial2.html">
     Tutorial 2: Convolutional Neural Networks
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/student/W2D1_Tutorial3.html">
     Tutorial 2: Building and Evaluating Normative Encoding Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/W2D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D1_DeepLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Dynamical Systems
 </span>
</p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D2_LinearSystems/chapter_title.html">
   Linear Systems (W2D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
<label for="toctree-checkbox-13">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/W2D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial1.html">
     Tutorial 1: Linear dynamical systems
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial2.html">
     Tutorial 2: Markov Processes
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial3.html">
     Tutorial 3: Combining determinism and stochasticity
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/student/W2D2_Tutorial4.html">
     Tutorial 4: Autoregressive models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/W2D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D2_LinearSystems/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 current active has-children">
<a class="reference internal" href="../chapter_title.html">
   Biological Neuron Models (W2D3)
  </a>
<input checked="" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
<label for="toctree-checkbox-14">
<i class="fas fa-chevron-down">
</i>
</label>
<ul class="current">
<li class="toctree-l2">
<a class="reference internal" href="../W2D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D3_Tutorial1.html">
     Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model
    </a>
</li>
<li class="toctree-l2 current active">
<a class="current reference internal" href="#">
     Tutorial 2: Effects of Input Correlation
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D3_Tutorial3.html">
     Tutorial 3: Synaptic transmission - Models of static and dynamic synapses
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="W2D3_Tutorial4.html">
     Tutorial 4: Spike-timing dependent plasticity (STDP)
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../W2D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W2D4_DynamicNetworks/chapter_title.html">
   Dynamic Networks (W2D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
<label for="toctree-checkbox-15">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/W2D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/student/W2D4_Tutorial1.html">
     Tutorial 1: Neural Rate Models
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/student/W2D4_Tutorial2.html">
     Tutorial 2: Wilson-Cowan Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/W2D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W2D4_DynamicNetworks/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
</ul>
<p class="caption">
<span class="caption-text">
  Stochastic Processes
 </span>
</p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D1_BayesianDecisions/chapter_title.html">
   Bayesian Decisions (W3D1)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
<label for="toctree-checkbox-16">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/W3D1_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/student/W3D1_Tutorial1.html">
     Tutorial 1: Bayes with a binary hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/student/W3D1_Tutorial2.html">
     Tutorial 2: Bayesian inference and decisions with continuous hidden state
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/student/W3D1_Tutorial3.html">
     Bonus Tutorial:Fitting to data
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/W3D1_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D1_BayesianDecisions/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D2_HiddenDynamics/chapter_title.html">
   Hidden Dynamics (W3D2)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
<label for="toctree-checkbox-17">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/W3D2_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial1.html">
     Tutorial 1: Sequential Probability Ratio Test
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial2.html">
     Tutorial 2: Hidden Markov Model
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial3.html">
     Tutorial 3: 1D Kalman Filter
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/student/W3D2_Tutorial4.html">
     Tutorial 4: 2D Kalman Filter
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/W3D2_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D2_HiddenDynamics/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D3_OptimalControl/chapter_title.html">
   Optimal Control (W3D3)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
<label for="toctree-checkbox-18">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/W3D3_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/student/W3D3_Tutorial1.html">
     Tutorial 1: Optimal Control for Discrete States
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/student/W3D3_Tutorial2.html">
     Tutorial 2: Optimal Control for Continuous State
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/W3D3_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D3_OptimalControl/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/chapter_title.html">
   Reinforcement Learning (W3D4)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
<label for="toctree-checkbox-19">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/W3D4_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial1.html">
     Tutorial 1: Learning to Predict
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial2.html">
     Tutorial 2: Learning to Act: Multi-Armed Bandits
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial3.html">
     Tutorial 3: Learning to Act: Q-Learning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/student/W3D4_Tutorial4.html">
     Tutorial 4: From Reinforcement Learning to Planning
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/W3D4_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D4_ReinforcementLearning/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
<li class="toctree-l1 has-children">
<a class="reference internal" href="../../W3D5_NetworkCausality/chapter_title.html">
   Network Causality (W3D5)
  </a>
<input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
<label for="toctree-checkbox-20">
<i class="fas fa-chevron-down">
</i>
</label>
<ul>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/W3D5_Intro.html">
     Intro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial1.html">
     Tutorial 1: Interventions
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial2.html">
     Tutorial 2: Correlations
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial3.html">
     Tutorial 3: Simultaneous fitting/regression
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/student/W3D5_Tutorial4.html">
     Tutorial 4: Instrumental Variables
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/W3D5_Outro.html">
     Outro
    </a>
</li>
<li class="toctree-l2">
<a class="reference internal" href="../../W3D5_NetworkCausality/further_reading.html">
     Suggested further readings
    </a>
</li>
</ul>
</li>
</ul>
</div>
</nav> <!-- To handle the deprecated key -->
<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>
</div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
<div class="topbar container-xl fixed-top">
<div class="topbar-contents row">
<div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
<div class="col pl-md-4 topbar-main">
<button aria-controls="site-navigation" aria-expanded="true" aria-label="Toggle navigation" class="navbar-toggler ml-0" data-placement="left" data-target=".site-navigation" data-toggle="tooltip" id="navbar-toggler" title="Toggle navigation" type="button">
<i class="fas fa-bars"></i>
<i class="fas fa-arrow-left"></i>
<i class="fas fa-arrow-up"></i>
</button>
<div class="dropdown-buttons-trigger">
<button aria-label="Download this page" class="btn btn-secondary topbarbtn" id="dropdown-buttons-trigger"><i class="fas fa-download"></i></button>
<div class="dropdown-buttons">
<!-- ipynb file if we had a myst markdown file -->
<!-- Download raw file -->
<a class="dropdown-buttons" href="../../../_sources/tutorials/W2D3_BiologicalNeuronModels/student/W2D3_Tutorial2.ipynb"><button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" title="Download source file" type="button">.ipynb</button></a>
<!-- Download PDF via print -->
<button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" id="download-print" onclick="window.print()" title="Print to PDF" type="button">.pdf</button>
</div>
</div>
<!-- Source interaction buttons -->
<div class="dropdown-buttons-trigger">
<button aria-label="Connect with source repository" class="btn btn-secondary topbarbtn" id="dropdown-buttons-trigger"><i class="fab fa-github"></i></button>
<div class="dropdown-buttons sourcebuttons">
<a class="repository-button" href="https://github.com/NeuromatchAcademy/course-content"><button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" title="Source repository" type="button"><i class="fab fa-github"></i>repository</button></a>
<a class="issues-button" href="https://github.com/NeuromatchAcademy/course-content/issues/new?title=Issue%20on%20page%20%2Ftutorials/W2D3_BiologicalNeuronModels/student/W2D3_Tutorial2.html&amp;body=Your%20issue%20content%20here."><button class="btn btn-secondary topbarbtn" data-placement="left" data-toggle="tooltip" title="Open an issue" type="button"><i class="fas fa-lightbulb"></i>open issue</button></a>
</div>
</div>
<!-- Full screen (wrap in <a> to have style consistency -->
<a class="full-screen-button"><button aria-label="Fullscreen mode" class="btn btn-secondary topbarbtn" data-placement="bottom" data-toggle="tooltip" onclick="toggleFullScreen()" title="Fullscreen mode" type="button"><i class="fas fa-expand"></i></button></a>
<!-- Launch buttons -->
</div>
<!-- Table of contents -->
<div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
<i class="fas fa-list"></i> Contents
            </div>
<nav id="bd-toc-nav">
<ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#">
   Tutorial 2: Effects of Input Correlation
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#tutorial-objectives">
   Tutorial Objectives
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#setup">
   Setup
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#figure-settings">
     Figure Settings
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#helper-functions">
     Helper functions
    </a>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-1-correlations-synchrony">
   Section 1: Correlations (Synchrony)
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#origin-of-synchronous-neuronal-activity">
     Origin of synchronous neuronal activity:
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#implications-of-synchrony">
     Implications of synchrony
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-1-input-output-correlations">
     Video 1: Input &amp; output correlations
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#how-to-study-the-emergence-of-correlations">
     How to study the emergence of correlations
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id1">
</a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#exercise-1-compute-the-correlation">
       Exercise 1: Compute the correlation
      </a>
</li>
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#exercise-2-measure-the-correlation-between-spike-trains">
       Exercise 2: Measure the correlation between spike trains
      </a>
<ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry">
<a class="reference internal nav-link" href="#id2">
</a>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-2-investigate-the-effect-of-input-correlation-on-the-output-correlation">
   Section 2: Investigate the effect of input correlation on the output correlation
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#drive-a-neuron-with-correlated-inputs-and-visualize-its-output">
     Drive a neuron with correlated inputs and visualize its output
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#id3">
</a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#think">
     Think!
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id4">
</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-correlation-transfer-function">
   Section 3: Correlation transfer function
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-1-how-do-the-mean-and-standard-deviation-of-the-gwn-affect-the-correlation-transfer-function">
     Section 3.1: How do the mean and standard deviation of the GWN affect the correlation transfer function?
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id5">
       Think!
      </a>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#section-3-2-what-is-the-rationale-behind-varying-mu-and-sigma">
     Section 3.2: What is the rationale behind varying
     <span class="math notranslate nohighlight">
      \(\mu\)
     </span>
     and
     <span class="math notranslate nohighlight">
      \(\sigma\)
     </span>
     ?
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id6">
       Think!
      </a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#summary">
   Summary
  </a>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-1-example-of-a-conductance-based-lif-model">
   Bonus 1: Example of a conductance-based LIF model
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#function-to-simulate-conductance-based-lif">
     Function to simulate conductance-based LIF
    </a>
</li>
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#interactive-demo-correlated-spike-input-to-an-lif-neuron">
     Interactive Demo: Correlated spike input to an LIF neuron
    </a>
<ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry">
<a class="reference internal nav-link" href="#id7">
</a>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry">
<a class="reference internal nav-link" href="#bonus-2-ensemble-response">
   Bonus 2: Ensemble Response
  </a>
<ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry">
<a class="reference internal nav-link" href="#video-2-bonus-response-of-ensemble-of-neurons-to-time-varying-input">
     Video 2 (Bonus): Response of ensemble of neurons to time-varying input
    </a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="row" id="main-content">
<div class="col-12 col-md-9 pl-md-3 pr-md-0">
<div>
<p><a href="https://colab.research.google.com/github/NeuromatchAcademy/course-content/blob/master/tutorials/W2D3_RealNeurons/student/W2D3_Tutorial2.ipynb" target="_blank"><img alt="Open In Colab" src="https://colab.research.google.com/assets/colab-badge.svg"/></a></p>
<div class="section" id="tutorial-2-effects-of-input-correlation">
<h1>Tutorial 2: Effects of Input Correlation<a class="headerlink" href="#tutorial-2-effects-of-input-correlation" title="Permalink to this headline">¶</a></h1>
<p><strong>Week 2, Day 3: Biological Neuron Models</strong></p>
<p><strong>By Neuromatch Academy</strong></p>
<p><strong>Content creators:</strong> Qinglong Gu, Songtin Li, John Murray, Richard Naud, Arvind Kumar</p>
<p><strong>Content reviewers:</strong> Maryam Vaziri-Pashkam, Ella Batty, Lorenzo Fontolan, Richard Gao, Matthew Krause, Spiros Chavlis, Michael Waskom</p>
</div>
<hr class="docutils"/>
<div class="section" id="tutorial-objectives">
<h1>Tutorial Objectives<a class="headerlink" href="#tutorial-objectives" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial, we will use the leaky integrate-and-fire (LIF) neuron model (see Tutorial 1) to study how they transform input correlations to output properties (transfer of correlations). In particular, we are going to write a few lines of code to:</p>
<ul class="simple">
<li><p>inject correlated GWN in a pair of neurons</p></li>
<li><p>measure correlations between the spiking activity of the two neurons</p></li>
<li><p>study how the transfer of correlation depends on the statistics of the input, i.e. mean and standard deviation.</p></li>
</ul>
</div>
<hr class="docutils"/>
<div class="section" id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import libraries</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">time</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="figure-settings">
<h2>Figure Settings<a class="headerlink" href="#figure-settings" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Figure Settings</span>
<span class="kn">import</span> <span class="nn">ipywidgets</span> <span class="k">as</span> <span class="nn">widgets</span>       <span class="c1"># interactive display</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format = 'retina'
<span class="c1"># use NMA plot style</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s2">"https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/nma.mplstyle"</span><span class="p">)</span>
<span class="n">my_layout</span> <span class="o">=</span> <span class="n">widgets</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Helper functions</span>
<span class="k">def</span> <span class="nf">default_pars</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="p">{}</span>

  <span class="c1">### typical neuron parameters###</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_th'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">55.</span>     <span class="c1"># spike threshold [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_reset'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>  <span class="c1"># reset potential [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_m'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>     <span class="c1"># membrane time constant [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'g_L'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>       <span class="c1"># leak conductance [nS]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_init'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>   <span class="c1"># initial potential [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_L'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>      <span class="c1"># leak reversal potential [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tref'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.</span>       <span class="c1"># refractory time (ms)</span>

  <span class="c1">### simulation parameters ###</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">400.</span> <span class="c1"># Total duration of simulation [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">.1</span>  <span class="c1"># Simulation time step [ms]</span>

  <span class="c1">### external parameters if any ###</span>
  <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
    <span class="n">pars</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

  <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">])</span>  <span class="c1"># Vector of discretized</span>
                                                         <span class="c1"># time points [ms]</span>
  <span class="k">return</span> <span class="n">pars</span>


<span class="k">def</span> <span class="nf">run_LIF</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">Iinj</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Simulate the LIF dynamics with external input current</span>

<span class="sd">  Args:</span>
<span class="sd">    pars       : parameter dictionary</span>
<span class="sd">    Iinj       : input current [pA]. The injected current here can be a value or an array</span>

<span class="sd">  Returns:</span>
<span class="sd">    rec_spikes : spike times</span>
<span class="sd">    rec_v      : mebrane potential</span>
<span class="sd">  """</span>

  <span class="c1"># Set parameters</span>
  <span class="n">V_th</span><span class="p">,</span> <span class="n">V_reset</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_th'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_reset'</span><span class="p">]</span>
  <span class="n">tau_m</span><span class="p">,</span> <span class="n">g_L</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_m'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'g_L'</span><span class="p">]</span>
  <span class="n">V_init</span><span class="p">,</span> <span class="n">V_L</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_L'</span><span class="p">]</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>
  <span class="n">tref</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tref'</span><span class="p">]</span>

  <span class="c1"># Initialize voltage and current</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_init</span>
  <span class="n">Iinj</span> <span class="o">=</span> <span class="n">Iinj</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">tr</span> <span class="o">=</span> <span class="mf">0.</span>

  <span class="c1"># simulate the LIF dynamics</span>
  <span class="n">rec_spikes</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># record spike times</span>
  <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">tr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>
      <span class="n">tr</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">V_th</span><span class="p">:</span>  <span class="c1"># reset voltage and record spike event</span>
      <span class="n">rec_spikes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
      <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>
      <span class="n">tr</span> <span class="o">=</span> <span class="n">tref</span> <span class="o">/</span> <span class="n">dt</span>

    <span class="c1"># calculate the increment of the membrane potential</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">V_L</span><span class="p">)</span> <span class="o">+</span> <span class="n">Iinj</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">/</span> <span class="n">g_L</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau_m</span><span class="p">)</span>

    <span class="c1"># update the membrane potential</span>
    <span class="n">v</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="n">dv</span>

  <span class="n">rec_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rec_spikes</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

  <span class="k">return</span> <span class="n">v</span><span class="p">,</span> <span class="n">rec_spikes</span>


<span class="k">def</span> <span class="nf">my_GWN</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Function that calculates Gaussian white noise inputs</span>

<span class="sd">  Args:</span>
<span class="sd">    pars       : parameter dictionary</span>
<span class="sd">    mu         : noise baseline (mean)</span>
<span class="sd">    sig        : noise amplitute (standard deviation)</span>
<span class="sd">    myseed     : random seed. int or boolean</span>
<span class="sd">                 the same seed will give the same random number sequence</span>

<span class="sd">  Returns:</span>
<span class="sd">    I          : Gaussian white noise input</span>
<span class="sd">  """</span>

  <span class="c1"># Retrieve simulation parameters</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>

  <span class="c1"># Set random seed. You can fix the seed of the random number generator so</span>
  <span class="c1"># that the results are reliable however, when you want to generate multiple</span>
  <span class="c1"># realization make sure that you change the seed for each new realization</span>
  <span class="k">if</span> <span class="n">myseed</span><span class="p">:</span>
      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">myseed</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>

  <span class="c1"># generate GWN</span>
  <span class="c1"># we divide here by 1000 to convert units to sec.</span>
  <span class="n">I_GWN</span> <span class="o">=</span> <span class="n">sig</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'tau_m'</span><span class="p">]</span> <span class="o">/</span> <span class="n">dt</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">I_GWN</span>


<span class="k">def</span> <span class="nf">Poisson_generator</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Generates poisson trains</span>

<span class="sd">  Args:</span>
<span class="sd">    pars       : parameter dictionary</span>
<span class="sd">    rate       : noise amplitute [Hz]</span>
<span class="sd">    n          : number of Poisson trains</span>
<span class="sd">    myseed     : random seed. int or boolean</span>

<span class="sd">  Returns:</span>
<span class="sd">    pre_spike_train : spike train matrix, ith row represents whether</span>
<span class="sd">                      there is a spike in ith spike train over time</span>
<span class="sd">                      (1 if spike, 0 otherwise)</span>
<span class="sd">  """</span>

  <span class="c1"># Retrieve simulation parameters</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>

  <span class="c1"># set random seed</span>
  <span class="k">if</span> <span class="n">myseed</span><span class="p">:</span>
      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">myseed</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
      <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>

  <span class="c1"># generate uniformly distributed random variables</span>
  <span class="n">u_rand</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">Lt</span><span class="p">)</span>

  <span class="c1"># generate Poisson train</span>
  <span class="n">poisson_train</span> <span class="o">=</span> <span class="mf">1.</span> <span class="o">*</span> <span class="p">(</span><span class="n">u_rand</span> <span class="o">&lt;</span> <span class="n">rate</span> <span class="o">*</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="mf">1000.</span><span class="p">))</span>

  <span class="k">return</span> <span class="n">poisson_train</span>

<span class="k">def</span> <span class="nf">example_plot_myCC</span><span class="p">():</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">50000</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span>

  <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span>
  <span class="n">r12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">I1gL</span><span class="p">,</span> <span class="n">I2gL</span> <span class="o">=</span> <span class="n">correlate_input</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">20.0</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">7.5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">r12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_CC</span><span class="p">(</span><span class="n">I1gL</span><span class="p">,</span> <span class="n">I2gL</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r12</span><span class="p">,</span> <span class="s1">'bo'</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'Simulation'</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">],</span> <span class="s1">'k--'</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'y=x'</span><span class="p">,</span>
           <span class="n">dashes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'True CC'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Sample CC'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">LIF_output_cc</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">bin_size</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
  <span class="sd">""" Simulates two LIF neurons with correlated input and computes output correlation</span>

<span class="sd">  Args:</span>
<span class="sd">  pars       : parameter dictionary</span>
<span class="sd">  mu         : noise baseline (mean)</span>
<span class="sd">  sig        : noise amplitute (standard deviation)</span>
<span class="sd">  c          : correlation coefficient ~[0, 1]</span>
<span class="sd">  bin_size   : bin size used for time series</span>
<span class="sd">  n_trials   : total simulation trials</span>

<span class="sd">  Returns:</span>
<span class="sd">  r          : output corr. coe.</span>
<span class="sd">  sp_rate    : spike rate</span>
<span class="sd">  sp1        : spike times of neuron 1 in the last trial</span>
<span class="sd">  sp2        : spike times of neuron 2 in the last trial</span>
<span class="sd">  """</span>

  <span class="n">r12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>
  <span class="n">sp_rate</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>
  <span class="k">for</span> <span class="n">i_trial</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
    <span class="n">I1gL</span><span class="p">,</span> <span class="n">I2gL</span> <span class="o">=</span> <span class="n">correlate_input</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">sig</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">sp1</span> <span class="o">=</span> <span class="n">run_LIF</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'g_L'</span><span class="p">]</span> <span class="o">*</span> <span class="n">I1gL</span><span class="p">)</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">run_LIF</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'g_L'</span><span class="p">]</span> <span class="o">*</span> <span class="n">I2gL</span><span class="p">)</span>

    <span class="n">my_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">],</span> <span class="n">bin_size</span><span class="p">)</span>

    <span class="n">sp1_count</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">my_bin</span><span class="p">)</span>
    <span class="n">sp2_count</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">sp2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">my_bin</span><span class="p">)</span>

    <span class="n">r12</span><span class="p">[</span><span class="n">i_trial</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_CC</span><span class="p">(</span><span class="n">sp1_count</span><span class="p">[::</span><span class="mi">20</span><span class="p">],</span> <span class="n">sp2_count</span><span class="p">[::</span><span class="mi">20</span><span class="p">])</span>
    <span class="n">sp_rate</span><span class="p">[</span><span class="n">i_trial</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sp1</span><span class="p">)</span> <span class="o">/</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">]</span> <span class="o">*</span> <span class="mf">1000.</span>

  <span class="k">return</span> <span class="n">r12</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">sp_rate</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span>


<span class="k">def</span> <span class="nf">plot_c_r_LIF</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">mycolor</span><span class="p">,</span> <span class="n">mylabel</span><span class="p">):</span>
  <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
  <span class="n">c_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">c</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">c</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">])</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="s1">'o'</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">mycolor</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">mylabel</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">c_range</span><span class="p">,</span> <span class="n">z</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">c_range</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="n">mycolor</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The helper function contains the:</p>
<ul class="simple">
<li><p>Parameter dictionary: <code class="docutils literal notranslate"><span class="pre">default_pars(</span> <span class="pre">**kwargs)</span></code></p></li>
<li><p>LIF simulator: <code class="docutils literal notranslate"><span class="pre">run_LIF</span></code></p></li>
<li><p>Gaussian white noise generator: <code class="docutils literal notranslate"><span class="pre">my_GWN(pars,</span> <span class="pre">sig,</span> <span class="pre">myseed=False)</span></code></p></li>
<li><p>Poisson type spike train generator: <code class="docutils literal notranslate"><span class="pre">Poisson_generator(pars,</span> <span class="pre">rate,</span> <span class="pre">n,</span> <span class="pre">myseed=False)</span></code></p></li>
<li><p>Two LIF neurons with correlated inputs simulator: <code class="docutils literal notranslate"><span class="pre">LIF_output_cc(pars,</span> <span class="pre">mu,</span> <span class="pre">sig,</span> <span class="pre">c,</span> <span class="pre">bin_size,</span> <span class="pre">n_trials=20)</span></code></p></li>
<li><p>Some additional plotting utilities</p></li>
</ul>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-1-correlations-synchrony">
<h1>Section 1: Correlations (Synchrony)<a class="headerlink" href="#section-1-correlations-synchrony" title="Permalink to this headline">¶</a></h1>
<p>Correlation or synchrony in neuronal activity can be described for any readout of brain activity. Here, we are concerned with the spiking activity of neurons.</p>
<p>In the simplest way, correlation/synchrony refers to coincident spiking of neurons, i.e., when two neurons spike together, they are firing in <strong>synchrony</strong> or are <strong>correlated</strong>. Neurons can be synchronous in their instantaneous activity, i.e., they spike together with some probability. However, it is also possible that spiking of a neuron at time <span class="math notranslate nohighlight">\(t\)</span> is correlated with the spikes of another neuron with a delay (time-delayed synchrony).</p>
<div class="section" id="origin-of-synchronous-neuronal-activity">
<h2>Origin of synchronous neuronal activity:<a class="headerlink" href="#origin-of-synchronous-neuronal-activity" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Common inputs, i.e., two neurons are receiving input from the same sources. The degree of correlation of the shared inputs is proportional to their output correlation.</p></li>
<li><p>Pooling from the same sources. Neurons do not share the same input neurons but are receiving inputs from neurons which themselves are correlated.</p></li>
<li><p>Neurons are connected to each other (uni- or bi-directionally): This will only give rise to time-delayed synchrony. Neurons could also be connected via gap-junctions.</p></li>
<li><p>Neurons have similar parameters and initial conditions.</p></li>
</ul>
</div>
<div class="section" id="implications-of-synchrony">
<h2>Implications of synchrony<a class="headerlink" href="#implications-of-synchrony" title="Permalink to this headline">¶</a></h2>
<p>When neurons spike together, they can have a stronger impact on downstream neurons. Synapses in the brain are sensitive to the temporal correlations (i.e., delay) between pre- and postsynaptic activity, and this, in turn, can lead to the formation of functional neuronal networks - the basis of unsupervised learning (we will study some of these concepts in a forthcoming tutorial).</p>
<p>Synchrony implies a reduction in the dimensionality of the system. In addition, correlations, in many cases, can impair the decoding of neuronal activity.</p>
</div>
<div class="section" id="video-1-input-output-correlations">
<h2>Video 1: Input &amp; output correlations<a class="headerlink" href="#video-1-input-output-correlations" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Video available at https://youtube.com/watch?v=nsAYFBcAkes
</pre></div>
</div>
<div class="output text_html">
<iframe allowfullscreen="" frameborder="0" height="410" src="https://www.youtube.com/embed/nsAYFBcAkes?fs=1" width="730"></iframe>
</div></div>
</div>
</div>
<div class="section" id="how-to-study-the-emergence-of-correlations">
<h2>How to study the emergence of correlations<a class="headerlink" href="#how-to-study-the-emergence-of-correlations" title="Permalink to this headline">¶</a></h2>
<p>A simple model to study the emergence of correlations is to inject common inputs to a pair of neurons and measure the output correlation as a function of the fraction of common inputs.</p>
<p>Here, we are going to investigate the transfer of correlations by computing the correlation coefficient of spike trains recorded from two unconnected LIF neurons, which received correlated inputs.</p>
<p>The input current to LIF neuron <span class="math notranslate nohighlight">\(i\)</span> <span class="math notranslate nohighlight">\((i=1,2)\)</span> is:</p>
<div class="amsmath math notranslate nohighlight" id="equation-fd696d57-3b3f-44ac-9e94-cf73361480b6">
<span class="eqno">(122)<a class="headerlink" href="#equation-fd696d57-3b3f-44ac-9e94-cf73361480b6" title="Permalink to this equation">¶</a></span>\[\begin{equation}
\frac{I_i}{g_L} =\mu_i + \sigma_i (\sqrt{1-c}\xi_i + \sqrt{c}\xi_c) \quad (1)
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mu_i\)</span> is the temporal average of the current. The Gaussian white noise <span class="math notranslate nohighlight">\(\xi_i\)</span> is independent for each neuron, while <span class="math notranslate nohighlight">\(\xi_c\)</span> is common to all neurons. The variable <span class="math notranslate nohighlight">\(c\)</span> (<span class="math notranslate nohighlight">\(0\le c\le1\)</span>) controls the fraction of common and independent inputs. <span class="math notranslate nohighlight">\(\sigma_i\)</span> shows the variance of the total input.</p>
<p>So, first, we will generate correlated inputs.</p>
<div class="section" id="id1">
<h3><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>
<span class="c1">#@markdown Execute this cell to get a function for generating correlated GWN inputs</span>
<span class="k">def</span> <span class="nf">correlate_input</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">7.5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mf">0.3</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    pars       : parameter dictionary</span>
<span class="sd">    mu         : noise baseline (mean)</span>
<span class="sd">    sig        : noise amplitute (standard deviation)</span>
<span class="sd">    c.         : correlation coefficient ~[0, 1]</span>

<span class="sd">  Returns:</span>
<span class="sd">    I1gL, I2gL : two correlated inputs with corr. coe. c</span>
<span class="sd">  """</span>

  <span class="c1"># generate Gaussian whute noise xi_1, xi_2, xi_c</span>
  <span class="n">xi_1</span> <span class="o">=</span> <span class="n">my_GWN</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
  <span class="n">xi_2</span> <span class="o">=</span> <span class="n">my_GWN</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>
  <span class="n">xi_c</span> <span class="o">=</span> <span class="n">my_GWN</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">sig</span><span class="p">)</span>

  <span class="c1"># Generate two correlated inputs by Equation. (1)</span>
  <span class="n">I1gL</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">xi_1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">xi_c</span>
  <span class="n">I2gL</span> <span class="o">=</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">xi_2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="o">*</span> <span class="n">xi_c</span>

  <span class="k">return</span> <span class="n">I1gL</span><span class="p">,</span> <span class="n">I2gL</span>

<span class="nb">print</span><span class="p">(</span><span class="n">help</span><span class="p">(</span><span class="n">correlate_input</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function correlate_input in module __main__:

correlate_input(pars, mu=20.0, sig=7.5, c=0.3)
    Args:
      pars       : parameter dictionary
      mu         : noise baseline (mean)
      sig        : noise amplitute (standard deviation)
      c.         : correlation coefficient ~[0, 1]
    
    Returns:
      I1gL, I2gL : two correlated inputs with corr. coe. c

None
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="exercise-1-compute-the-correlation">
<h3>Exercise 1: Compute the correlation<a class="headerlink" href="#exercise-1-compute-the-correlation" title="Permalink to this headline">¶</a></h3>
<p>The <em>sample correlation coefficient</em> between two input currents <span class="math notranslate nohighlight">\(I_i\)</span> and <span class="math notranslate nohighlight">\(I_j\)</span> is defined as the sample covariance of <span class="math notranslate nohighlight">\(I_i\)</span> and <span class="math notranslate nohighlight">\(I_j\)</span> divided by the square root of the sample variance of <span class="math notranslate nohighlight">\(I_i\)</span> multiplied with the square root of the sample variance of <span class="math notranslate nohighlight">\(I_j\)</span>. In equation form:</p>
<div class="amsmath math notranslate nohighlight" id="equation-6efe0015-55af-49d4-bae0-1700a6cb1b78">
<span class="eqno">(123)<a class="headerlink" href="#equation-6efe0015-55af-49d4-bae0-1700a6cb1b78" title="Permalink to this equation">¶</a></span>\[\begin{align}
r_{ij} &amp;= \frac{cov(I_i, I_j)}{\sqrt{var(I_i)} \sqrt{var(I_j)}}\\
cov(I_i, I_j) &amp;= \sum_{k=1}^L (I_i^k -\bar{I}_i)(I_j^k -\bar{I}_j) \\
var(I_i) &amp;= \sum_{k=1}^L (I_i^k -\bar{I}_i)^2
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\bar{I}_i\)</span> is the sample mean, k is the time bin, and L is the length of <span class="math notranslate nohighlight">\(I\)</span>.  This means that <span class="math notranslate nohighlight">\(I_i^k\)</span> is current i at time <span class="math notranslate nohighlight">\(k\cdot dt\)</span>. Note that the equations above are not accurate for sample covariances and variances as they should be additionally divided by L-1 - we have dropped this term because it cancels out in the sample correlation coefficient formula.</p>
<p>The <em>sample correlation coefficient</em> may also be referred to as the <em>sample Pearson correlation coefficient</em>. Here, is a beautiful paper that explains multiple ways to calculate and understand correlations <a class="reference external" href="https://www.stat.berkeley.edu/~rabbee/correlation.pdf">Rodgers and Nicewander 1988</a>.</p>
<p>In this exercise, we will create a function, <code class="docutils literal notranslate"><span class="pre">my_CC</span></code> to compute the sample correlation coefficient between two time series. Note that while we introduced this computation here in the context of input currents, the sample correlation coefficient is used to compute the correlation between any two time series - we will use it later on binned spike trains.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_CC</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Args:</span>
<span class="sd">    i, j  : two time series with the same length</span>

<span class="sd">  Returns:</span>
<span class="sd">    rij   : correlation coefficient</span>
<span class="sd">  """</span>
  <span class="c1">########################################################################</span>
  <span class="c1">## TODO for students: compute rxy, then remove the NotImplementedError #</span>
  <span class="c1"># Tip1: array([a1, a2, a3])*array([b1, b2, b3]) = array([a1*b1, a2*b2, a3*b3])</span>
  <span class="c1"># Tip2: np.sum(array([a1, a2, a3])) = a1+a2+a3</span>
  <span class="c1"># Tip3: square root, np.sqrt()</span>
  <span class="c1"># Fill out function and remove</span>
  <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: compute the sample correlation coefficient"</span><span class="p">)</span>
  <span class="c1">########################################################################</span>
  <span class="c1"># Calculate the covariance of i and j</span>
  <span class="n">cov</span> <span class="o">=</span> <span class="o">...</span>
  <span class="c1"># Calculate the variance of i</span>
  <span class="n">var_i</span> <span class="o">=</span> <span class="o">...</span>
  <span class="c1"># Calculate the variance of j</span>
  <span class="n">var_j</span> <span class="o">=</span> <span class="o">...</span>
  <span class="c1"># Calculate the correlation coefficient</span>
  <span class="n">rij</span> <span class="o">=</span> <span class="o">...</span>

  <span class="k">return</span> <span class="n">rij</span>


<span class="c1"># Uncomment the line after completing the my_CC function</span>
<span class="c1"># example_plot_myCC()</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D3_BiologicalNeuronModels/solutions/W2D3_Tutorial2_Solution_03e44bdc.py"><em>Click for solution</em></a></p>
<p><em>Example output:</em></p>
<img align="left" alt="Solution hint" height="413" src="https://raw.githubusercontent.com/NeuromatchAcademy/course-content/master/tutorials/W2D3_BiologicalNeuronModels/static/W2D3_Tutorial2_Solution_03e44bdc_0.png" width="558"/>
</div>
<div class="section" id="exercise-2-measure-the-correlation-between-spike-trains">
<h3>Exercise 2: Measure the correlation between spike trains<a class="headerlink" href="#exercise-2-measure-the-correlation-between-spike-trains" title="Permalink to this headline">¶</a></h3>
<p>After recording the spike times of the two neurons, how can we estimate their correlation coefficient?</p>
<p>In order to find this, we need to bin the spike times and obtain two time series. Each data point in the time series is the number of spikes in the corresponding time bin. You can use <code class="docutils literal notranslate"><span class="pre">np.histogram()</span></code> to bin the spike times.</p>
<p>Complete the code below to bin the spike times and calculate the correlation coefficient for two Poisson spike trains. Note that <code class="docutils literal notranslate"><span class="pre">c</span></code> here is the ground-truth correlation coefficient that we define.</p>
<div class="section" id="id2">
<h4><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Execute this cell to get a function for generating correlated Poisson inputs (generate_corr_Poisson)</span>


<span class="k">def</span> <span class="nf">generate_corr_Poisson</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">poi_rate</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  function to generate correlated Poisson type spike trains</span>
<span class="sd">  Args:</span>
<span class="sd">    pars       : parameter dictionary</span>
<span class="sd">    poi_rate   : rate of the Poisson train</span>
<span class="sd">    c.         : correlation coefficient ~[0, 1]</span>

<span class="sd">  Returns:</span>
<span class="sd">    sp1, sp2   : two correlated spike time trains with corr. coe. c</span>
<span class="sd">  """</span>

  <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>

  <span class="n">mother_rate</span> <span class="o">=</span> <span class="n">poi_rate</span> <span class="o">/</span> <span class="n">c</span>
  <span class="n">mother_spike_train</span> <span class="o">=</span> <span class="n">Poisson_generator</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="o">=</span><span class="n">mother_rate</span><span class="p">,</span>
                                         <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="n">myseed</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
  <span class="n">sp_mother</span> <span class="o">=</span> <span class="n">range_t</span><span class="p">[</span><span class="n">mother_spike_train</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>

  <span class="n">L_sp_mother</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">sp_mother</span><span class="p">)</span>
  <span class="n">sp_mother_id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">L_sp_mother</span><span class="p">)</span>
  <span class="n">L_sp_corr</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">L_sp_mother</span> <span class="o">*</span> <span class="n">c</span><span class="p">)</span>

  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sp_mother_id</span><span class="p">)</span>
  <span class="n">sp1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">sp_mother</span><span class="p">[</span><span class="n">sp_mother_id</span><span class="p">[:</span><span class="n">L_sp_corr</span><span class="p">]])</span>

  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sp_mother_id</span><span class="p">)</span>
  <span class="n">sp2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">sp_mother</span><span class="p">[</span><span class="n">sp_mother_id</span><span class="p">[:</span><span class="n">L_sp_corr</span><span class="p">]])</span>

  <span class="k">return</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span>


<span class="nb">print</span><span class="p">(</span><span class="n">help</span><span class="p">(</span><span class="n">generate_corr_Poisson</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function generate_corr_Poisson in module __main__:

generate_corr_Poisson(pars, poi_rate, c, myseed=False)
    function to generate correlated Poisson type spike trains
    Args:
      pars       : parameter dictionary
      poi_rate   : rate of the Poisson train
      c.         : correlation coefficient ~[0, 1]
    
    Returns:
      sp1, sp2   : two correlated spike time trains with corr. coe. c

None
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">corr_coeff_pairs</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">rate</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">trials</span><span class="p">,</span> <span class="n">bins</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  Calculate the correlation coefficient of two spike trains, for different</span>
<span class="sd">  realizations</span>

<span class="sd">  Args:</span>
<span class="sd">      pars   : parameter dictionary</span>
<span class="sd">      rate   : rate of poisson inputs</span>
<span class="sd">      c      : correlation coefficient ~ [0, 1]</span>
<span class="sd">      trials  : number of realizations</span>
<span class="sd">      bins   : vector with bins for time discretization</span>

<span class="sd">  Returns:</span>
<span class="sd">    r12      : correlation coefficient of a pair of inputs</span>
<span class="sd">  """</span>

  <span class="n">r12</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
    <span class="c1">##############################################################</span>
    <span class="c1">## TODO for students: Use np.histogram to bin the spike time #</span>
    <span class="c1">##   e.g., sp1_count, _= np.histogram(...)</span>
    <span class="c1"># Use my_CC() compute corr coe, compare with c</span>
    <span class="c1"># Note that you can run multiple realizations and compute their r_12(diff_trials)</span>
    <span class="c1"># with the defined function above. The average r_12 over trials can get close to c.</span>
    <span class="c1"># Note: change seed to generate different input per trial</span>
    <span class="c1"># Fill out function and remove</span>
    <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"Student exercise: compute the correlation coefficient"</span><span class="p">)</span>
    <span class="c1">##############################################################</span>

    <span class="c1"># Generate correlated Poisson inputs</span>
    <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">generate_corr_Poisson</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">,</span> <span class="n">myseed</span><span class="o">=</span><span class="mi">2020</span><span class="o">+</span><span class="n">i</span><span class="p">)</span>

    <span class="c1"># Bin the spike times of the first input</span>
    <span class="n">sp1_count</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">bins</span><span class="o">=...</span><span class="p">)</span>

    <span class="c1"># Bin the spike times of the second input</span>
    <span class="n">sp2_count</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">bins</span><span class="o">=...</span><span class="p">)</span>

    <span class="c1"># Calculate the correlation coefficient</span>
    <span class="n">r12</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">my_CC</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">r12</span>


<span class="n">poi_rate</span> <span class="o">=</span> <span class="mf">20.</span>
<span class="n">c</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># set true correlation</span>
<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>

<span class="c1"># bin the spike time</span>
<span class="n">bin_size</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># [ms]</span>
<span class="n">my_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">],</span> <span class="n">bin_size</span><span class="p">)</span>
<span class="n">n_trials</span> <span class="o">=</span> <span class="mi">100</span>  <span class="c1"># 100 realizations</span>

<span class="c1"># Uncomment to test your function</span>
<span class="c1"># r12 = corr_coeff_pairs(pars, rate=poi_rate, c=c, trials=n_trials, bins=my_bin)</span>
<span class="c1"># print(f'True corr coe = {c:.3f}')</span>
<span class="c1"># print(f'Simu corr coe = {r12.mean():.3f}')</span>
</pre></div>
</div>
</div>
</div>
<p>Sample output</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kc">True</span> <span class="n">corr</span> <span class="n">coe</span> <span class="o">=</span> <span class="mf">0.200</span>
<span class="n">Simu</span> <span class="n">corr</span> <span class="n">coe</span> <span class="o">=</span> <span class="mf">0.197</span>
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D3_BiologicalNeuronModels/solutions/W2D3_Tutorial2_Solution_e5eaac3e.py"><em>Click for solution</em></a></p>
</div>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-2-investigate-the-effect-of-input-correlation-on-the-output-correlation">
<h1>Section 2: Investigate the effect of input correlation on the output correlation<a class="headerlink" href="#section-2-investigate-the-effect-of-input-correlation-on-the-output-correlation" title="Permalink to this headline">¶</a></h1>
<p>Now let’s combine the aforementioned two procedures. We first generate the correlated inputs by Equation (1). Then we inject the correlated inputs <span class="math notranslate nohighlight">\(I_1, I_2\)</span> into a pair of neurons and record their output spike times. We continue measuring the correlation between the output and
investigate the relationship between the input correlation and the output correlation.</p>
<div class="section" id="drive-a-neuron-with-correlated-inputs-and-visualize-its-output">
<h2>Drive a neuron with correlated inputs and visualize its output<a class="headerlink" href="#drive-a-neuron-with-correlated-inputs-and-visualize-its-output" title="Permalink to this headline">¶</a></h2>
<p>In the following, you will inject correlated GWN in two neurons. You need to define the mean (<code class="docutils literal notranslate"><span class="pre">gwn_mean</span></code>), standard deviation (<code class="docutils literal notranslate"><span class="pre">gwn_std</span></code>), and input correlations (<code class="docutils literal notranslate"><span class="pre">c_in</span></code>).</p>
<p>We will simulate <span class="math notranslate nohighlight">\(10\)</span> trials to get a better estimate of the output correlation. Change the values in the following cell for the above variables (and then run the next cell) to explore how they impact the output correlation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Play around with these parameters</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">80000</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>  <span class="c1"># get the parameters</span>
<span class="n">c_in</span> <span class="o">=</span> <span class="mf">0.3</span>  <span class="c1"># set input correlation value</span>
<span class="n">gwn_mean</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">gwn_std</span> <span class="o">=</span> <span class="mf">10.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id3">
<h2><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Do not forget to execute this cell to simulate the LIF</span>


<span class="n">bin_size</span> <span class="o">=</span> <span class="mf">10.</span>  <span class="c1"># ms</span>

<span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>  <span class="c1"># time clock</span>

<span class="n">r12_ss</span><span class="p">,</span> <span class="n">sp_ss</span><span class="p">,</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">LIF_output_cc</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">gwn_mean</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="n">gwn_std</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">c_in</span><span class="p">,</span>
                                        <span class="n">bin_size</span><span class="o">=</span><span class="n">bin_size</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="c1"># just the time counter</span>
<span class="n">endtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="n">timecost</span> <span class="o">=</span> <span class="p">(</span><span class="n">endtime</span> <span class="o">-</span> <span class="n">starttime</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Simulation time = </span><span class="si">{</span><span class="n">timecost</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> min"</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Input correlation = </span><span class="si">{</span><span class="n">c_in</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Output correlation = </span><span class="si">{</span><span class="n">r12_ss</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sp1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sp1</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'|'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'neuron 1'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sp2</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sp2</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="s1">'|'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'neuron 2'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'time (ms)'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'neuron id.'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">8000</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>

</div>
</div>
<div class="section" id="think">
<h2>Think!<a class="headerlink" href="#think" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Is the output correlation always smaller than the input correlation? If yes, why?</p></li>
<li><p>Should there be a systematic relationship between input and output correlations?</p></li>
</ul>
<p>You will explore these questions in the next figure but try to develop your own intuitions first!</p>
<p>Lets vary <code class="docutils literal notranslate"><span class="pre">c_in</span></code> and plot the relationship between the <code class="docutils literal notranslate"><span class="pre">c_in</span></code> and output correlation. This might take some time depending on the number of trials.</p>
<div class="section" id="id4">
<h3><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@title</span>

<span class="c1">#@markdown Don't forget to execute this cell!</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">80000</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span>  <span class="c1"># get the parameters</span>
<span class="n">bin_size</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">c_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>  <span class="c1"># set the range for input CC</span>
<span class="n">r12_ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_in</span><span class="p">))</span>  <span class="c1"># small mu, small sigma</span>

<span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span> <span class="c1"># time clock</span>
<span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_in</span><span class="p">)):</span>
  <span class="n">r12_ss</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">sp_ss</span><span class="p">,</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">LIF_output_cc</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span>
                                              <span class="n">c</span><span class="o">=</span><span class="n">c_in</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">bin_size</span><span class="o">=</span><span class="n">bin_size</span><span class="p">,</span>
                                              <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">endtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="n">timecost</span> <span class="o">=</span> <span class="p">(</span><span class="n">endtime</span> <span class="o">-</span> <span class="n">starttime</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Simulation time = </span><span class="si">{</span><span class="n">timecost</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> min"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plot_c_r_LIF</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">r12_ss</span><span class="p">,</span> <span class="n">mycolor</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">mylabel</span><span class="o">=</span><span class="s1">'Output CC'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">c_in</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">c_in</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">],</span>
         <span class="p">[</span><span class="n">c_in</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">c_in</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">],</span>
         <span class="s1">'k--'</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">'y=x'</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Input CC'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Output CC'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>

</div>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D3_BiologicalNeuronModels/solutions/W2D3_Tutorial2_Solution_71e76f4d.py"><em>Click for solution</em></a></p>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="section-3-correlation-transfer-function">
<h1>Section 3: Correlation transfer function<a class="headerlink" href="#section-3-correlation-transfer-function" title="Permalink to this headline">¶</a></h1>
<p>The above plot of input correlation vs. output correlation is called the <strong>correlation transfer function</strong> of the neurons.</p>
<div class="section" id="section-3-1-how-do-the-mean-and-standard-deviation-of-the-gwn-affect-the-correlation-transfer-function">
<h2>Section 3.1: How do the mean and standard deviation of the GWN affect the correlation transfer function?<a class="headerlink" href="#section-3-1-how-do-the-mean-and-standard-deviation-of-the-gwn-affect-the-correlation-transfer-function" title="Permalink to this headline">¶</a></h2>
<p>The correlations transfer function appears to be linear. The above can be taken as the input/output transfer function of LIF neurons for correlations, instead of the transfer function for input/output firing rates as we had discussed in the previous tutorial (i.e., F-I curve).</p>
<p>What would you expect to happen to the slope of the correlation transfer function if you vary the mean and/or the standard deviation of the GWN?</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#@markdown Execute this cell to visualize correlation transfer functions</span>

<span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mi">80000</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.</span><span class="p">)</span> <span class="c1"># get the parameters</span>
<span class="n">no_trial</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">bin_size</span> <span class="o">=</span> <span class="mf">10.</span>
<span class="n">c_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>  <span class="c1"># set the range for input CC</span>
<span class="n">r12_ss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_in</span><span class="p">))</span>   <span class="c1"># small mu, small sigma</span>
<span class="n">r12_ls</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_in</span><span class="p">))</span>   <span class="c1"># large mu, small sigma</span>
<span class="n">r12_sl</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_in</span><span class="p">))</span>   <span class="c1"># small mu, large sigma</span>

<span class="n">starttime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>  <span class="c1"># time clock</span>
<span class="k">for</span> <span class="n">ic</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">c_in</span><span class="p">)):</span>
  <span class="n">r12_ss</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">sp_ss</span><span class="p">,</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">LIF_output_cc</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span>
                                              <span class="n">c</span><span class="o">=</span><span class="n">c_in</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">bin_size</span><span class="o">=</span><span class="n">bin_size</span><span class="p">,</span>
                                              <span class="n">n_trials</span><span class="o">=</span><span class="n">no_trial</span><span class="p">)</span>
  <span class="n">r12_ls</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">sp_ls</span><span class="p">,</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">LIF_output_cc</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">18.0</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">10.</span><span class="p">,</span>
                                              <span class="n">c</span><span class="o">=</span><span class="n">c_in</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">bin_size</span><span class="o">=</span><span class="n">bin_size</span><span class="p">,</span>
                                              <span class="n">n_trials</span><span class="o">=</span><span class="n">no_trial</span><span class="p">)</span>
  <span class="n">r12_sl</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">sp_sl</span><span class="p">,</span> <span class="n">sp1</span><span class="p">,</span> <span class="n">sp2</span> <span class="o">=</span> <span class="n">LIF_output_cc</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="mf">10.0</span><span class="p">,</span> <span class="n">sig</span><span class="o">=</span><span class="mf">20.</span><span class="p">,</span>
                                              <span class="n">c</span><span class="o">=</span><span class="n">c_in</span><span class="p">[</span><span class="n">ic</span><span class="p">],</span> <span class="n">bin_size</span><span class="o">=</span><span class="n">bin_size</span><span class="p">,</span>
                                              <span class="n">n_trials</span><span class="o">=</span><span class="n">no_trial</span><span class="p">)</span>
<span class="n">endtime</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="n">timecost</span> <span class="o">=</span> <span class="p">(</span><span class="n">endtime</span> <span class="o">-</span> <span class="n">starttime</span><span class="p">)</span> <span class="o">/</span> <span class="mf">60.</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Simulation time = </span><span class="si">{</span><span class="n">timecost</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> min"</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plot_c_r_LIF</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">r12_ss</span><span class="p">,</span> <span class="n">mycolor</span><span class="o">=</span><span class="s1">'b'</span><span class="p">,</span> <span class="n">mylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">'Small $\mu$, small $\sigma$'</span><span class="p">)</span>
<span class="n">plot_c_r_LIF</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">r12_ls</span><span class="p">,</span> <span class="n">mycolor</span><span class="o">=</span><span class="s1">'y'</span><span class="p">,</span> <span class="n">mylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">'Large $\mu$, small $\sigma$'</span><span class="p">)</span>
<span class="n">plot_c_r_LIF</span><span class="p">(</span><span class="n">c_in</span><span class="p">,</span> <span class="n">r12_sl</span><span class="p">,</span> <span class="n">mycolor</span><span class="o">=</span><span class="s1">'r'</span><span class="p">,</span> <span class="n">mylabel</span><span class="o">=</span><span class="sa">r</span><span class="s1">'Small $\mu$, large $\sigma$'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">c_in</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">c_in</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">],</span>
         <span class="p">[</span><span class="n">c_in</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">c_in</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">],</span>
         <span class="s1">'k--'</span><span class="p">,</span> <span class="n">dashes</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">'y=x'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'Input CC'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'Output CC'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">'best'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>

</div>
<div class="section" id="id5">
<h3>Think!<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>Why do both the mean and the standard deviation of the GWN affect the slope of the correlation transfer function?</p>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D3_BiologicalNeuronModels/solutions/W2D3_Tutorial2_Solution_2deb4ccb.py"><em>Click for solution</em></a></p>
</div>
</div>
<div class="section" id="section-3-2-what-is-the-rationale-behind-varying-mu-and-sigma">
<h2>Section 3.2: What is the rationale behind varying <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span>?<a class="headerlink" href="#section-3-2-what-is-the-rationale-behind-varying-mu-and-sigma" title="Permalink to this headline">¶</a></h2>
<p>The mean and the variance of the synaptic current depends on the spike rate of a Poisson process. We can use <a class="reference external" href="https://en.wikipedia.org/wiki/Campbell%27s_theorem_(probability)">Campbell’s theorem</a> to estimate the mean and the variance of the synaptic current:</p>
<div class="amsmath math notranslate nohighlight" id="equation-870e5c95-035c-4e69-a303-2a01459144de">
<span class="eqno">(124)<a class="headerlink" href="#equation-870e5c95-035c-4e69-a303-2a01459144de" title="Permalink to this equation">¶</a></span>\[\begin{align}
\mu_{\rm syn} = \lambda J \int P(t) \\
\sigma_{\rm syn} = \lambda J \int P(t)^2 dt\\
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda\)</span> is the firing rate of the Poisson input, <span class="math notranslate nohighlight">\(J\)</span> the amplitude of the postsynaptic current and <span class="math notranslate nohighlight">\(P(t)\)</span> is the shape of the postsynaptic current as a function of time.</p>
<p>Therefore, when we varied <span class="math notranslate nohighlight">\(\mu\)</span> and/or <span class="math notranslate nohighlight">\(\sigma\)</span> of the GWN, we mimicked a change in the input firing rate. Note that, if we change the firing rate, both <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> will change simultaneously, not independently.</p>
<p>Here, since we observe an effect of <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> on correlation transfer, this implies that the input rate has an impact on the correlation transfer function.</p>
<div class="section" id="id6">
<h3>Think!<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>What are the factors that would make output correlations smaller than input correlations? (Notice that the colored lines are below the black dashed line)</p></li>
<li><p>What does it mean for the correlation in the network?</p></li>
<li><p>Here we have studied the transfer of correlations by injecting GWN. But in the previous tutorial, we mentioned that GWN is unphysiological. Indeed, neurons receive colored noise (i.e., Shot noise or OU process). How do these results obtained from injection of GWN apply to the case where correlated spiking inputs are injected in the two LIFs? Will the results be the same or different?</p></li>
</ul>
<p>Reference</p>
<ul class="simple">
<li><p>De La Rocha, Jaime, et al. “Correlation between neural spike trains increases with firing rate.” Nature (2007) (https://www.nature.com/articles/nature06028/)</p></li>
<li><p>Bujan AF, Aertsen A, Kumar A. Role of input correlations in shaping the variability and noise correlations of evoked activity in the neocortex. Journal of Neuroscience. 2015 Jun 3;35(22):8611-25. (https://www.jneurosci.org/content/35/22/8611)</p></li>
</ul>
<p><a class="reference external" href="https://github.com/NeuromatchAcademy/course-content/tree/master//tutorials/W2D3_BiologicalNeuronModels/solutions/W2D3_Tutorial2_Solution_39d29f52.py"><em>Click for solution</em></a></p>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="summary">
<h1>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial, we studied how the input correlation of two LIF neurons is mapped to their output correlation. Specifically, we:</p>
<ul class="simple">
<li><p>injected correlated GWN in a pair of neurons,</p></li>
<li><p>measured correlations between the spiking activity of the two neurons, and</p></li>
<li><p>studied how the transfer of correlation depends on the statistics of the input, i.e., mean and standard deviation.</p></li>
</ul>
<p>Here, we were concerned with zero time lag correlation. For this reason, we restricted estimation of correlation to instantaneous correlations. If you are interested in time-lagged correlation, then we should estimate the cross-correlogram of the spike trains and find out the dominant peak and area under the peak to get an estimate of output correlations.</p>
<p>We leave this as a future to-do for you if you are interested.</p>
</div>
<hr class="docutils"/>
<div class="section" id="bonus-1-example-of-a-conductance-based-lif-model">
<h1>Bonus 1: Example of a conductance-based LIF model<a class="headerlink" href="#bonus-1-example-of-a-conductance-based-lif-model" title="Permalink to this headline">¶</a></h1>
<p>Above, we have written code to generate correlated Poisson spike trains. You can write code to stimulate the LIF neuron with such correlated spike trains and study the correlation transfer function for spiking input and compare it to the correlation transfer function obtained by injecting correlated GWNs.</p>
<div class="section" id="function-to-simulate-conductance-based-lif">
<h2>Function to simulate conductance-based LIF<a class="headerlink" href="#function-to-simulate-conductance-based-lif" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title Function to simulate conductance-based LIF</span>

<span class="k">def</span> <span class="nf">run_LIF_cond</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">I_inj</span><span class="p">,</span> <span class="n">pre_spike_train_ex</span><span class="p">,</span> <span class="n">pre_spike_train_in</span><span class="p">):</span>
  <span class="sd">"""</span>
<span class="sd">  conductance-based LIF dynamics</span>

<span class="sd">  Args:</span>
<span class="sd">    pars               : parameter dictionary</span>
<span class="sd">    I_inj              : injected current [pA]. The injected current here can</span>
<span class="sd">                         be a value or an array</span>
<span class="sd">    pre_spike_train_ex : spike train input from presynaptic excitatory neuron</span>
<span class="sd">    pre_spike_train_in : spike train input from presynaptic inhibitory neuron</span>

<span class="sd">  Returns:</span>
<span class="sd">    rec_spikes         : spike times</span>
<span class="sd">    rec_v              : mebrane potential</span>
<span class="sd">    gE                 : postsynaptic excitatory conductance</span>
<span class="sd">    gI                 : postsynaptic inhibitory conductance</span>
<span class="sd">  """</span>

  <span class="c1"># Retrieve parameters</span>
  <span class="n">V_th</span><span class="p">,</span> <span class="n">V_reset</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_th'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_reset'</span><span class="p">]</span>
  <span class="n">tau_m</span><span class="p">,</span> <span class="n">g_L</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_m'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'g_L'</span><span class="p">]</span>
  <span class="n">V_init</span><span class="p">,</span> <span class="n">E_L</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'V_init'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'E_L'</span><span class="p">]</span>
  <span class="n">gE_bar</span><span class="p">,</span> <span class="n">gI_bar</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'gE_bar'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'gI_bar'</span><span class="p">]</span>
  <span class="n">VE</span><span class="p">,</span> <span class="n">VI</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'VE'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'VI'</span><span class="p">]</span>
  <span class="n">tau_syn_E</span><span class="p">,</span> <span class="n">tau_syn_I</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_syn_E'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_syn_I'</span><span class="p">]</span>
  <span class="n">tref</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'tref'</span><span class="p">]</span>
  <span class="n">dt</span><span class="p">,</span> <span class="n">range_t</span> <span class="o">=</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">]</span>
  <span class="n">Lt</span> <span class="o">=</span> <span class="n">range_t</span><span class="o">.</span><span class="n">size</span>

  <span class="c1"># Initialize</span>
  <span class="n">tr</span> <span class="o">=</span> <span class="mf">0.</span>
  <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_init</span>
  <span class="n">gE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">gI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="n">Iinj</span> <span class="o">=</span> <span class="n">I_inj</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>  <span class="c1"># ensure I has length Lt</span>

  <span class="k">if</span> <span class="n">pre_spike_train_ex</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">pre_spike_train_ex_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">pre_spike_train_ex_total</span> <span class="o">=</span> <span class="n">pre_spike_train_ex</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>

  <span class="k">if</span> <span class="n">pre_spike_train_in</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">pre_spike_train_in_total</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">pre_spike_train_in_total</span> <span class="o">=</span> <span class="n">pre_spike_train_in</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">Lt</span><span class="p">)</span>

  <span class="c1"># simulation</span>
  <span class="n">rec_spikes</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># recording spike times</span>
  <span class="k">for</span> <span class="n">it</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Lt</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">tr</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
      <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>
      <span class="n">tr</span> <span class="o">=</span> <span class="n">tr</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">elif</span> <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">V_th</span><span class="p">:</span>   <span class="c1"># reset voltage and record spike event</span>
      <span class="n">rec_spikes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">it</span><span class="p">)</span>
      <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">=</span> <span class="n">V_reset</span>
      <span class="n">tr</span> <span class="o">=</span> <span class="n">tref</span> <span class="o">/</span> <span class="n">dt</span>
    <span class="c1"># update the synaptic conductance</span>
    <span class="n">gE</span><span class="p">[</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">gE</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau_syn_E</span><span class="p">)</span> <span class="o">*</span> <span class="n">gE</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="n">gE_bar</span> <span class="o">*</span> <span class="n">pre_spike_train_ex_total</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">gI</span><span class="p">[</span><span class="n">it</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">gI</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau_syn_I</span><span class="p">)</span> <span class="o">*</span> <span class="n">gI</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="n">gI_bar</span> <span class="o">*</span> <span class="n">pre_spike_train_in_total</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># calculate the increment of the membrane potential</span>
    <span class="n">dv</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">E_L</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">gE</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">g_L</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">VE</span><span class="p">)</span> <span class="o">-</span> \
            <span class="p">(</span><span class="n">gI</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">g_L</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">-</span> <span class="n">VI</span><span class="p">)</span> <span class="o">+</span> <span class="n">Iinj</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">/</span> <span class="n">g_L</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">dt</span> <span class="o">/</span> <span class="n">tau_m</span><span class="p">)</span>

    <span class="c1"># update membrane potential</span>
    <span class="n">v</span><span class="p">[</span><span class="n">it</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span><span class="p">[</span><span class="n">it</span><span class="p">]</span> <span class="o">+</span> <span class="n">dv</span>

  <span class="n">rec_spikes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">rec_spikes</span><span class="p">)</span> <span class="o">*</span> <span class="n">dt</span>

  <span class="k">return</span> <span class="n">v</span><span class="p">,</span> <span class="n">rec_spikes</span><span class="p">,</span> <span class="n">gE</span><span class="p">,</span> <span class="n">gI</span>


<span class="nb">print</span><span class="p">(</span><span class="n">help</span><span class="p">(</span><span class="n">run_LIF_cond</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function run_LIF_cond in module __main__:

run_LIF_cond(pars, I_inj, pre_spike_train_ex, pre_spike_train_in)
    conductance-based LIF dynamics
    
    Args:
      pars               : parameter dictionary
      I_inj              : injected current [pA]. The injected current here can
                           be a value or an array
      pre_spike_train_ex : spike train input from presynaptic excitatory neuron
      pre_spike_train_in : spike train input from presynaptic inhibitory neuron
    
    Returns:
      rec_spikes         : spike times
      rec_v              : mebrane potential
      gE                 : postsynaptic excitatory conductance
      gI                 : postsynaptic inhibitory conductance

None
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="interactive-demo-correlated-spike-input-to-an-lif-neuron">
<h2>Interactive Demo: Correlated spike input to an LIF neuron<a class="headerlink" href="#interactive-demo-correlated-spike-input-to-an-lif-neuron" title="Permalink to this headline">¶</a></h2>
<p>In the following you can explore what happens when the neurons receive correlated spiking input.</p>
<p>You can vary the correlation between excitatory input spike trains. For simplicity, the correlation between inhibitory spike trains is set to 0.01.</p>
<p>Vary both excitatory rate and correlation and see how the output correlation changes. Check if the results are qualitatively similar to what you observed previously when you varied the <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span>.</p>
<div class="section" id="id7">
<h3><a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># @title</span>

<span class="c1"># @markdown Make sure you execute this cell to enable the widget!</span>

<span class="n">my_layout</span><span class="o">.</span><span class="n">width</span> <span class="o">=</span> <span class="s1">'450px'</span>
<span class="nd">@widgets</span><span class="o">.</span><span class="n">interact</span><span class="p">(</span>
  <span class="n">pwc_ee</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
                             <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">),</span>
  <span class="n">exc_rate</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">1e3</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">500.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">5e3</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">50.</span><span class="p">,</span>
                               <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">),</span>
  <span class="n">inh_rate</span><span class="o">=</span><span class="n">widgets</span><span class="o">.</span><span class="n">FloatSlider</span><span class="p">(</span><span class="mf">500.</span><span class="p">,</span> <span class="nb">min</span><span class="o">=</span><span class="mf">300.</span><span class="p">,</span> <span class="nb">max</span><span class="o">=</span><span class="mf">5e3</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">5.</span><span class="p">,</span>
                               <span class="n">layout</span><span class="o">=</span><span class="n">my_layout</span><span class="p">),</span>
<span class="p">)</span>


<span class="k">def</span> <span class="nf">EI_isi_regularity</span><span class="p">(</span><span class="n">pwc_ee</span><span class="p">,</span> <span class="n">exc_rate</span><span class="p">,</span> <span class="n">inh_rate</span><span class="p">):</span>
  <span class="n">pars</span> <span class="o">=</span> <span class="n">default_pars</span><span class="p">(</span><span class="n">T</span><span class="o">=</span><span class="mf">1000.</span><span class="p">)</span>
  <span class="c1"># Add parameters</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_th'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">55.</span>     <span class="c1"># spike threshold [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_reset'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>  <span class="c1"># reset potential [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_m'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>     <span class="c1"># membrane time constant [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'g_L'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">10.</span>       <span class="c1"># leak conductance [nS]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'V_init'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">65.</span>   <span class="c1"># initial potential [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'E_L'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">75.</span>      <span class="c1"># leak reversal potential [mV]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tref'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.</span>       <span class="c1"># refractory time (ms)</span>

  <span class="n">pars</span><span class="p">[</span><span class="s1">'gE_bar'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.0</span>    <span class="c1"># [nS]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'VE'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.</span>         <span class="c1"># [mV] excitatory reversal potential</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_syn_E'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.</span>  <span class="c1"># [ms]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'gI_bar'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">2.4</span>    <span class="c1"># [nS]</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'VI'</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mf">80.</span>       <span class="c1"># [mV] inhibitory reversal potential</span>
  <span class="n">pars</span><span class="p">[</span><span class="s1">'tau_syn_I'</span><span class="p">]</span> <span class="o">=</span> <span class="mf">5.</span>  <span class="c1"># [ms]</span>

  <span class="n">my_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">]</span><span class="o">+</span><span class="n">pars</span><span class="p">[</span><span class="s1">'dt'</span><span class="p">],</span> <span class="mf">.1</span><span class="p">)</span>  <span class="c1"># 20 [ms] bin-size</span>

  <span class="c1"># exc_rate = 1e3</span>
  <span class="c1"># inh_rate = 0.4e3</span>
  <span class="c1"># pwc_ee = 0.3</span>
  <span class="n">pwc_ii</span> <span class="o">=</span> <span class="mf">0.01</span>
  <span class="c1"># generate two correlated spike trains for excitatory input</span>
  <span class="n">sp1e</span><span class="p">,</span> <span class="n">sp2e</span> <span class="o">=</span> <span class="n">generate_corr_Poisson</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">exc_rate</span><span class="p">,</span> <span class="n">pwc_ee</span><span class="p">)</span>

  <span class="n">sp1_spike_train_ex</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">sp1e</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">my_bin</span><span class="p">)</span>
  <span class="n">sp2_spike_train_ex</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">sp2e</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">my_bin</span><span class="p">)</span>

  <span class="c1"># generate two uncorrelated spike trains for inhibitory input</span>
  <span class="n">sp1i</span><span class="p">,</span> <span class="n">sp2i</span> <span class="o">=</span> <span class="n">generate_corr_Poisson</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="n">inh_rate</span><span class="p">,</span> <span class="n">pwc_ii</span><span class="p">)</span>
  <span class="n">sp1_spike_train_in</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">sp1i</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">my_bin</span><span class="p">)</span>
  <span class="n">sp2_spike_train_in</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">sp2i</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">my_bin</span><span class="p">)</span>

  <span class="n">v1</span><span class="p">,</span> <span class="n">rec_spikes1</span><span class="p">,</span> <span class="n">gE</span><span class="p">,</span> <span class="n">gI</span> <span class="o">=</span> <span class="n">run_LIF_cond</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sp1_spike_train_ex</span><span class="p">,</span> <span class="n">sp1_spike_train_in</span><span class="p">)</span>
  <span class="n">v2</span><span class="p">,</span> <span class="n">rec_spikes2</span><span class="p">,</span> <span class="n">gE</span><span class="p">,</span> <span class="n">gI</span> <span class="o">=</span> <span class="n">run_LIF_cond</span><span class="p">(</span><span class="n">pars</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sp2_spike_train_ex</span><span class="p">,</span> <span class="n">sp2_spike_train_in</span><span class="p">)</span>

  <span class="c1"># bin the spike time</span>
  <span class="n">bin_size</span> <span class="o">=</span> <span class="mi">20</span>  <span class="c1"># [ms]</span>
  <span class="n">my_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pars</span><span class="p">[</span><span class="s1">'T'</span><span class="p">],</span> <span class="n">bin_size</span><span class="p">)</span>
  <span class="n">spk_1</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">rec_spikes1</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">my_bin</span><span class="p">)</span>
  <span class="n">spk_2</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">rec_spikes2</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">my_bin</span><span class="p">)</span>

  <span class="n">r12</span> <span class="o">=</span> <span class="n">my_CC</span><span class="p">(</span><span class="n">spk_1</span><span class="p">,</span> <span class="n">spk_2</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Input correlation = </span><span class="si">{</span><span class="n">pwc_ee</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Output correlation = </span><span class="si">{</span><span class="n">r12</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">7</span><span class="p">))</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">211</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sp1e</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sp1e</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'|'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">'Exc. input 1'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sp2e</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sp2e</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="s1">'|'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">'Exc. input 2'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sp1i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sp1i</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.3</span><span class="p">,</span> <span class="s1">'|k'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">'Inh. input 1'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sp2i</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sp2i</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.4</span><span class="p">,</span> <span class="s1">'|k'</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
           <span class="n">label</span><span class="o">=</span><span class="s1">'Inh. input 2'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'neuron id.'</span><span class="p">)</span>

  <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">v1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'neuron 1'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pars</span><span class="p">[</span><span class="s1">'range_t'</span><span class="p">],</span> <span class="n">v2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'neuron 2'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">'time (ms)'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">'membrane voltage $V_</span><span class="si">{m}</span><span class="s1">$'</span><span class="p">)</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
  <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">
{"version_major": 2, "version_minor": 0, "model_id": "2cd1ea31c6684e06aae6d47c331223da"}
</script></div>
</div>
<p>Above, we are estimating the output correlation for one trial. You can modify the code to get a trial average of output correlations.</p>
</div>
</div>
</div>
<hr class="docutils"/>
<div class="section" id="bonus-2-ensemble-response">
<h1>Bonus 2: Ensemble Response<a class="headerlink" href="#bonus-2-ensemble-response" title="Permalink to this headline">¶</a></h1>
<p>Finally, there is a short BONUS lecture video on the firing response of an ensemble of neurons to time-varying input. There are no associated coding exercises - just enjoy.</p>
<div class="section" id="video-2-bonus-response-of-ensemble-of-neurons-to-time-varying-input">
<h2>Video 2 (Bonus): Response of ensemble of neurons to time-varying input<a class="headerlink" href="#video-2-bonus-response-of-ensemble-of-neurons-to-time-varying-input" title="Permalink to this headline">¶</a></h2>
<div class="cell tag_remove-input docutils container">
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Video available at https://youtube.com/watch?v=78_dWa4VOIo
</pre></div>
</div>
<div class="output text_html">
<iframe allowfullscreen="" frameborder="0" height="410" src="https://www.youtube.com/embed/78_dWa4VOIo?fs=1" width="730"></iframe>
</div></div>
</div>
</div>
</div>
<script type="application/vnd.jupyter.widget-state+json">
{"state": {"fe113b8c9a124fcba0b67fc3e4bc1842": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": "450px"}}, "4577cd54fef84f039cc0ad4a4748bdb4": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "e2edb7b8fd7d43e7a7f654d9c36d2984": {"model_name": "FloatSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "FloatSliderView", "continuous_update": true, "description": "pwc_ee", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_fe113b8c9a124fcba0b67fc3e4bc1842", "max": 0.99, "min": 0.05, "orientation": "horizontal", "readout": true, "readout_format": ".2f", "step": 0.01, "style": "IPY_MODEL_4577cd54fef84f039cc0ad4a4748bdb4", "value": 0.3}}, "ee10aa7f9d4f4c518e092833d6897f66": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "2137d75ab33042ca8a9988e349a77224": {"model_name": "FloatSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "FloatSliderView", "continuous_update": true, "description": "exc_rate", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_fe113b8c9a124fcba0b67fc3e4bc1842", "max": 5000.0, "min": 500.0, "orientation": "horizontal", "readout": true, "readout_format": ".2f", "step": 50.0, "style": "IPY_MODEL_ee10aa7f9d4f4c518e092833d6897f66", "value": 1000.0}}, "cc91d8e8160f49d7b44b285562ab55a6": {"model_name": "SliderStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "SliderStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "StyleView", "description_width": "", "handle_color": null}}, "fc5491437bb8463b8dd1c0ce1dc2ca3a": {"model_name": "FloatSliderModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "FloatSliderModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "FloatSliderView", "continuous_update": true, "description": "inh_rate", "description_tooltip": null, "disabled": false, "layout": "IPY_MODEL_fe113b8c9a124fcba0b67fc3e4bc1842", "max": 5000.0, "min": 300.0, "orientation": "horizontal", "readout": true, "readout_format": ".2f", "step": 5.0, "style": "IPY_MODEL_cc91d8e8160f49d7b44b285562ab55a6", "value": 500.0}}, "c950a53d64a84e16a06a5921f008ac22": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "2cd1ea31c6684e06aae6d47c331223da": {"model_name": "VBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "1.5.0", "state": {"_dom_classes": ["widget-interact"], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "1.5.0", "_model_name": "VBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "1.5.0", "_view_name": "VBoxView", "box_style": "", "children": ["IPY_MODEL_e2edb7b8fd7d43e7a7f654d9c36d2984", "IPY_MODEL_2137d75ab33042ca8a9988e349a77224", "IPY_MODEL_fc5491437bb8463b8dd1c0ce1dc2ca3a", "IPY_MODEL_13b2d5eddee24278b27153814ebaf824"], "layout": "IPY_MODEL_c950a53d64a84e16a06a5921f008ac22"}}, "462677a33c084cdea68d3163a380a249": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "1.2.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "1.2.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "1.2.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "overflow_x": null, "overflow_y": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "13b2d5eddee24278b27153814ebaf824": {"model_name": "OutputModel", "model_module": "@jupyter-widgets/output", "model_module_version": "1.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/output", "_model_module_version": "1.0.0", "_model_name": "OutputModel", "_view_count": null, "_view_module": "@jupyter-widgets/output", "_view_module_version": "1.0.0", "_view_name": "OutputView", "layout": "IPY_MODEL_462677a33c084cdea68d3163a380a249", "msg_id": "", "outputs": [{"output_type": "error", "ename": "NotImplementedError", "evalue": "Student exercise: compute the sample correlation coefficient", "traceback": ["\u001b[0;31m---------------------------------------------------------------------------\u001b[0m", "\u001b[0;31mNotImplementedError\u001b[0m                       Traceback (most recent call last)", "\u001b[0;32m/opt/hostedtoolcache/Python/3.7.10/x64/lib/python3.7/site-packages/ipywidgets/widgets/interaction.py\u001b[0m in \u001b[0;36mupdate\u001b[0;34m(self, *args)\u001b[0m\n\u001b[1;32m    254\u001b[0m                     \u001b[0mvalue\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mwidget\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mget_interact_value\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    255\u001b[0m                     \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m[\u001b[0m\u001b[0mwidget\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0m_kwarg\u001b[0m\u001b[0;34m]\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mvalue\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m--> 256\u001b[0;31m                 \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mresult\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mf\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m**\u001b[0m\u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mkwargs\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m    257\u001b[0m                 \u001b[0mshow_inline_matplotlib_plots\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m    258\u001b[0m                 \u001b[0;32mif\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mauto_display\u001b[0m \u001b[0;32mand\u001b[0m \u001b[0mself\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mresult\u001b[0m \u001b[0;32mis\u001b[0m \u001b[0;32mnot\u001b[0m \u001b[0;32mNone\u001b[0m\u001b[0;34m:\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n", "\u001b[0;32m<ipython-input-14-d5e183d9352f>\u001b[0m in \u001b[0;36mEI_isi_regularity\u001b[0;34m(pwc_ee, exc_rate, inh_rate)\u001b[0m\n\u001b[1;32m     58\u001b[0m   \u001b[0mspk_2\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0m_\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mnp\u001b[0m\u001b[0;34m.\u001b[0m\u001b[0mhistogram\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mrec_spikes2\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mbins\u001b[0m\u001b[0;34m=\u001b[0m\u001b[0mmy_bin\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     59\u001b[0m \u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 60\u001b[0;31m   \u001b[0mr12\u001b[0m \u001b[0;34m=\u001b[0m \u001b[0mmy_CC\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0mspk_1\u001b[0m\u001b[0;34m,\u001b[0m \u001b[0mspk_2\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     61\u001b[0m   \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf\"Input correlation = {pwc_ee}\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     62\u001b[0m   \u001b[0mprint\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34mf\"Output correlation = {r12}\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n", "\u001b[0;32m<ipython-input-6-47f6ede9e9ef>\u001b[0m in \u001b[0;36mmy_CC\u001b[0;34m(i, j)\u001b[0m\n\u001b[1;32m     13\u001b[0m   \u001b[0;31m# Tip3: square root, np.sqrt()\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     14\u001b[0m   \u001b[0;31m# Fill out function and remove\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0;32m---> 15\u001b[0;31m   \u001b[0;32mraise\u001b[0m \u001b[0mNotImplementedError\u001b[0m\u001b[0;34m(\u001b[0m\u001b[0;34m\"Student exercise: compute the sample correlation coefficient\"\u001b[0m\u001b[0;34m)\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[0m\u001b[1;32m     16\u001b[0m   \u001b[0;31m########################################################################\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n\u001b[1;32m     17\u001b[0m   \u001b[0;31m# Calculate the covariance of i and j\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0;34m\u001b[0m\u001b[0m\n", "\u001b[0;31mNotImplementedError\u001b[0m: Student exercise: compute the sample correlation coefficient"]}]}}}, "version_major": 2, "version_minor": 0}
</script>
<script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./tutorials/W2D3_BiologicalNeuronModels/student"
        },
        predefinedOutput: true
    }
    </script>
<script>kernelName = 'python3'</script>
</div>
<div class="prev-next-bottom">
<a class="left-prev" href="W2D3_Tutorial1.html" id="prev-link" title="previous page">Tutorial 1: The Leaky Integrate-and-Fire (LIF) Neuron Model</a>
<a class="right-next" href="W2D3_Tutorial3.html" id="next-link" title="next page">Tutorial 3: Synaptic transmission - Models of static and dynamic synapses</a>
</div>
</div>
</div>
<footer class="footer mt-5 mt-md-0">
<div class="container">
<p>
        
          By Neuromatch<br/>
        
            © Copyright 2021.<br/>
</p>
</div>
</footer>
</main>
</div>
</div>
<script src="../../../_static/js/index.1c5a1a01449ed65a7b51.js"></script>
</body>
</html>